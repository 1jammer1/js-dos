{"version":3,"sources":["node_modules/browser-pack/_prelude.js","js-dos-ts/js-dos-build.ts","js-dos-ts/js-dos-ci.ts","js-dos-ts/js-dos-fs.ts","js-dos-ts/js-dos-host.ts","js-dos-ts/js-dos-module.ts","js-dos-ts/js-dos-options.ts","js-dos-ts/js-dos-ui.ts","js-dos-ts/js-dos-xhr.ts","js-dos-ts/js-dos.ts","node_modules/assert/assert.js","node_modules/assert/node_modules/inherits/inherits_browser.js","node_modules/assert/node_modules/util/support/isBufferBrowser.js","node_modules/assert/node_modules/util/util.js","node_modules/process/browser.js","test/compare.ts","test/do.ts","test/test.ts"],"names":[],"mappings":"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CH;AACJ,aAPD;AASA,uBAAW,EAAX,EAAe,CAAf;AACH,SAbD;AAeA,eAAO,OAAP;AACA,YAAI,CAAC,OAAO,OAAZ,EAAqB;AACjB;AACH;AAED;AACA,sBAAA,IAAA,CAAK,aAAL,CAAmB,OAAO,UAA1B,EAAsC,MAAtC;AACH,KAhCe,CAAhB;AAkCA,QAAM,kBAAmB,OAAzB;AACA,oBAAgB,KAAhB,GAAwB,UAAC,OAAD,EAAY;AAChC,wBAAgB,IAAhB,CAAqB,UAAC,OAAD,EAAwB;AACzC,oBAAQ,QAAQ,EAAhB,EAAoB,QAAQ,IAA5B;AACH,SAFD;AAGH,KAJD;AAKA,WAAO,eAAP;AACH;AA1CD,QAAA,GAAA,GAAA,GAAA;AAoEC,OAAe,GAAf,GAAqB,GAArB;;;;AClFD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC1eA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC1kBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACxLA,IAAA,SAAA,QAAA,QAAA,CAAA;AAEA,IAAA,OAAA,QAAA,MAAA,CAAA;AAEA;AACA;AACA;AAEA,SAAgB,cAAhB,CAA+B,QAA/B,EAAiD,EAAjD,EAAyE,IAAzE,EAAyF;AACrF,YAAQ,QAAR,EAAkB,EAAlB,EAAsB,UAAC,KAAD,EAAU;AAC5B,eAAO,KAAP,CAAa,CAAb,EAAgB,KAAhB;AACA,WAAG,IAAH;AACA;AACH,KAJD;AAKH;AAND,QAAA,cAAA,GAAA,cAAA;AAQA,IAAM,U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","file":"test.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","// Autogenerated\n// -------------\n// gulpfile.js --> generateBuildInfo\n\nexport const Build = {\n    version: \"6.22-cc29ba346400bdb29f459d8d502056d1415e9ce4\",\n    wasmSize: 2167540,\n    jsSize:  503536,\n};\n","import { Dos } from \"./js-dos\";\nimport { DosModule } from \"./js-dos-module\";\nimport { Xhr } from \"./js-dos-xhr\";\n\ninterface LowLevelApi {\n    send: (event: string, msg?: any, callback?: (msg: string) => void) => void;\n    ping: (msg: string) => void;\n}\n\nexport class DosCommandInteface {\n    public dos: DosModule;\n    private em: typeof Module;\n    private api: LowLevelApi;\n    private onready: (ci: DosCommandInteface) => void;\n\n    private shellInputQueue: string[] = [];\n    private shellInputClients: Array<() => void> = [];\n\n    constructor(dos: DosModule, onready: (ci: DosCommandInteface) => void) {\n        this.dos = dos;\n        this.em = (dos as any);\n        this.api = (dos as any);\n        this.api.ping = (msg: string, ...args: any[]) => {\n            this.onping(msg, args);\n        };\n        this.onready = onready;\n    }\n\n    public width() {\n        return this.dos.canvas.width;\n    }\n\n    public height() {\n        return this.dos.canvas.height;\n    }\n\n    public shell(...cmd: string[]) {\n        if (cmd.length === 0) {\n            return;\n        }\n\n        return new Promise((resolve, reject) => {\n            this.shellInputClients.push(resolve);\n            for (const next of cmd) {\n                this.shellInputQueue.push(next);\n            }\n            this.requestShellInput();\n        });\n    }\n\n    public screenshot() {\n        return new Promise((resolve) => {\n            this.api.send(\"screenshot\", \"\", (data) => {\n                resolve(data);\n            });\n        });\n    }\n\n    public exit() {\n        try {\n            this.api.send(\"exit\");\n        } catch (e) {\n            return 0;\n        }\n\n        this.dos.error(\"Runtime is still alive!\");\n        return -1;\n    }\n\n    private sendKeyPress(code: number) {\n        this.api.send(\"sdl_key_event\", code + \"\");\n    }\n\n    private requestShellInput() {\n        this.sendKeyPress(13);\n    }\n\n    private onping(msg: string, args: any[]) {\n        switch (msg) {\n            case \"ready\":\n                this.onready(this);\n                break;\n            case \"shell_input\":\n                if (this.shellInputQueue.length === 0) {\n                    return;\n                }\n\n                const buffer: number = args[0];\n                const maxLength: number = args[1];\n\n                const cmd = this.shellInputQueue.shift();\n                const cmdLength = (this.em as any).lengthBytesUTF8(cmd) + 1;\n\n                if (cmdLength > maxLength) {\n                    this.dos.onerror(\"Can't execute cmd '\" + cmd +\n                        \"', because it's bigger then max cmd length \" + maxLength);\n                    return;\n                }\n\n                (this.em as any).stringToUTF8(cmd, buffer, cmdLength);\n\n                if (this.shellInputQueue.length === 0) {\n                    for (const resolve of this.shellInputClients) {\n                        resolve();\n                    }\n                    this.shellInputClients = [];\n                } else {\n                    this.requestShellInput();\n                }\n            default:\n            // do nothing\n        }\n    }\n}\n","import { Dos } from \"./js-dos\";\nimport { DosModule } from \"./js-dos-module\";\nimport { Xhr } from \"./js-dos-xhr\";\n\n// FS\n// ==\n// Api for working with inmemory file system that used by emulation layer\n\nexport class DosFS {\n    private dos: DosModule;\n    private em: typeof Module;\n\n    constructor(dos: DosModule) {\n        this.dos = dos;\n        this.em = dos as any;\n    }\n\n    // **extract** - downloads url and extract it in cwd (cwd will be mounted as C:),\n    // supported only zip archive\n    public extract(url: string, type: string = \"zip\") {\n        return new Promise<void>((resolve, reject) => {\n            if (type !== \"zip\") {\n                reject(\"Only ZIP archive is supported\");\n                return;\n            }\n\n            new Xhr(url, {\n                responseType: \"arraybuffer\",\n                fail: (msg) => reject(msg),\n                progress: (total, loaded) => this.dos.onprogress(\"Downloading \" + url, total, loaded),\n                success: (data: ArrayBuffer) => {\n                    const bytes = new Uint8Array(data);\n                    const buffer = this.em._malloc(bytes.length);\n                    this.em.HEAPU8.set(bytes, buffer);\n                    const retcode = (this.em as any)._extract_zip(buffer, bytes.length);\n                    this.em._free(buffer);\n\n                    if (retcode === 0) {\n                        resolve();\n                    } else {\n                        reject(\"Can't extract zip, retcode \" + retcode + \", see more info in logs\");\n                    }\n                },\n            });\n        });\n    }\n}\n","import { Build } from \"./js-dos-build\";\nimport { DosModule } from \"./js-dos-module\";\nimport { Xhr } from \"./js-dos-xhr\";\n\nclass DosHost {\n\n    public wasmSupported = false;\n    public global = window as any;\n\n    private wdosboxPromise: Promise<any> = null;\n\n    constructor() {\n        this.global.exports = {};\n\n        try {\n            if (typeof WebAssembly === \"object\" &&\n                typeof WebAssembly.instantiate === \"function\" &&\n                typeof WebAssembly.compile === \"function\") {\n\n                const wmodule = new WebAssembly.Module(Uint8Array.of(0x0, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00));\n                if (wmodule instanceof WebAssembly.Module) {\n                    this.wasmSupported = new WebAssembly.Instance(wmodule) instanceof WebAssembly.Instance;\n                }\n            }\n        } catch (error) {\n            // do nothing WebAssembly is not supported\n        }\n\n        this.polyfill();\n    }\n\n    public resolveDosBox(url: string, module: DosModule) {\n        if (this.global.exports.WDOSBOX) {\n            module.ondosbox(this.global.exports.WDOSBOX, this.global.exports.instantiateWasm);\n            return;\n        }\n\n        if (!this.wasmSupported) {\n            module.onerror(\"WebAssembly is not supported, can't resolve wdosbox\");\n            return;\n        }\n\n        if (this.wdosboxPromise === null) {\n            this.wdosboxPromise = this.compileDosBox(url, module);\n        }\n\n        this.wdosboxPromise.then((instance: any) => {\n            // leave promise scope\n            const fn = () => {\n                this.wdosboxPromise = null;\n                module.ondosbox(this.global.exports.WDOSBOX, this.global.exports.instantiateWasm);\n            };\n            setTimeout(fn, 1);\n        }, (message: string) => {\n            // leave promise scope\n            const fn = () => {\n                this.wdosboxPromise = null;\n                module.onerror(message);\n            };\n            setTimeout(fn, 1);\n        });\n    }\n\n    private compileDosBox(url: string, module: DosModule) {\n        const buildTotal = Build.wasmSize + Build.jsSize;\n        return new Promise((resolve, reject) => {\n            const wasmUrl = url.replace(\".js\", \".wasm.js\");\n\n            new Xhr(wasmUrl, {\n                responseType: \"arraybuffer\",\n                progress: (total, loaded) => {\n                    if (module.onprogress) {\n                        module.onprogress(\"Resolving DosBox\", buildTotal, loaded);\n                    }\n                },\n                fail: (url: string, status: number, message: string) => {\n                    reject(\"Can't download wasm, code: \" + status +\n                        \", message: \" + message + \", url: \" + url);\n                },\n                success: (response: any) => {\n                    const promise = WebAssembly.compile(response);\n                    const onreject = (reason: any) => {\n                        reject(reason + \"\");\n                    };\n                    promise.catch(onreject);\n                    promise.then((wasmModule) => {\n                        this.global.exports.instantiateWasm = (info: any, receiveInstance: any) => {\n                            return WebAssembly.instantiate(wasmModule, info)\n                                .catch(onreject)\n                                .then((instance) => {\n                                    receiveInstance(instance, wasmModule);\n                                });\n                        };\n\n                        new Xhr(url, {\n                            progress: (total, loaded) => {\n                                if (module.onprogress) {\n                                    module.onprogress(\"Resolving DosBox\", buildTotal, Build.wasmSize + loaded);\n                                }\n                            },\n                            fail: (url: string, status: number, message: string) => {\n                                reject(\"Can't download wdosbox.js, code: \" + status +\n                                    \", message: \" + message + \", url: \" + url);\n                            },\n                            success: (response: any) => {\n                                module.onprogress(\"Resolving DosBox\", buildTotal, buildTotal);\n\n                                /* tslint:disable:no-eval */\n                                eval.call(window, response);\n                                resolve(this.global.exports.WDOSBOX);\n                            },\n                        });\n                    });\n                },\n            });\n        });\n    }\n\n    /* tslint:disable:no-bitwise */\n    /* tslint:disable:only-arrow-functions */\n    private polyfill() {\n        if (!Math.imul || Math.imul(0xffffffff, 5) !== -5) {\n            Math.imul = function imul(a: any, b: any) {\n                const ah = a >>> 16;\n                const al = a & 0xffff;\n                const bh = b >>> 16;\n                const bl = b & 0xffff;\n                return (al * bl + ((ah * bl + al * bh) << 16)) | 0;\n            };\n        }\n        Math.imul = Math.imul;\n\n        if (!Math.fround) {\n            Math.fround = function(x) { return x; };\n        }\n        Math.fround = Math.fround;\n\n        if (!Math.clz32) {\n            Math.clz32 = function(x) {\n                x = x >>> 0;\n                for (let i = 0; i < 32; i++) {\n                    if (x & (1 << (31 - i))) { return i; }\n                }\n                return 32;\n            };\n        }\n        Math.clz32 = Math.clz32;\n\n        if (!Math.trunc) {\n            Math.trunc = function(x) {\n                return x < 0 ? Math.ceil(x) : Math.floor(x);\n            };\n        }\n        Math.trunc = Math.trunc;\n    }\n}\n\nexport const Host = new DosHost();\n","import { DosRuntime } from \"./js-dos\";\nimport { DosCommandInteface } from \"./js-dos-ci\";\nimport { DosFS } from \"./js-dos-fs\";\nimport { DosOptions } from \"./js-dos-options\";\nimport { DosUi } from \"./js-dos-ui\";\n\nexport class DosModule extends DosOptions {\n    public isValid: boolean = false;\n    public canvas: HTMLCanvasElement = null;\n    private ci: Promise<DosCommandInteface> = null;\n    private instance: any;\n    private fs: DosFS = null;\n    private ui: DosUi = null;\n    private onready: (runtime: DosRuntime) => void;\n\n    constructor(canvas: HTMLCanvasElement, onready: (runtime: DosRuntime) => void) {\n        super();\n        this.canvas = canvas;\n        this.onready = onready;\n    }\n\n    public debug(message: string) {\n        this.log(\"[DEBUG] \" + message);\n    }\n\n    public info(message: string) {\n        this.log(\"[INFO] \" + message);\n    }\n\n    public warn(message: string) {\n        this.log(\"[WARN] \" + message);\n    }\n\n    public error(message: string) {\n        this.log(\"[ERROR] \" + message);\n    }\n\n    public ondosbox(dosbox: any, instantiateWasm: any) {\n        this.info(\"DosBox resolved\");\n        (this as any).instantiateWasm = instantiateWasm;\n        this.instance = new dosbox(this);\n        // emscripten will call this.onRuntimeInitialized\n        // when runtime will ready\n    }\n\n    public resolve() {\n        if (!this.wdosboxUrl) {\n            this.wdosboxUrl = \"wdosbox.js\";\n        }\n\n        if (!this.log) {\n            /* tslint:disable:no-console */\n            this.log = (message: string) => console.log(message);\n        }\n\n        if (!this.canvas) {\n            this.onerror(\"canvas field is required, but not set!\");\n            return;\n        }\n\n        if (!this.onprogress) {\n            this.ui = new DosUi(this);\n            this.onprogress = (stage, total, loaded) => this.ui.onprogress(stage, total, loaded);\n        }\n\n        (this as any).SDL = {\n            defaults: {\n                widht: 320,\n                height: 200,\n                copyOnLock: false,\n                discardOnLock: true,\n                opaqueFrontBuffer: false,\n            },\n        };\n\n        this.isValid = true;\n    }\n\n    public onRuntimeInitialized() {\n        const mainFn = (args: string[]) => {\n            if (this.ui !== null) {\n                this.ui.detach();\n                this.ui = null;\n            }\n            args.unshift(\"-c\", \"mount c .\", \"-c\", \"c:\");\n            (this as any).callMain(args);\n            return new Promise<DosCommandInteface>((resolve) => {\n                new DosCommandInteface(this, (ci: DosCommandInteface) => {\n                    resolve(ci);\n                });\n            });\n        };\n        this.fs = new DosFS(this);\n        this.onready({\n            fs: this.fs,\n            main: mainFn,\n        });\n    }\n\n}\n","import { DosCommandInteface } from \"./js-dos-ci\";\nimport { DosFS } from \"./js-dos-fs\";\n\n// DosOptions\n// ----------\n// Is a options object that you pass to constructor of [Dos](js-dos.html)\n// class, to configure emulation layer:\nexport class DosOptions {\n\n    // onprogress\n    // ----------\n    // this function is called while js-dos is loading\n    public onprogress?: (stage: string, total: number, loaded: number) => void;\n\n    // onerror\n    // -------\n    // this function is called when error happens\n    public onerror?: (message: string) => void;\n\n    // log\n    // ---\n    //  you can provide log function, to override logging, by default js-dos uses console.log as implementation\n    public log?: (message: string) => void;\n\n    // wdosboxUrl\n    // ----------\n    // you can set alternative url for downloading js-dos script, default is 'wdosbox.js'\n    public wdosboxUrl?: string;\n\n}\n","import { DosModule } from \"./js-dos-module\";\n\n// JsDosUi\n// =======\n// Optional ui module to show progress if onprogress is not set by client\n\nexport class DosUi {\n    private canvas: HTMLCanvasElement;\n    private dos: DosModule;\n\n    private overlay: HTMLDivElement;\n    private loaderMessage: HTMLDivElement;\n    private hidden: boolean;\n\n    constructor(dos: DosModule) {\n        this.dos = dos;\n        this.canvas = dos.canvas;\n\n        try {\n            if (document.getElementById(\"js-dos-ui-css\") === null) {\n                const style = document.createElement(\"style\") as HTMLStyleElement;\n                style.id = \"js-dos-ui-css\";\n                style.innerHTML = this.css;\n                document.head.appendChild(style);\n            }\n\n            if (this.canvas.parentElement.className !== \"dosbox-container\") {\n                const container = document.createElement(\"div\") as HTMLDivElement;\n                container.className = \"dosbox-container\";\n\n                const parent = this.canvas.parentElement;\n                parent.replaceChild(container, this.canvas);\n                container.appendChild(this.canvas);\n\n                const overlay = document.createElement(\"div\") as HTMLDivElement;\n                overlay.className = \"dosbox-overlay\";\n                container.appendChild(overlay);\n\n                overlay.innerHTML = this.overlayHtml;\n            }\n\n            const container = this.canvas.parentElement;\n            this.overlay = this.childById(container, \"dosbox-overlay\");\n            this.loaderMessage = this.childById(this.overlay, \"dosbox-loader-message\");\n\n            this.hidden = false;\n            this.hide();\n        } catch (e) {\n            this.onprogress = this.onprogressFallback;\n        }\n    }\n\n    public onprogress(stage: string, total: number, loaded: number) {\n        const message = stage + \" \" + Math.round(loaded * 100 / total * 10) / 10 + \"%\";\n        this.loaderMessage.innerHTML = message;\n        this.dos.info(message);\n\n        if (loaded >= total) {\n            this.hide();\n        } else {\n            this.show();\n        }\n    }\n\n    public detach() {\n        this.hide();\n        this.onprogress = this.onprogressFallback;\n    }\n\n    public hide() {\n        if (this.hidden) {\n            return;\n        }\n        this.hidden = true;\n        this.overlay.setAttribute(\"style\", \"display: none\");\n    }\n\n    public show() {\n        if (!this.hidden) {\n            return;\n        }\n        this.hidden = false;\n        this.overlay.setAttribute(\"style\", \"display: block\");\n    }\n\n    private onprogressFallback(stage: string, total: number, loaded: number) {\n        this.dos.info(stage + \" \" + loaded * 100 / total + \"%\");\n    }\n\n    private childById(parent: Element, className: string) {\n        if (parent === null) {\n            return null;\n        }\n\n        for (let i = 0; i < parent.childElementCount; ++i) {\n            let child = parent.children[i];\n            if (child.className === className) {\n                return child as HTMLDivElement;\n            }\n\n            child = this.childById(child, className);\n            if (child !== null) {\n                return child as HTMLDivElement;\n            }\n        }\n\n        return null;\n    }\n\n    /* tslint:disable:member-ordering */\n    /* tslint:disable:max-line-length */\n    private css: string = `\n    .dosbox-container { position: relative; min-width: 320px; min-height: 200px; display: inline-block; }\n    .dosbox-overlay, .dosbox-loader { position: absolute; left: 0; right: 0; top: 0; bottom: 0; background-color: rgba(51, 51, 51, 0.7); }\n    .dosbox-start { text-align: center; position: absolute; left: 0; right: 0; bottom: 50%; color: #f80; font-size: 1.5em; text-decoration: underline; cursor: pointer; }\n    .dosbox-overlay a { color: #f80; }\n    .dosbox-powered { position: absolute; right: 1em; bottom: 1em; font-size: 0.8em; color: #9C9C9C; }\n    .dosbox-loader-message { text-align: center; position: absolute; left: 0; right: 0; bottom: 50%; margin: 0 0 -3em 0; box-sizing: border-box; color: #f80; font-size: 1.5em; }\n    @-moz-keyframes loading { 0% { left: 0; } 50% { left: 8.33333em; } 100% { left: 0; } } @-webkit-keyframes loading { 0% { left: 0; } 50% { left: 8.33333em; } 100% { left: 0; } } @keyframes loading { 0% { left: 0; } 50% { left: 8.33333em; } 100% { left: 0; } } .st-loader { width: 10em; height: 2.5em; position: absolute; top: 50%; left: 50%; margin: -1.25em 0 0 -5em; box-sizing: border-box; }\n    .st-loader:before, .st-loader:after { content: \"\"; display: block; position: absolute; top: 0; bottom: 0; width: 1.25em; box-sizing: border-box; border: 0.25em solid #f80; }\n    .st-loader:before { left: -0.76923em; border-right: 0; }\n    .st-loader:after { right: -0.76923em; border-left: 0; }\n    .st-loader .equal { display: block; position: absolute; top: 50%; margin-top: -0.5em; left: 4.16667em; height: 1em; width: 1.66667em; border: 0.25em solid #f80; box-sizing: border-box; border-width: 0.25em 0; -moz-animation: loading 1.5s infinite ease-in-out; -webkit-animation: loading 1.5s infinite ease-in-out; animation: loading 1.5s infinite ease-in-out; background: #f80; }\n    `;\n\n    /* tslint:disable:member-ordering */\n    /* tslint:disable:max-line-length */\n    private overlayHtml: string = `\n        <div class=\"dosbox-loader\">\n            <div class=\"st-loader\">\n                <span class=\"equal\"></span>\n            </div>\n            <div class=\"dosbox-loader-message\"></div>\n        </div>\n        <div class=\"dosbox-powered\">\n            Powered by &nbsp;<a href=\"https://js-dos.com\">js-dos.com</a> (6.22)\n        </div>\n    `;\n}\n","interface XhrOptions {\n    method?: string;\n    success?: (response: any) => void;\n    progress?: (total: number, loaded: number) => void;\n    fail?: (url: string, status: number, message: string) => void;\n    data?: string;\n    responseType?: string;\n}\n\nexport class Xhr {\n    private resource: string;\n    private options: XhrOptions;\n    private xhr: XMLHttpRequest;\n    private total: number = 0;\n    private loaded: number = 0;\n\n    constructor(url: string, options: XhrOptions) {\n        this.resource = url;\n        this.options = options;\n        this.options.method = options.method || \"GET\";\n        this.xhr = new XMLHttpRequest();\n        this.xhr.open(this.options.method, url, true);\n        if (this.options.method === \"POST\") {\n            this.xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n        }\n        this.xhr.overrideMimeType(\"text/plain; charset=x-user-defined\");\n\n        let progressListner;\n        if (typeof (progressListner = this.xhr).addEventListener === \"function\") {\n            progressListner.addEventListener(\"progress\", (evt) => {\n                this.total = evt.total;\n                this.loaded = evt.loaded;\n                if (this.options.progress) {\n                    return this.options.progress(evt.total, evt.loaded);\n                }\n            });\n        }\n\n        let errorListener;\n        if (typeof (errorListener = this.xhr).addEventListener === \"function\") {\n            errorListener.addEventListener(\"error\", (evt) => {\n                if (this.options.fail) {\n                    this.options.fail(this.resource, this.xhr.status, \"connection problem\");\n                    return delete this.options.fail;\n                }\n            });\n        }\n        this.xhr.onreadystatechange = () => {\n            return this.onReadyStateChange();\n        };\n        if (this.options.responseType) {\n            this.xhr.responseType = this.options.responseType as XMLHttpRequestResponseType;\n        }\n        this.xhr.send(this.options.data);\n    }\n\n    public onReadyStateChange() {\n        if (this.xhr.readyState === 4) {\n            if (this.xhr.status === 200) {\n                if (this.options.success) {\n                    const total = Math.max(this.total, this.loaded);\n                    this.options.progress(total, total);\n                    return this.options.success(this.xhr.response);\n                }\n            } else if (this.options.fail) {\n                this.options.fail(this.resource, this.xhr.status, \"connection problem\");\n                return delete this.options.fail;\n            }\n        }\n    }\n\n    public arrayBufferToString(buffer: ArrayBuffer) {\n        const bufView = new Uint16Array(buffer);\n        const length = bufView.length;\n        let result = \"\";\n        let maxCallSize = Math.pow(2, 16) - 1;\n        let i = 0;\n        while (i < length) {\n            if (i + maxCallSize > length) {\n                maxCallSize = length - i;\n            }\n            result += String.fromCharCode.apply(null, bufView.subarray(i, i + maxCallSize));\n            i += maxCallSize;\n        }\n        return result;\n    }\n\n}\n","\nimport { DosCommandInteface } from \"./js-dos-ci\";\nimport { DosFS } from \"./js-dos-fs\";\nimport { Host } from \"./js-dos-host\";\nimport { DosModule } from \"./js-dos-module\";\nimport { DosOptions } from \"./js-dos-options\";\n\n// Dos\n// ===\n// Dos function is entry point that provides emulation layer.\n// As emulation layer js-dos uses [DosBox ported to emscripten](https://github.com/dreamlayers/em-dosbox/#compiling).\n//\n// **canvas** - is **required**, you should set existing HTMLCanvasElement, it will be used for render dos screen\n// **options** - See [DosOptions](js-dos-options.html) to understand how you can configure Dos class.\nexport function Dos(canvas: HTMLCanvasElement, options: DosOptions) {\n    const promise = new Promise<DosRuntime>((resolve, reject) => {\n        const module = new DosModule(canvas, resolve);\n        Object.assign(module, options);\n\n        // Errors\n        // ------\n        // Error propagation should support both ways:\n        // 1. Through reject of promise\n        // 2. Fire onerror function of DosOptions object\n        const onerror = module.onerror;\n        module.onerror = (message: string) => {\n            reject(message);\n\n            const fn = () => {\n                if (onerror) {\n                    onerror(message);\n                    module.onerror = onerror;\n                } else {\n                    module.onerror = module.error;\n                }\n            };\n\n            setTimeout(fn, 1);\n        };\n\n        module.resolve();\n        if (!module.isValid) {\n            return;\n        }\n\n        // See [Host](js-dos-host.html) to understand resolving of emulation layer (dosbox).\n        Host.resolveDosBox(module.wdosboxUrl, module);\n    });\n\n    const dosReadyPromise = (promise as unknown) as DosReadyPromise;\n    dosReadyPromise.ready = (onready) => {\n        dosReadyPromise.then((runtime: DosRuntime) => {\n            onready(runtime.fs, runtime.main);\n        });\n    };\n    return dosReadyPromise;\n}\n\n// DosReadyPromise\n// ---------------\n// Is Promise object with additional method ready. It returned by  Dos function\n// when promise is resolved it means that DosBox runtime is ready for use\n// and you can start your program\n\n// DosRuntime\n// ----------\nexport type DosMainFn = (args: string[]) => Promise<DosCommandInteface>;\n\nexport interface DosRuntime {\n    fs: DosFS;\n    main: DosMainFn;\n}\n\nexport interface DosReadyPromise extends Promise<DosRuntime> {\n    // ready\n    // -------\n    // This function is called before running entry point of dosbox\n    // with it you can change command line arguments that passed to dosbox\n    // or configure FS layer\n    ready: (onready: (fs: DosFS, main: DosMainFn) => void) => void;\n}\n\n(window as any).Dos = Dos;\n","'use strict';\n\n// compare and isBuffer taken from https://github.com/feross/buffer/blob/680e9e5e488f22aac27599a57dc844a6315928dd/index.js\n// original notice:\n\n/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\nfunction compare(a, b) {\n  if (a === b) {\n    return 0;\n  }\n\n  var x = a.length;\n  var y = b.length;\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i];\n      y = b[i];\n      break;\n    }\n  }\n\n  if (x < y) {\n    return -1;\n  }\n  if (y < x) {\n    return 1;\n  }\n  return 0;\n}\nfunction isBuffer(b) {\n  if (global.Buffer && typeof global.Buffer.isBuffer === 'function') {\n    return global.Buffer.isBuffer(b);\n  }\n  return !!(b != null && b._isBuffer);\n}\n\n// based on node assert, original notice:\n\n// http://wiki.commonjs.org/wiki/Unit_Testing/1.0\n//\n// THIS IS NOT TESTED NOR LIKELY TO WORK OUTSIDE V8!\n//\n// Originally from narwhal.js (http://narwhaljs.org)\n// Copyright (c) 2009 Thomas Robinson <280north.com>\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the 'Software'), to\n// deal in the Software without restriction, including without limitation the\n// rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\n// sell copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN\n// ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\n// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar util = require('util/');\nvar hasOwn = Object.prototype.hasOwnProperty;\nvar pSlice = Array.prototype.slice;\nvar functionsHaveNames = (function () {\n  return function foo() {}.name === 'foo';\n}());\nfunction pToString (obj) {\n  return Object.prototype.toString.call(obj);\n}\nfunction isView(arrbuf) {\n  if (isBuffer(arrbuf)) {\n    return false;\n  }\n  if (typeof global.ArrayBuffer !== 'function') {\n    return false;\n  }\n  if (typeof ArrayBuffer.isView === 'function') {\n    return ArrayBuffer.isView(arrbuf);\n  }\n  if (!arrbuf) {\n    return false;\n  }\n  if (arrbuf instanceof DataView) {\n    return true;\n  }\n  if (arrbuf.buffer && arrbuf.buffer instanceof ArrayBuffer) {\n    return true;\n  }\n  return false;\n}\n// 1. The assert module provides functions that throw\n// AssertionError's when particular conditions are not met. The\n// assert module must conform to the following interface.\n\nvar assert = module.exports = ok;\n\n// 2. The AssertionError is defined in assert.\n// new assert.AssertionError({ message: message,\n//                             actual: actual,\n//                             expected: expected })\n\nvar regex = /\\s*function\\s+([^\\(\\s]*)\\s*/;\n// based on https://github.com/ljharb/function.prototype.name/blob/adeeeec8bfcc6068b187d7d9fb3d5bb1d3a30899/implementation.js\nfunction getName(func) {\n  if (!util.isFunction(func)) {\n    return;\n  }\n  if (functionsHaveNames) {\n    return func.name;\n  }\n  var str = func.toString();\n  var match = str.match(regex);\n  return match && match[1];\n}\nassert.AssertionError = function AssertionError(options) {\n  this.name = 'AssertionError';\n  this.actual = options.actual;\n  this.expected = options.expected;\n  this.operator = options.operator;\n  if (options.message) {\n    this.message = options.message;\n    this.generatedMessage = false;\n  } else {\n    this.message = getMessage(this);\n    this.generatedMessage = true;\n  }\n  var stackStartFunction = options.stackStartFunction || fail;\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(this, stackStartFunction);\n  } else {\n    // non v8 browsers so we can have a stacktrace\n    var err = new Error();\n    if (err.stack) {\n      var out = err.stack;\n\n      // try to strip useless frames\n      var fn_name = getName(stackStartFunction);\n      var idx = out.indexOf('\\n' + fn_name);\n      if (idx >= 0) {\n        // once we have located the function frame\n        // we need to strip out everything before it (and its line)\n        var next_line = out.indexOf('\\n', idx + 1);\n        out = out.substring(next_line + 1);\n      }\n\n      this.stack = out;\n    }\n  }\n};\n\n// assert.AssertionError instanceof Error\nutil.inherits(assert.AssertionError, Error);\n\nfunction truncate(s, n) {\n  if (typeof s === 'string') {\n    return s.length < n ? s : s.slice(0, n);\n  } else {\n    return s;\n  }\n}\nfunction inspect(something) {\n  if (functionsHaveNames || !util.isFunction(something)) {\n    return util.inspect(something);\n  }\n  var rawname = getName(something);\n  var name = rawname ? ': ' + rawname : '';\n  return '[Function' +  name + ']';\n}\nfunction getMessage(self) {\n  return truncate(inspect(self.actual), 128) + ' ' +\n         self.operator + ' ' +\n         truncate(inspect(self.expected), 128);\n}\n\n// At present only the three keys mentioned above are used and\n// understood by the spec. Implementations or sub modules can pass\n// other keys to the AssertionError's constructor - they will be\n// ignored.\n\n// 3. All of the following functions must throw an AssertionError\n// when a corresponding condition is not met, with a message that\n// may be undefined if not provided.  All assertion methods provide\n// both the actual and expected values to the assertion error for\n// display purposes.\n\nfunction fail(actual, expected, message, operator, stackStartFunction) {\n  throw new assert.AssertionError({\n    message: message,\n    actual: actual,\n    expected: expected,\n    operator: operator,\n    stackStartFunction: stackStartFunction\n  });\n}\n\n// EXTENSION! allows for well behaved errors defined elsewhere.\nassert.fail = fail;\n\n// 4. Pure assertion tests whether a value is truthy, as determined\n// by !!guard.\n// assert.ok(guard, message_opt);\n// This statement is equivalent to assert.equal(true, !!guard,\n// message_opt);. To test strictly for the value true, use\n// assert.strictEqual(true, guard, message_opt);.\n\nfunction ok(value, message) {\n  if (!value) fail(value, true, message, '==', assert.ok);\n}\nassert.ok = ok;\n\n// 5. The equality assertion tests shallow, coercive equality with\n// ==.\n// assert.equal(actual, expected, message_opt);\n\nassert.equal = function equal(actual, expected, message) {\n  if (actual != expected) fail(actual, expected, message, '==', assert.equal);\n};\n\n// 6. The non-equality assertion tests for whether two objects are not equal\n// with != assert.notEqual(actual, expected, message_opt);\n\nassert.notEqual = function notEqual(actual, expected, message) {\n  if (actual == expected) {\n    fail(actual, expected, message, '!=', assert.notEqual);\n  }\n};\n\n// 7. The equivalence assertion tests a deep equality relation.\n// assert.deepEqual(actual, expected, message_opt);\n\nassert.deepEqual = function deepEqual(actual, expected, message) {\n  if (!_deepEqual(actual, expected, false)) {\n    fail(actual, expected, message, 'deepEqual', assert.deepEqual);\n  }\n};\n\nassert.deepStrictEqual = function deepStrictEqual(actual, expected, message) {\n  if (!_deepEqual(actual, expected, true)) {\n    fail(actual, expected, message, 'deepStrictEqual', assert.deepStrictEqual);\n  }\n};\n\nfunction _deepEqual(actual, expected, strict, memos) {\n  // 7.1. All identical values are equivalent, as determined by ===.\n  if (actual === expected) {\n    return true;\n  } else if (isBuffer(actual) && isBuffer(expected)) {\n    return compare(actual, expected) === 0;\n\n  // 7.2. If the expected value is a Date object, the actual value is\n  // equivalent if it is also a Date object that refers to the same time.\n  } else if (util.isDate(actual) && util.isDate(expected)) {\n    return actual.getTime() === expected.getTime();\n\n  // 7.3 If the expected value is a RegExp object, the actual value is\n  // equivalent if it is also a RegExp object with the same source and\n  // properties (`global`, `multiline`, `lastIndex`, `ignoreCase`).\n  } else if (util.isRegExp(actual) && util.isRegExp(expected)) {\n    return actual.source === expected.source &&\n           actual.global === expected.global &&\n           actual.multiline === expected.multiline &&\n           actual.lastIndex === expected.lastIndex &&\n           actual.ignoreCase === expected.ignoreCase;\n\n  // 7.4. Other pairs that do not both pass typeof value == 'object',\n  // equivalence is determined by ==.\n  } else if ((actual === null || typeof actual !== 'object') &&\n             (expected === null || typeof expected !== 'object')) {\n    return strict ? actual === expected : actual == expected;\n\n  // If both values are instances of typed arrays, wrap their underlying\n  // ArrayBuffers in a Buffer each to increase performance\n  // This optimization requires the arrays to have the same type as checked by\n  // Object.prototype.toString (aka pToString). Never perform binary\n  // comparisons for Float*Arrays, though, since e.g. +0 === -0 but their\n  // bit patterns are not identical.\n  } else if (isView(actual) && isView(expected) &&\n             pToString(actual) === pToString(expected) &&\n             !(actual instanceof Float32Array ||\n               actual instanceof Float64Array)) {\n    return compare(new Uint8Array(actual.buffer),\n                   new Uint8Array(expected.buffer)) === 0;\n\n  // 7.5 For all other Object pairs, including Array objects, equivalence is\n  // determined by having the same number of owned properties (as verified\n  // with Object.prototype.hasOwnProperty.call), the same set of keys\n  // (although not necessarily the same order), equivalent values for every\n  // corresponding key, and an identical 'prototype' property. Note: this\n  // accounts for both named and indexed properties on Arrays.\n  } else if (isBuffer(actual) !== isBuffer(expected)) {\n    return false;\n  } else {\n    memos = memos || {actual: [], expected: []};\n\n    var actualIndex = memos.actual.indexOf(actual);\n    if (actualIndex !== -1) {\n      if (actualIndex === memos.expected.indexOf(expected)) {\n        return true;\n      }\n    }\n\n    memos.actual.push(actual);\n    memos.expected.push(expected);\n\n    return objEquiv(actual, expected, strict, memos);\n  }\n}\n\nfunction isArguments(object) {\n  return Object.prototype.toString.call(object) == '[object Arguments]';\n}\n\nfunction objEquiv(a, b, strict, actualVisitedObjects) {\n  if (a === null || a === undefined || b === null || b === undefined)\n    return false;\n  // if one is a primitive, the other must be same\n  if (util.isPrimitive(a) || util.isPrimitive(b))\n    return a === b;\n  if (strict && Object.getPrototypeOf(a) !== Object.getPrototypeOf(b))\n    return false;\n  var aIsArgs = isArguments(a);\n  var bIsArgs = isArguments(b);\n  if ((aIsArgs && !bIsArgs) || (!aIsArgs && bIsArgs))\n    return false;\n  if (aIsArgs) {\n    a = pSlice.call(a);\n    b = pSlice.call(b);\n    return _deepEqual(a, b, strict);\n  }\n  var ka = objectKeys(a);\n  var kb = objectKeys(b);\n  var key, i;\n  // having the same number of owned properties (keys incorporates\n  // hasOwnProperty)\n  if (ka.length !== kb.length)\n    return false;\n  //the same set of keys (although not necessarily the same order),\n  ka.sort();\n  kb.sort();\n  //~~~cheap key test\n  for (i = ka.length - 1; i >= 0; i--) {\n    if (ka[i] !== kb[i])\n      return false;\n  }\n  //equivalent values for every corresponding key, and\n  //~~~possibly expensive deep test\n  for (i = ka.length - 1; i >= 0; i--) {\n    key = ka[i];\n    if (!_deepEqual(a[key], b[key], strict, actualVisitedObjects))\n      return false;\n  }\n  return true;\n}\n\n// 8. The non-equivalence assertion tests for any deep inequality.\n// assert.notDeepEqual(actual, expected, message_opt);\n\nassert.notDeepEqual = function notDeepEqual(actual, expected, message) {\n  if (_deepEqual(actual, expected, false)) {\n    fail(actual, expected, message, 'notDeepEqual', assert.notDeepEqual);\n  }\n};\n\nassert.notDeepStrictEqual = notDeepStrictEqual;\nfunction notDeepStrictEqual(actual, expected, message) {\n  if (_deepEqual(actual, expected, true)) {\n    fail(actual, expected, message, 'notDeepStrictEqual', notDeepStrictEqual);\n  }\n}\n\n\n// 9. The strict equality assertion tests strict equality, as determined by ===.\n// assert.strictEqual(actual, expected, message_opt);\n\nassert.strictEqual = function strictEqual(actual, expected, message) {\n  if (actual !== expected) {\n    fail(actual, expected, message, '===', assert.strictEqual);\n  }\n};\n\n// 10. The strict non-equality assertion tests for strict inequality, as\n// determined by !==.  assert.notStrictEqual(actual, expected, message_opt);\n\nassert.notStrictEqual = function notStrictEqual(actual, expected, message) {\n  if (actual === expected) {\n    fail(actual, expected, message, '!==', assert.notStrictEqual);\n  }\n};\n\nfunction expectedException(actual, expected) {\n  if (!actual || !expected) {\n    return false;\n  }\n\n  if (Object.prototype.toString.call(expected) == '[object RegExp]') {\n    return expected.test(actual);\n  }\n\n  try {\n    if (actual instanceof expected) {\n      return true;\n    }\n  } catch (e) {\n    // Ignore.  The instanceof check doesn't work for arrow functions.\n  }\n\n  if (Error.isPrototypeOf(expected)) {\n    return false;\n  }\n\n  return expected.call({}, actual) === true;\n}\n\nfunction _tryBlock(block) {\n  var error;\n  try {\n    block();\n  } catch (e) {\n    error = e;\n  }\n  return error;\n}\n\nfunction _throws(shouldThrow, block, expected, message) {\n  var actual;\n\n  if (typeof block !== 'function') {\n    throw new TypeError('\"block\" argument must be a function');\n  }\n\n  if (typeof expected === 'string') {\n    message = expected;\n    expected = null;\n  }\n\n  actual = _tryBlock(block);\n\n  message = (expected && expected.name ? ' (' + expected.name + ').' : '.') +\n            (message ? ' ' + message : '.');\n\n  if (shouldThrow && !actual) {\n    fail(actual, expected, 'Missing expected exception' + message);\n  }\n\n  var userProvidedMessage = typeof message === 'string';\n  var isUnwantedException = !shouldThrow && util.isError(actual);\n  var isUnexpectedException = !shouldThrow && actual && !expected;\n\n  if ((isUnwantedException &&\n      userProvidedMessage &&\n      expectedException(actual, expected)) ||\n      isUnexpectedException) {\n    fail(actual, expected, 'Got unwanted exception' + message);\n  }\n\n  if ((shouldThrow && actual && expected &&\n      !expectedException(actual, expected)) || (!shouldThrow && actual)) {\n    throw actual;\n  }\n}\n\n// 11. Expected to throw an error:\n// assert.throws(block, Error_opt, message_opt);\n\nassert.throws = function(block, /*optional*/error, /*optional*/message) {\n  _throws(true, block, error, message);\n};\n\n// EXTENSION! This is annoying to write outside this module.\nassert.doesNotThrow = function(block, /*optional*/error, /*optional*/message) {\n  _throws(false, block, error, message);\n};\n\nassert.ifError = function(err) { if (err) throw err; };\n\nvar objectKeys = Object.keys || function (obj) {\n  var keys = [];\n  for (var key in obj) {\n    if (hasOwn.call(obj, key)) keys.push(key);\n  }\n  return keys;\n};\n","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n","module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  // Allow for deprecating things in the process of starting up.\n  if (isUndefined(global.process)) {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  if (process.noDeprecation === true) {\n    return fn;\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","import * as assert from \"assert\";\nimport { DosCommandInteface } from \"../js-dos-ts/js-dos-ci\";\nimport { doThen } from \"./do\";\n\n// Compare\n// =======\n// Compare image from url, and screenshot from DosBox\n\nexport function compareAndExit(imageUrl: string, ci: DosCommandInteface, done: () => void) {\n    compare(imageUrl, ci, (wrong) => {\n        assert.equal(0, wrong);\n        ci.exit();\n        done();\n    });\n}\n\nconst compare = (imageUrl: string, ci: DosCommandInteface, callback: (wrong: number) => void) => {\n    doThen(ci.screenshot(), (actualUrl: string) => {\n        const img = new Image();\n        img.onload = () => {\n            assert(img.width === ci.width(), \"Invalid width: \" + ci.width() + \", should be \" + img.width);\n            assert(img.height === ci.height(), \"Invalid height: \" + ci.height() + \", should be \" + img.height);\n\n            const canvas = document.createElement(\"canvas\");\n            canvas.width = img.width;\n            canvas.height = img.height;\n            const ctx = canvas.getContext(\"2d\");\n            ctx.drawImage(img, 0, 0);\n            const expected = ctx.getImageData(0, 0, img.width, img.height).data;\n\n            const actualImage = new Image();\n            actualImage.onload = () => {\n                /*\n                document.body.appendChild(img); // for comparisons\n                var div = document.createElement('div');\n                div.innerHTML = '^=expected, v=actual';\n                document.body.appendChild(div);\n                document.body.appendChild(actualImage); // to grab it for creating the test reference\n                */\n\n                const actualCanvas = document.createElement(\"canvas\");\n                actualCanvas.width = actualImage.width;\n                actualCanvas.height = actualImage.height;\n                const actualCtx = actualCanvas.getContext(\"2d\");\n                actualCtx.drawImage(actualImage, 0, 0);\n                const actual = actualCtx.getImageData(0, 0, actualImage.width, actualImage.height).data;\n\n                let total = 0;\n                const width = img.width;\n                const height = img.height;\n                for (let x = 0; x < width; x++) {\n                    for (let y = 0; y < height; y++) {\n                        total += Math.abs(expected[y * width * 4 + x * 4 + 0] - actual[y * width * 4 + x * 4 + 0]);\n                        total += Math.abs(expected[y * width * 4 + x * 4 + 1] - actual[y * width * 4 + x * 4 + 1]);\n                        total += Math.abs(expected[y * width * 4 + x * 4 + 2] - actual[y * width * 4 + x * 4 + 2]);\n                    }\n                }\n\n                // floor, to allow some margin of error for antialiasing\n                const wrong = Math.floor(total / (img.width * img.height * 3));\n                callback(wrong);\n            };\n            actualImage.src = actualUrl;\n        };\n        img.src = imageUrl;\n    });\n};\n","import assert = require(\"assert\");\nimport { DosMainFn, DosReadyPromise } from \"../js-dos-ts/js-dos\";\nimport { DosFS } from \"../js-dos-ts/js-dos-fs\";\n\n// Do\n// ==\n// We use this functions to avoid problem of throwing,\n// exceptions inside promise.\n// Mocha can't handle exceptions if they are throwed in promise\n\nexport function doThen<T>(promise: Promise<T>, fn: (v: T) => void) {\n    promise.then((v: T) => {\n        const topFn = () => {\n            fn(v);\n        };\n\n        setTimeout(topFn, 1);\n    });\n}\n\nexport function doCatch<T>(promise: Promise<T>, fn: (v: string) => void) {\n    promise.catch((v: string) => {\n        const topFn = () => {\n            fn(v);\n        };\n\n        setTimeout(topFn, 1);\n    });\n}\n\nexport function doNext<T>(promise: Promise<T>, fn: (v: T) => void) {\n    doThen(promise, fn);\n    doCatch(promise, (msg: string) => assert.fail(msg));\n}\n\nexport function doReady(promise: DosReadyPromise, fn: (fs: DosFS, main: DosMainFn) => void) {\n    doThen(promise, (runtime) => {\n        fn(runtime.fs, runtime.main);\n    });\n    doCatch(promise, (msg: string) => assert.fail(msg));\n}\n","/* tslint:disable:max-line-length */\n/* tslint:disable:no-console */\n\nimport * as assert from \"assert\";\nimport { Dos } from \"../js-dos-ts/js-dos\";\nimport { DosCommandInteface } from \"../js-dos-ts/js-dos-ci\";\nimport { Host } from \"../js-dos-ts/js-dos-host\";\nimport { DosModule } from \"../js-dos-ts/js-dos-module\";\nimport { DosOptions } from \"../js-dos-ts/js-dos-options\";\nimport { compareAndExit } from \"./compare\";\nimport { doCatch, doNext, doReady, doThen } from \"./do\";\n\nsuite(\"js-dos-host\");\n\ntest(\"loader should notify about error if wasm is not supported\", (done) => {\n    const oldValue = Host.wasmSupported;\n    Host.wasmSupported = false;\n    Host.resolveDosBox(\"wrongurl.js\", {\n        onerror: (message: string) => {\n            Host.wasmSupported = oldValue;\n            assert.equal(\"WebAssembly is not supported, can't resolve wdosbox\", message);\n            done();\n        },\n    } as DosModule);\n});\n\ntest(\"loader should notify about error, if it can't download wdosbox\", (done) => {\n    Host.resolveDosBox(\"wrongurl.js\", {\n        onerror: (message: string) => {\n            assert.equal(\"Can't download wasm, code: 404, message: connection problem, url: wrongurl.wasm.js\", message);\n            done();\n        },\n    } as DosModule);\n});\n\ntest(\"loader should show progress loading\", (done) => {\n    let lastLoaded = -1;\n    Host.resolveDosBox(\"/wdosbox.js\", {\n        onprogress: (stage: string, total: number, loaded: number) => {\n            console.log(stage, total, loaded);\n            assert.equal(true, loaded <= total, loaded + \"<=\" + total);\n            assert.equal(true, lastLoaded <= loaded, lastLoaded + \"<=\" + loaded);\n            lastLoaded = loaded;\n        },\n        ondosbox: (dosbox: any, instantiateWasm: any) => {\n            done();\n        },\n        onerror: (message: string) => {\n            assert.fail();\n        },\n    } as DosModule);\n});\n\ntest(\"loader should never load twice wdosbox\", (done) => {\n    Host.resolveDosBox(\"/wdosbox.js\", {\n        onprogress: (stage: string, total: number, loaded: number) => {\n            assert.fail();\n        },\n        ondosbox: (dosbox: any, instantiateWasm: any) => {\n            done();\n        },\n        onerror: (message: string) => {\n            assert.fail();\n        },\n    } as DosModule);\n});\n\ntest(\"loader should fire event when wdosbox is loaded\", (done) => {\n    Host.resolveDosBox(\"/wdosbox.js\", {\n        ondosbox: (dosbox: any, instantiateWasm: any) => {\n            assert.ok(dosbox);\n            assert.ok(instantiateWasm);\n            done();\n        },\n        onerror: (message: string) => {\n            assert.fail();\n        },\n    } as DosModule);\n});\n\nsuite(\"js-dos\");\n\ntest(\"js-dos can't start without canvas (listener style)\", (done) => {\n    Dos(null, {\n        wdosboxUrl: \"/wdosbox.js\",\n        onerror: (message: string) => {\n            assert.equal(\"canvas field is required, but not set!\", message);\n            done();\n        },\n    } as DosOptions);\n});\n\ntest(\"js-dos can't start without canvas (promise style)\", (done) => {\n    const dos = Dos(null, {\n        wdosboxUrl: \"/wdosbox.js\",\n    } as DosOptions);\n    doCatch(dos, (message) => {\n        assert.equal(\"canvas field is required, but not set!\", message);\n        done();\n    });\n    doThen(dos, () => {\n        assert.fail();\n    });\n});\n\ntest(\"js-dos should start with canvas\", (done) => {\n    const dos = Dos(document.getElementById(\"canvas\") as HTMLCanvasElement, {\n        wdosboxUrl: \"/wdosbox.js\",\n    });\n    doReady(dos, (fs, main) => {\n        doNext(main([]), (ci) => {\n            ci.exit();\n            done();\n        });\n    });\n});\n\ntest(\"js-dos can take screenshot of canvas\", (done) => {\n    const dos = Dos(document.getElementById(\"canvas\") as HTMLCanvasElement, {\n        wdosboxUrl: \"/wdosbox.js\",\n    });\n    doReady(dos, (fs, main) => {\n        doNext(main([]), (ci) => {\n            compareAndExit(\"init.png\", ci, done);\n        });\n    });\n});\n\ntest(\"js-dos can run digger.zip\", (done) => {\n    const dos = Dos(document.getElementById(\"canvas\") as HTMLCanvasElement, {\n        wdosboxUrl: \"/wdosbox.js\",\n    });\n\n    doReady(dos, (fs, main) => {\n        doNext(fs.extract(\"digger.zip\"), () => {\n            doNext(main([\"DIGGER.COM\"]), (ci) => {\n                const fn = () => {\n                    // compareAndExit(\"digger.png\", ci, done);\n                    saveImage(ci);\n                };\n\n                setTimeout(fn, 5000);\n            });\n        });\n    });\n});\n\nconst saveImage = (ci: DosCommandInteface) => {\n    ci.screenshot().then((data) => {\n        const w = window.open(\"about:blank\", \"image from canvas\");\n        w.document.write(\"<img src='\" + data + \"' alt='from canvas'/>\");\n    });\n};\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy1kb3MtdHMvanMtZG9zLWJ1aWxkLnRzIiwianMtZG9zLXRzL2pzLWRvcy1jaS50cyIsImpzLWRvcy10cy9qcy1kb3MtZnMudHMiLCJqcy1kb3MtdHMvanMtZG9zLWhvc3QudHMiLCJqcy1kb3MtdHMvanMtZG9zLW1vZHVsZS50cyIsImpzLWRvcy10cy9qcy1kb3Mtb3B0aW9ucy50cyIsImpzLWRvcy10cy9qcy1kb3MtdWkudHMiLCJqcy1kb3MtdHMvanMtZG9zLXhoci50cyIsImpzLWRvcy10cy9qcy1kb3MudHMiLCJub2RlX21vZHVsZXMvYXNzZXJ0L2Fzc2VydC5qcyIsIm5vZGVfbW9kdWxlcy9hc3NlcnQvbm9kZV9tb2R1bGVzL2luaGVyaXRzL2luaGVyaXRzX2Jyb3dzZXIuanMiLCJub2RlX21vZHVsZXMvYXNzZXJ0L25vZGVfbW9kdWxlcy91dGlsL3N1cHBvcnQvaXNCdWZmZXJCcm93c2VyLmpzIiwibm9kZV9tb2R1bGVzL2Fzc2VydC9ub2RlX21vZHVsZXMvdXRpbC91dGlsLmpzIiwibm9kZV9tb2R1bGVzL3Byb2Nlc3MvYnJvd3Nlci5qcyIsInRlc3QvY29tcGFyZS50cyIsInRlc3QvZG8udHMiLCJ0ZXN0L3Rlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0FDQUE7QUFDQTtBQUNBOzs7QUFFYSxRQUFBLEtBQUEsR0FBUTtBQUNqQixhQUFTLCtDQURRO0FBRWpCLGNBQVUsT0FGTztBQUdqQixZQUFTO0FBSFEsQ0FBUjs7Ozs7Ozs7Ozs7SUNLQSxrQjtBQVNULGdDQUFZLEdBQVosRUFBNEIsT0FBNUIsRUFBcUU7QUFBQTs7QUFBQTs7QUFIN0QsYUFBQSxlQUFBLEdBQTRCLEVBQTVCO0FBQ0EsYUFBQSxpQkFBQSxHQUF1QyxFQUF2QztBQUdKLGFBQUssR0FBTCxHQUFXLEdBQVg7QUFDQSxhQUFLLEVBQUwsR0FBVyxHQUFYO0FBQ0EsYUFBSyxHQUFMLEdBQVksR0FBWjtBQUNBLGFBQUssR0FBTCxDQUFTLElBQVQsR0FBZ0IsVUFBQyxHQUFELEVBQWdDO0FBQUEsOENBQWYsSUFBZTtBQUFmLG9CQUFlO0FBQUE7O0FBQzVDLGtCQUFLLE1BQUwsQ0FBWSxHQUFaLEVBQWlCLElBQWpCO0FBQ0gsU0FGRDtBQUdBLGFBQUssT0FBTCxHQUFlLE9BQWY7QUFDSDs7OztnQ0FFVztBQUNSLG1CQUFPLEtBQUssR0FBTCxDQUFTLE1BQVQsQ0FBZ0IsS0FBdkI7QUFDSDs7O2lDQUVZO0FBQ1QsbUJBQU8sS0FBSyxHQUFMLENBQVMsTUFBVCxDQUFnQixNQUF2QjtBQUNIOzs7Z0NBRTRCO0FBQUE7O0FBQUEsK0NBQWIsR0FBYTtBQUFiLG1CQUFhO0FBQUE7O0FBQ3pCLGdCQUFJLElBQUksTUFBSixLQUFlLENBQW5CLEVBQXNCO0FBQ2xCO0FBQ0g7QUFFRCxtQkFBTyxJQUFJLE9BQUosQ0FBWSxVQUFDLE9BQUQsRUFBVSxNQUFWLEVBQW9CO0FBQ25DLHVCQUFLLGlCQUFMLENBQXVCLElBQXZCLENBQTRCLE9BQTVCO0FBRG1DO0FBQUE7QUFBQTs7QUFBQTtBQUVuQyx5Q0FBbUIsR0FBbkIsOEhBQXdCO0FBQUEsNEJBQWIsSUFBYTs7QUFDcEIsK0JBQUssZUFBTCxDQUFxQixJQUFyQixDQUEwQixJQUExQjtBQUNIO0FBSmtDO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7O0FBS25DLHVCQUFLLGlCQUFMO0FBQ0gsYUFOTSxDQUFQO0FBT0g7OztxQ0FFZ0I7QUFBQTs7QUFDYixtQkFBTyxJQUFJLE9BQUosQ0FBWSxVQUFDLE9BQUQsRUFBWTtBQUMzQix1QkFBSyxHQUFMLENBQVMsSUFBVCxDQUFjLFlBQWQsRUFBNEIsRUFBNUIsRUFBZ0MsVUFBQyxJQUFELEVBQVM7QUFDckMsNEJBQVEsSUFBUjtBQUNILGlCQUZEO0FBR0gsYUFKTSxDQUFQO0FBS0g7OzsrQkFFVTtBQUNQLGdCQUFJO0FBQ0EscUJBQUssR0FBTCxDQUFTLElBQVQsQ0FBYyxNQUFkO0FBQ0gsYUFGRCxDQUVFLE9BQU8sQ0FBUCxFQUFVO0FBQ1IsdUJBQU8sQ0FBUDtBQUNIO0FBRUQsaUJBQUssR0FBTCxDQUFTLEtBQVQsQ0FBZSx5QkFBZjtBQUNBLG1CQUFPLENBQUMsQ0FBUjtBQUNIOzs7cUNBRW9CLEksRUFBWTtBQUM3QixpQkFBSyxHQUFMLENBQVMsSUFBVCxDQUFjLGVBQWQsRUFBK0IsT0FBTyxFQUF0QztBQUNIOzs7NENBRXdCO0FBQ3JCLGlCQUFLLFlBQUwsQ0FBa0IsRUFBbEI7QUFDSDs7OytCQUVjLEcsRUFBYSxJLEVBQVc7QUFDbkMsb0JBQVEsR0FBUjtBQUNJLHFCQUFLLE9BQUw7QUFDSSx5QkFBSyxPQUFMLENBQWEsSUFBYjtBQUNBO0FBQ0oscUJBQUssYUFBTDtBQUNJLHdCQUFJLEtBQUssZUFBTCxDQUFxQixNQUFyQixLQUFnQyxDQUFwQyxFQUF1QztBQUNuQztBQUNIO0FBRUQsd0JBQU0sU0FBaUIsS0FBSyxDQUFMLENBQXZCO0FBQ0Esd0JBQU0sWUFBb0IsS0FBSyxDQUFMLENBQTFCO0FBRUEsd0JBQU0sTUFBTSxLQUFLLGVBQUwsQ0FBcUIsS0FBckIsRUFBWjtBQUNBLHdCQUFNLFlBQWEsS0FBSyxFQUFMLENBQWdCLGVBQWhCLENBQWdDLEdBQWhDLElBQXVDLENBQTFEO0FBRUEsd0JBQUksWUFBWSxTQUFoQixFQUEyQjtBQUN2Qiw2QkFBSyxHQUFMLENBQVMsT0FBVCxDQUFpQix3QkFBd0IsR0FBeEIsR0FDYiw2Q0FEYSxHQUNtQyxTQURwRDtBQUVBO0FBQ0g7QUFFQSx5QkFBSyxFQUFMLENBQWdCLFlBQWhCLENBQTZCLEdBQTdCLEVBQWtDLE1BQWxDLEVBQTBDLFNBQTFDO0FBRUQsd0JBQUksS0FBSyxlQUFMLENBQXFCLE1BQXJCLEtBQWdDLENBQXBDLEVBQXVDO0FBQUE7QUFBQTtBQUFBOztBQUFBO0FBQ25DLGtEQUFzQixLQUFLLGlCQUEzQixtSUFBOEM7QUFBQSxvQ0FBbkMsT0FBbUM7O0FBQzFDO0FBQ0g7QUFIa0M7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7QUFJbkMsNkJBQUssaUJBQUwsR0FBeUIsRUFBekI7QUFDSCxxQkFMRCxNQUtPO0FBQ0gsNkJBQUssaUJBQUw7QUFDSDtBQUNMO0FBQ0E7QUFoQ0o7QUFrQ0g7Ozs7OztBQXZHTCxRQUFBLGtCQUFBLEdBQUEsa0JBQUE7Ozs7Ozs7Ozs7QUNQQSxJQUFBLGVBQUEsUUFBQSxjQUFBLENBQUE7QUFFQTtBQUNBO0FBQ0E7O0lBRWEsSztBQUlULG1CQUFZLEdBQVosRUFBMEI7QUFBQTs7QUFDdEIsYUFBSyxHQUFMLEdBQVcsR0FBWDtBQUNBLGFBQUssRUFBTCxHQUFVLEdBQVY7QUFDSDtBQUVEO0FBQ0E7Ozs7O2dDQUNlLEcsRUFBaUM7QUFBQTs7QUFBQSxnQkFBcEIsSUFBb0IsdUVBQUwsS0FBSzs7QUFDNUMsbUJBQU8sSUFBSSxPQUFKLENBQWtCLFVBQUMsT0FBRCxFQUFVLE1BQVYsRUFBb0I7QUFDekMsb0JBQUksU0FBUyxLQUFiLEVBQW9CO0FBQ2hCLDJCQUFPLCtCQUFQO0FBQ0E7QUFDSDtBQUVELG9CQUFJLGFBQUEsR0FBSixDQUFRLEdBQVIsRUFBYTtBQUNULGtDQUFjLGFBREw7QUFFVCwwQkFBTSxjQUFDLEdBQUQ7QUFBQSwrQkFBUyxPQUFPLEdBQVAsQ0FBVDtBQUFBLHFCQUZHO0FBR1QsOEJBQVUsa0JBQUMsS0FBRCxFQUFRLE1BQVI7QUFBQSwrQkFBbUIsTUFBSyxHQUFMLENBQVMsVUFBVCxDQUFvQixpQkFBaUIsR0FBckMsRUFBMEMsS0FBMUMsRUFBaUQsTUFBakQsQ0FBbkI7QUFBQSxxQkFIRDtBQUlULDZCQUFTLGlCQUFDLElBQUQsRUFBc0I7QUFDM0IsNEJBQU0sUUFBUSxJQUFJLFVBQUosQ0FBZSxJQUFmLENBQWQ7QUFDQSw0QkFBTSxTQUFTLE1BQUssRUFBTCxDQUFRLE9BQVIsQ0FBZ0IsTUFBTSxNQUF0QixDQUFmO0FBQ0EsOEJBQUssRUFBTCxDQUFRLE1BQVIsQ0FBZSxHQUFmLENBQW1CLEtBQW5CLEVBQTBCLE1BQTFCO0FBQ0EsNEJBQU0sVUFBVyxNQUFLLEVBQUwsQ0FBZ0IsWUFBaEIsQ0FBNkIsTUFBN0IsRUFBcUMsTUFBTSxNQUEzQyxDQUFqQjtBQUNBLDhCQUFLLEVBQUwsQ0FBUSxLQUFSLENBQWMsTUFBZDtBQUVBLDRCQUFJLFlBQVksQ0FBaEIsRUFBbUI7QUFDZjtBQUNILHlCQUZELE1BRU87QUFDSCxtQ0FBTyxnQ0FBZ0MsT0FBaEMsR0FBMEMseUJBQWpEO0FBQ0g7QUFDSjtBQWhCUSxpQkFBYjtBQWtCSCxhQXhCTSxDQUFQO0FBeUJIOzs7Ozs7QUFyQ0wsUUFBQSxLQUFBLEdBQUEsS0FBQTs7Ozs7Ozs7Ozs7O0FDUkEsSUFBQSxpQkFBQSxRQUFBLGdCQUFBLENBQUE7QUFFQSxJQUFBLGVBQUEsUUFBQSxjQUFBLENBQUE7O0lBRU0sTztBQU9GLHVCQUFBO0FBQUE7O0FBTE8sYUFBQSxhQUFBLEdBQWdCLEtBQWhCO0FBQ0EsYUFBQSxNQUFBLEdBQVMsTUFBVDtBQUVDLGFBQUEsY0FBQSxHQUErQixJQUEvQjtBQUdKLGFBQUssTUFBTCxDQUFZLE9BQVosR0FBc0IsRUFBdEI7QUFFQSxZQUFJO0FBQ0EsZ0JBQUksUUFBTyxXQUFQLHlDQUFPLFdBQVAsT0FBdUIsUUFBdkIsSUFDQSxPQUFPLFlBQVksV0FBbkIsS0FBbUMsVUFEbkMsSUFFQSxPQUFPLFlBQVksT0FBbkIsS0FBK0IsVUFGbkMsRUFFK0M7QUFFM0Msb0JBQU0sVUFBVSxJQUFJLFlBQVksTUFBaEIsQ0FBdUIsV0FBVyxFQUFYLENBQWMsR0FBZCxFQUFtQixJQUFuQixFQUF5QixJQUF6QixFQUErQixJQUEvQixFQUFxQyxJQUFyQyxFQUEyQyxJQUEzQyxFQUFpRCxJQUFqRCxFQUF1RCxJQUF2RCxDQUF2QixDQUFoQjtBQUNBLG9CQUFJLG1CQUFtQixZQUFZLE1BQW5DLEVBQTJDO0FBQ3ZDLHlCQUFLLGFBQUwsR0FBcUIsSUFBSSxZQUFZLFFBQWhCLENBQXlCLE9BQXpCLGFBQTZDLFlBQVksUUFBOUU7QUFDSDtBQUNKO0FBQ0osU0FWRCxDQVVFLE9BQU8sS0FBUCxFQUFjO0FBQ1o7QUFDSDtBQUVELGFBQUssUUFBTDtBQUNIOzs7O3NDQUVvQixHLEVBQWEsTSxFQUFpQjtBQUFBOztBQUMvQyxnQkFBSSxLQUFLLE1BQUwsQ0FBWSxPQUFaLENBQW9CLE9BQXhCLEVBQWlDO0FBQzdCLHVCQUFPLFFBQVAsQ0FBZ0IsS0FBSyxNQUFMLENBQVksT0FBWixDQUFvQixPQUFwQyxFQUE2QyxLQUFLLE1BQUwsQ0FBWSxPQUFaLENBQW9CLGVBQWpFO0FBQ0E7QUFDSDtBQUVELGdCQUFJLENBQUMsS0FBSyxhQUFWLEVBQXlCO0FBQ3JCLHVCQUFPLE9BQVAsQ0FBZSxxREFBZjtBQUNBO0FBQ0g7QUFFRCxnQkFBSSxLQUFLLGNBQUwsS0FBd0IsSUFBNUIsRUFBa0M7QUFDOUIscUJBQUssY0FBTCxHQUFzQixLQUFLLGFBQUwsQ0FBbUIsR0FBbkIsRUFBd0IsTUFBeEIsQ0FBdEI7QUFDSDtBQUVELGlCQUFLLGNBQUwsQ0FBb0IsSUFBcEIsQ0FBeUIsVUFBQyxRQUFELEVBQWtCO0FBQ3ZDO0FBQ0Esb0JBQU0sS0FBSyxTQUFMLEVBQUssR0FBSztBQUNaLDBCQUFLLGNBQUwsR0FBc0IsSUFBdEI7QUFDQSwyQkFBTyxRQUFQLENBQWdCLE1BQUssTUFBTCxDQUFZLE9BQVosQ0FBb0IsT0FBcEMsRUFBNkMsTUFBSyxNQUFMLENBQVksT0FBWixDQUFvQixlQUFqRTtBQUNILGlCQUhEO0FBSUEsMkJBQVcsRUFBWCxFQUFlLENBQWY7QUFDSCxhQVBELEVBT0csVUFBQyxPQUFELEVBQW9CO0FBQ25CO0FBQ0Esb0JBQU0sS0FBSyxTQUFMLEVBQUssR0FBSztBQUNaLDBCQUFLLGNBQUwsR0FBc0IsSUFBdEI7QUFDQSwyQkFBTyxPQUFQLENBQWUsT0FBZjtBQUNILGlCQUhEO0FBSUEsMkJBQVcsRUFBWCxFQUFlLENBQWY7QUFDSCxhQWREO0FBZUg7OztzQ0FFcUIsRyxFQUFhLE0sRUFBaUI7QUFBQTs7QUFDaEQsZ0JBQU0sYUFBYSxlQUFBLEtBQUEsQ0FBTSxRQUFOLEdBQWlCLGVBQUEsS0FBQSxDQUFNLE1BQTFDO0FBQ0EsbUJBQU8sSUFBSSxPQUFKLENBQVksVUFBQyxPQUFELEVBQVUsTUFBVixFQUFvQjtBQUNuQyxvQkFBTSxVQUFVLElBQUksT0FBSixDQUFZLEtBQVosRUFBbUIsVUFBbkIsQ0FBaEI7QUFFQSxvQkFBSSxhQUFBLEdBQUosQ0FBUSxPQUFSLEVBQWlCO0FBQ2Isa0NBQWMsYUFERDtBQUViLDhCQUFVLGtCQUFDLEtBQUQsRUFBUSxNQUFSLEVBQWtCO0FBQ3hCLDRCQUFJLE9BQU8sVUFBWCxFQUF1QjtBQUNuQixtQ0FBTyxVQUFQLENBQWtCLGtCQUFsQixFQUFzQyxVQUF0QyxFQUFrRCxNQUFsRDtBQUNIO0FBQ0oscUJBTlk7QUFPYiwwQkFBTSxjQUFDLEdBQUQsRUFBYyxNQUFkLEVBQThCLE9BQTlCLEVBQWlEO0FBQ25ELCtCQUFPLGdDQUFnQyxNQUFoQyxHQUNILGFBREcsR0FDYSxPQURiLEdBQ3VCLFNBRHZCLEdBQ21DLEdBRDFDO0FBRUgscUJBVlk7QUFXYiw2QkFBUyxpQkFBQyxRQUFELEVBQWtCO0FBQ3ZCLDRCQUFNLFVBQVUsWUFBWSxPQUFaLENBQW9CLFFBQXBCLENBQWhCO0FBQ0EsNEJBQU0sV0FBVyxTQUFYLFFBQVcsQ0FBQyxNQUFELEVBQWdCO0FBQzdCLG1DQUFPLFNBQVMsRUFBaEI7QUFDSCx5QkFGRDtBQUdBLGdDQUFRLEtBQVIsQ0FBYyxRQUFkO0FBQ0EsZ0NBQVEsSUFBUixDQUFhLFVBQUMsVUFBRCxFQUFlO0FBQ3hCLG1DQUFLLE1BQUwsQ0FBWSxPQUFaLENBQW9CLGVBQXBCLEdBQXNDLFVBQUMsSUFBRCxFQUFZLGVBQVosRUFBb0M7QUFDdEUsdUNBQU8sWUFBWSxXQUFaLENBQXdCLFVBQXhCLEVBQW9DLElBQXBDLEVBQ0YsS0FERSxDQUNJLFFBREosRUFFRixJQUZFLENBRUcsVUFBQyxRQUFELEVBQWE7QUFDZixvREFBZ0IsUUFBaEIsRUFBMEIsVUFBMUI7QUFDSCxpQ0FKRSxDQUFQO0FBS0gsNkJBTkQ7QUFRQSxnQ0FBSSxhQUFBLEdBQUosQ0FBUSxHQUFSLEVBQWE7QUFDVCwwQ0FBVSxrQkFBQyxLQUFELEVBQVEsTUFBUixFQUFrQjtBQUN4Qix3Q0FBSSxPQUFPLFVBQVgsRUFBdUI7QUFDbkIsK0NBQU8sVUFBUCxDQUFrQixrQkFBbEIsRUFBc0MsVUFBdEMsRUFBa0QsZUFBQSxLQUFBLENBQU0sUUFBTixHQUFpQixNQUFuRTtBQUNIO0FBQ0osaUNBTFE7QUFNVCxzQ0FBTSxjQUFDLEdBQUQsRUFBYyxNQUFkLEVBQThCLE9BQTlCLEVBQWlEO0FBQ25ELDJDQUFPLHNDQUFzQyxNQUF0QyxHQUNILGFBREcsR0FDYSxPQURiLEdBQ3VCLFNBRHZCLEdBQ21DLEdBRDFDO0FBRUgsaUNBVFE7QUFVVCx5Q0FBUyxpQkFBQyxRQUFELEVBQWtCO0FBQ3ZCLDJDQUFPLFVBQVAsQ0FBa0Isa0JBQWxCLEVBQXNDLFVBQXRDLEVBQWtELFVBQWxEO0FBRUE7QUFDQSx5Q0FBSyxJQUFMLENBQVUsTUFBVixFQUFrQixRQUFsQjtBQUNBLDRDQUFRLE9BQUssTUFBTCxDQUFZLE9BQVosQ0FBb0IsT0FBNUI7QUFDSDtBQWhCUSw2QkFBYjtBQWtCSCx5QkEzQkQ7QUE0Qkg7QUE3Q1ksaUJBQWpCO0FBK0NILGFBbERNLENBQVA7QUFtREg7QUFFRDtBQUNBOzs7O21DQUNnQjtBQUNaLGdCQUFJLENBQUMsS0FBSyxJQUFOLElBQWMsS0FBSyxJQUFMLENBQVUsVUFBVixFQUFzQixDQUF0QixNQUE2QixDQUFDLENBQWhELEVBQW1EO0FBQy9DLHFCQUFLLElBQUwsR0FBWSxTQUFTLElBQVQsQ0FBYyxDQUFkLEVBQXNCLENBQXRCLEVBQTRCO0FBQ3BDLHdCQUFNLEtBQUssTUFBTSxFQUFqQjtBQUNBLHdCQUFNLEtBQUssSUFBSSxNQUFmO0FBQ0Esd0JBQU0sS0FBSyxNQUFNLEVBQWpCO0FBQ0Esd0JBQU0sS0FBSyxJQUFJLE1BQWY7QUFDQSwyQkFBUSxLQUFLLEVBQUwsSUFBWSxLQUFLLEVBQUwsR0FBVSxLQUFLLEVBQWhCLElBQXVCLEVBQWxDLENBQUQsR0FBMEMsQ0FBakQ7QUFDSCxpQkFORDtBQU9IO0FBQ0QsaUJBQUssSUFBTCxHQUFZLEtBQUssSUFBakI7QUFFQSxnQkFBSSxDQUFDLEtBQUssTUFBVixFQUFrQjtBQUNkLHFCQUFLLE1BQUwsR0FBYyxVQUFTLENBQVQsRUFBVTtBQUFJLDJCQUFPLENBQVA7QUFBVyxpQkFBdkM7QUFDSDtBQUNELGlCQUFLLE1BQUwsR0FBYyxLQUFLLE1BQW5CO0FBRUEsZ0JBQUksQ0FBQyxLQUFLLEtBQVYsRUFBaUI7QUFDYixxQkFBSyxLQUFMLEdBQWEsVUFBUyxDQUFULEVBQVU7QUFDbkIsd0JBQUksTUFBTSxDQUFWO0FBQ0EseUJBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxFQUFwQixFQUF3QixHQUF4QixFQUE2QjtBQUN6Qiw0QkFBSSxJQUFLLEtBQU0sS0FBSyxDQUFwQixFQUF5QjtBQUFFLG1DQUFPLENBQVA7QUFBVztBQUN6QztBQUNELDJCQUFPLEVBQVA7QUFDSCxpQkFORDtBQU9IO0FBQ0QsaUJBQUssS0FBTCxHQUFhLEtBQUssS0FBbEI7QUFFQSxnQkFBSSxDQUFDLEtBQUssS0FBVixFQUFpQjtBQUNiLHFCQUFLLEtBQUwsR0FBYSxVQUFTLENBQVQsRUFBVTtBQUNuQiwyQkFBTyxJQUFJLENBQUosR0FBUSxLQUFLLElBQUwsQ0FBVSxDQUFWLENBQVIsR0FBdUIsS0FBSyxLQUFMLENBQVcsQ0FBWCxDQUE5QjtBQUNILGlCQUZEO0FBR0g7QUFDRCxpQkFBSyxLQUFMLEdBQWEsS0FBSyxLQUFsQjtBQUNIOzs7Ozs7QUFHUSxRQUFBLElBQUEsR0FBTyxJQUFJLE9BQUosRUFBUDs7Ozs7Ozs7Ozs7Ozs7QUM1SmIsSUFBQSxjQUFBLFFBQUEsYUFBQSxDQUFBO0FBQ0EsSUFBQSxjQUFBLFFBQUEsYUFBQSxDQUFBO0FBQ0EsSUFBQSxtQkFBQSxRQUFBLGtCQUFBLENBQUE7QUFDQSxJQUFBLGNBQUEsUUFBQSxhQUFBLENBQUE7O0lBRWEsUzs7O0FBU1QsdUJBQVksTUFBWixFQUF1QyxPQUF2QyxFQUE2RTtBQUFBOztBQUFBOztBQVJ0RSxjQUFBLE9BQUEsR0FBbUIsS0FBbkI7QUFDQSxjQUFBLE1BQUEsR0FBNEIsSUFBNUI7QUFDQyxjQUFBLEVBQUEsR0FBa0MsSUFBbEM7QUFFQSxjQUFBLEVBQUEsR0FBWSxJQUFaO0FBQ0EsY0FBQSxFQUFBLEdBQVksSUFBWjtBQUtKLGNBQUssTUFBTCxHQUFjLE1BQWQ7QUFDQSxjQUFLLE9BQUwsR0FBZSxPQUFmO0FBSHlFO0FBSTVFOzs7OzhCQUVZLE8sRUFBZTtBQUN4QixpQkFBSyxHQUFMLENBQVMsYUFBYSxPQUF0QjtBQUNIOzs7NkJBRVcsTyxFQUFlO0FBQ3ZCLGlCQUFLLEdBQUwsQ0FBUyxZQUFZLE9BQXJCO0FBQ0g7Ozs2QkFFVyxPLEVBQWU7QUFDdkIsaUJBQUssR0FBTCxDQUFTLFlBQVksT0FBckI7QUFDSDs7OzhCQUVZLE8sRUFBZTtBQUN4QixpQkFBSyxHQUFMLENBQVMsYUFBYSxPQUF0QjtBQUNIOzs7aUNBRWUsTSxFQUFhLGUsRUFBb0I7QUFDN0MsaUJBQUssSUFBTCxDQUFVLGlCQUFWO0FBQ0MsaUJBQWEsZUFBYixHQUErQixlQUEvQjtBQUNELGlCQUFLLFFBQUwsR0FBZ0IsSUFBSSxNQUFKLENBQVcsSUFBWCxDQUFoQjtBQUNBO0FBQ0E7QUFDSDs7O2tDQUVhO0FBQUE7O0FBQ1YsZ0JBQUksQ0FBQyxLQUFLLFVBQVYsRUFBc0I7QUFDbEIscUJBQUssVUFBTCxHQUFrQixZQUFsQjtBQUNIO0FBRUQsZ0JBQUksQ0FBQyxLQUFLLEdBQVYsRUFBZTtBQUNYO0FBQ0EscUJBQUssR0FBTCxHQUFXLFVBQUMsT0FBRDtBQUFBLDJCQUFxQixRQUFRLEdBQVIsQ0FBWSxPQUFaLENBQXJCO0FBQUEsaUJBQVg7QUFDSDtBQUVELGdCQUFJLENBQUMsS0FBSyxNQUFWLEVBQWtCO0FBQ2QscUJBQUssT0FBTCxDQUFhLHdDQUFiO0FBQ0E7QUFDSDtBQUVELGdCQUFJLENBQUMsS0FBSyxVQUFWLEVBQXNCO0FBQ2xCLHFCQUFLLEVBQUwsR0FBVSxJQUFJLFlBQUEsS0FBSixDQUFVLElBQVYsQ0FBVjtBQUNBLHFCQUFLLFVBQUwsR0FBa0IsVUFBQyxLQUFELEVBQVEsS0FBUixFQUFlLE1BQWY7QUFBQSwyQkFBMEIsT0FBSyxFQUFMLENBQVEsVUFBUixDQUFtQixLQUFuQixFQUEwQixLQUExQixFQUFpQyxNQUFqQyxDQUExQjtBQUFBLGlCQUFsQjtBQUNIO0FBRUEsaUJBQWEsR0FBYixHQUFtQjtBQUNoQiwwQkFBVTtBQUNOLDJCQUFPLEdBREQ7QUFFTiw0QkFBUSxHQUZGO0FBR04sZ0NBQVksS0FITjtBQUlOLG1DQUFlLElBSlQ7QUFLTix1Q0FBbUI7QUFMYjtBQURNLGFBQW5CO0FBVUQsaUJBQUssT0FBTCxHQUFlLElBQWY7QUFDSDs7OytDQUUwQjtBQUFBOztBQUN2QixnQkFBTSxTQUFTLFNBQVQsTUFBUyxDQUFDLElBQUQsRUFBbUI7QUFDOUIsb0JBQUksT0FBSyxFQUFMLEtBQVksSUFBaEIsRUFBc0I7QUFDbEIsMkJBQUssRUFBTCxDQUFRLE1BQVI7QUFDQSwyQkFBSyxFQUFMLEdBQVUsSUFBVjtBQUNIO0FBQ0QscUJBQUssT0FBTCxDQUFhLElBQWIsRUFBbUIsV0FBbkIsRUFBZ0MsSUFBaEMsRUFBc0MsSUFBdEM7QUFDQyx1QkFBYSxRQUFiLENBQXNCLElBQXRCO0FBQ0QsdUJBQU8sSUFBSSxPQUFKLENBQWdDLFVBQUMsT0FBRCxFQUFZO0FBQy9DLHdCQUFJLFlBQUEsa0JBQUosQ0FBdUIsTUFBdkIsRUFBNkIsVUFBQyxFQUFELEVBQTJCO0FBQ3BELGdDQUFRLEVBQVI7QUFDSCxxQkFGRDtBQUdILGlCQUpNLENBQVA7QUFLSCxhQVpEO0FBYUEsaUJBQUssRUFBTCxHQUFVLElBQUksWUFBQSxLQUFKLENBQVUsSUFBVixDQUFWO0FBQ0EsaUJBQUssT0FBTCxDQUFhO0FBQ1Qsb0JBQUksS0FBSyxFQURBO0FBRVQsc0JBQU07QUFGRyxhQUFiO0FBSUg7Ozs7RUEzRjBCLGlCQUFBLFU7O0FBQS9CLFFBQUEsU0FBQSxHQUFBLFNBQUE7Ozs7Ozs7O0FDSEE7QUFDQTtBQUNBO0FBQ0E7O0lBQ2EsVTs7OztBQUFiLFFBQUEsVUFBQSxHQUFBLFVBQUE7Ozs7Ozs7Ozs7QUNMQTtBQUNBO0FBQ0E7O0lBRWEsSztBQVFULG1CQUFZLEdBQVosRUFBMEI7QUFBQTs7QUErRjFCO0FBQ0E7QUFDUSxhQUFBLEdBQUE7QUFjUjtBQUNBO0FBQ1EsYUFBQSxXQUFBO0FBaEhKLGFBQUssR0FBTCxHQUFXLEdBQVg7QUFDQSxhQUFLLE1BQUwsR0FBYyxJQUFJLE1BQWxCO0FBRUEsWUFBSTtBQUNBLGdCQUFJLFNBQVMsY0FBVCxDQUF3QixlQUF4QixNQUE2QyxJQUFqRCxFQUF1RDtBQUNuRCxvQkFBTSxRQUFRLFNBQVMsYUFBVCxDQUF1QixPQUF2QixDQUFkO0FBQ0Esc0JBQU0sRUFBTixHQUFXLGVBQVg7QUFDQSxzQkFBTSxTQUFOLEdBQWtCLEtBQUssR0FBdkI7QUFDQSx5QkFBUyxJQUFULENBQWMsV0FBZCxDQUEwQixLQUExQjtBQUNIO0FBRUQsZ0JBQUksS0FBSyxNQUFMLENBQVksYUFBWixDQUEwQixTQUExQixLQUF3QyxrQkFBNUMsRUFBZ0U7QUFDNUQsb0JBQU0sYUFBWSxTQUFTLGFBQVQsQ0FBdUIsS0FBdkIsQ0FBbEI7QUFDQSwyQkFBVSxTQUFWLEdBQXNCLGtCQUF0QjtBQUVBLG9CQUFNLFNBQVMsS0FBSyxNQUFMLENBQVksYUFBM0I7QUFDQSx1QkFBTyxZQUFQLENBQW9CLFVBQXBCLEVBQStCLEtBQUssTUFBcEM7QUFDQSwyQkFBVSxXQUFWLENBQXNCLEtBQUssTUFBM0I7QUFFQSxvQkFBTSxVQUFVLFNBQVMsYUFBVCxDQUF1QixLQUF2QixDQUFoQjtBQUNBLHdCQUFRLFNBQVIsR0FBb0IsZ0JBQXBCO0FBQ0EsMkJBQVUsV0FBVixDQUFzQixPQUF0QjtBQUVBLHdCQUFRLFNBQVIsR0FBb0IsS0FBSyxXQUF6QjtBQUNIO0FBRUQsZ0JBQU0sWUFBWSxLQUFLLE1BQUwsQ0FBWSxhQUE5QjtBQUNBLGlCQUFLLE9BQUwsR0FBZSxLQUFLLFNBQUwsQ0FBZSxTQUFmLEVBQTBCLGdCQUExQixDQUFmO0FBQ0EsaUJBQUssYUFBTCxHQUFxQixLQUFLLFNBQUwsQ0FBZSxLQUFLLE9BQXBCLEVBQTZCLHVCQUE3QixDQUFyQjtBQUVBLGlCQUFLLE1BQUwsR0FBYyxLQUFkO0FBQ0EsaUJBQUssSUFBTDtBQUNILFNBN0JELENBNkJFLE9BQU8sQ0FBUCxFQUFVO0FBQ1IsaUJBQUssVUFBTCxHQUFrQixLQUFLLGtCQUF2QjtBQUNIO0FBQ0o7Ozs7bUNBRWlCLEssRUFBZSxLLEVBQWUsTSxFQUFjO0FBQzFELGdCQUFNLFVBQVUsUUFBUSxHQUFSLEdBQWMsS0FBSyxLQUFMLENBQVcsU0FBUyxHQUFULEdBQWUsS0FBZixHQUF1QixFQUFsQyxJQUF3QyxFQUF0RCxHQUEyRCxHQUEzRTtBQUNBLGlCQUFLLGFBQUwsQ0FBbUIsU0FBbkIsR0FBK0IsT0FBL0I7QUFDQSxpQkFBSyxHQUFMLENBQVMsSUFBVCxDQUFjLE9BQWQ7QUFFQSxnQkFBSSxVQUFVLEtBQWQsRUFBcUI7QUFDakIscUJBQUssSUFBTDtBQUNILGFBRkQsTUFFTztBQUNILHFCQUFLLElBQUw7QUFDSDtBQUNKOzs7aUNBRVk7QUFDVCxpQkFBSyxJQUFMO0FBQ0EsaUJBQUssVUFBTCxHQUFrQixLQUFLLGtCQUF2QjtBQUNIOzs7K0JBRVU7QUFDUCxnQkFBSSxLQUFLLE1BQVQsRUFBaUI7QUFDYjtBQUNIO0FBQ0QsaUJBQUssTUFBTCxHQUFjLElBQWQ7QUFDQSxpQkFBSyxPQUFMLENBQWEsWUFBYixDQUEwQixPQUExQixFQUFtQyxlQUFuQztBQUNIOzs7K0JBRVU7QUFDUCxnQkFBSSxDQUFDLEtBQUssTUFBVixFQUFrQjtBQUNkO0FBQ0g7QUFDRCxpQkFBSyxNQUFMLEdBQWMsS0FBZDtBQUNBLGlCQUFLLE9BQUwsQ0FBYSxZQUFiLENBQTBCLE9BQTFCLEVBQW1DLGdCQUFuQztBQUNIOzs7MkNBRTBCLEssRUFBZSxLLEVBQWUsTSxFQUFjO0FBQ25FLGlCQUFLLEdBQUwsQ0FBUyxJQUFULENBQWMsUUFBUSxHQUFSLEdBQWMsU0FBUyxHQUFULEdBQWUsS0FBN0IsR0FBcUMsR0FBbkQ7QUFDSDs7O2tDQUVpQixNLEVBQWlCLFMsRUFBaUI7QUFDaEQsZ0JBQUksV0FBVyxJQUFmLEVBQXFCO0FBQ2pCLHVCQUFPLElBQVA7QUFDSDtBQUVELGlCQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksT0FBTyxpQkFBM0IsRUFBOEMsRUFBRSxDQUFoRCxFQUFtRDtBQUMvQyxvQkFBSSxRQUFRLE9BQU8sUUFBUCxDQUFnQixDQUFoQixDQUFaO0FBQ0Esb0JBQUksTUFBTSxTQUFOLEtBQW9CLFNBQXhCLEVBQW1DO0FBQy9CLDJCQUFPLEtBQVA7QUFDSDtBQUVELHdCQUFRLEtBQUssU0FBTCxDQUFlLEtBQWYsRUFBc0IsU0FBdEIsQ0FBUjtBQUNBLG9CQUFJLFVBQVUsSUFBZCxFQUFvQjtBQUNoQiwyQkFBTyxLQUFQO0FBQ0g7QUFDSjtBQUVELG1CQUFPLElBQVA7QUFDSDs7Ozs7O0FBckdMLFFBQUEsS0FBQSxHQUFBLEtBQUE7Ozs7Ozs7Ozs7O0lDR2EsRztBQU9ULGlCQUFZLEdBQVosRUFBeUIsT0FBekIsRUFBNEM7QUFBQTs7QUFBQTs7QUFIcEMsYUFBQSxLQUFBLEdBQWdCLENBQWhCO0FBQ0EsYUFBQSxNQUFBLEdBQWlCLENBQWpCO0FBR0osYUFBSyxRQUFMLEdBQWdCLEdBQWhCO0FBQ0EsYUFBSyxPQUFMLEdBQWUsT0FBZjtBQUNBLGFBQUssT0FBTCxDQUFhLE1BQWIsR0FBc0IsUUFBUSxNQUFSLElBQWtCLEtBQXhDO0FBQ0EsYUFBSyxHQUFMLEdBQVcsSUFBSSxjQUFKLEVBQVg7QUFDQSxhQUFLLEdBQUwsQ0FBUyxJQUFULENBQWMsS0FBSyxPQUFMLENBQWEsTUFBM0IsRUFBbUMsR0FBbkMsRUFBd0MsSUFBeEM7QUFDQSxZQUFJLEtBQUssT0FBTCxDQUFhLE1BQWIsS0FBd0IsTUFBNUIsRUFBb0M7QUFDaEMsaUJBQUssR0FBTCxDQUFTLGdCQUFULENBQTBCLGNBQTFCLEVBQTBDLG1DQUExQztBQUNIO0FBQ0QsYUFBSyxHQUFMLENBQVMsZ0JBQVQsQ0FBMEIsb0NBQTFCO0FBRUEsWUFBSSx3QkFBSjtBQUNBLFlBQUksT0FBTyxDQUFDLGtCQUFrQixLQUFLLEdBQXhCLEVBQTZCLGdCQUFwQyxLQUF5RCxVQUE3RCxFQUF5RTtBQUNyRSw0QkFBZ0IsZ0JBQWhCLENBQWlDLFVBQWpDLEVBQTZDLFVBQUMsR0FBRCxFQUFRO0FBQ2pELHNCQUFLLEtBQUwsR0FBYSxJQUFJLEtBQWpCO0FBQ0Esc0JBQUssTUFBTCxHQUFjLElBQUksTUFBbEI7QUFDQSxvQkFBSSxNQUFLLE9BQUwsQ0FBYSxRQUFqQixFQUEyQjtBQUN2QiwyQkFBTyxNQUFLLE9BQUwsQ0FBYSxRQUFiLENBQXNCLElBQUksS0FBMUIsRUFBaUMsSUFBSSxNQUFyQyxDQUFQO0FBQ0g7QUFDSixhQU5EO0FBT0g7QUFFRCxZQUFJLHNCQUFKO0FBQ0EsWUFBSSxPQUFPLENBQUMsZ0JBQWdCLEtBQUssR0FBdEIsRUFBMkIsZ0JBQWxDLEtBQXVELFVBQTNELEVBQXVFO0FBQ25FLDBCQUFjLGdCQUFkLENBQStCLE9BQS9CLEVBQXdDLFVBQUMsR0FBRCxFQUFRO0FBQzVDLG9CQUFJLE1BQUssT0FBTCxDQUFhLElBQWpCLEVBQXVCO0FBQ25CLDBCQUFLLE9BQUwsQ0FBYSxJQUFiLENBQWtCLE1BQUssUUFBdkIsRUFBaUMsTUFBSyxHQUFMLENBQVMsTUFBMUMsRUFBa0Qsb0JBQWxEO0FBQ0EsMkJBQU8sT0FBTyxNQUFLLE9BQUwsQ0FBYSxJQUEzQjtBQUNIO0FBQ0osYUFMRDtBQU1IO0FBQ0QsYUFBSyxHQUFMLENBQVMsa0JBQVQsR0FBOEIsWUFBSztBQUMvQixtQkFBTyxNQUFLLGtCQUFMLEVBQVA7QUFDSCxTQUZEO0FBR0EsWUFBSSxLQUFLLE9BQUwsQ0FBYSxZQUFqQixFQUErQjtBQUMzQixpQkFBSyxHQUFMLENBQVMsWUFBVCxHQUF3QixLQUFLLE9BQUwsQ0FBYSxZQUFyQztBQUNIO0FBQ0QsYUFBSyxHQUFMLENBQVMsSUFBVCxDQUFjLEtBQUssT0FBTCxDQUFhLElBQTNCO0FBQ0g7Ozs7NkNBRXdCO0FBQ3JCLGdCQUFJLEtBQUssR0FBTCxDQUFTLFVBQVQsS0FBd0IsQ0FBNUIsRUFBK0I7QUFDM0Isb0JBQUksS0FBSyxHQUFMLENBQVMsTUFBVCxLQUFvQixHQUF4QixFQUE2QjtBQUN6Qix3QkFBSSxLQUFLLE9BQUwsQ0FBYSxPQUFqQixFQUEwQjtBQUN0Qiw0QkFBTSxRQUFRLEtBQUssR0FBTCxDQUFTLEtBQUssS0FBZCxFQUFxQixLQUFLLE1BQTFCLENBQWQ7QUFDQSw2QkFBSyxPQUFMLENBQWEsUUFBYixDQUFzQixLQUF0QixFQUE2QixLQUE3QjtBQUNBLCtCQUFPLEtBQUssT0FBTCxDQUFhLE9BQWIsQ0FBcUIsS0FBSyxHQUFMLENBQVMsUUFBOUIsQ0FBUDtBQUNIO0FBQ0osaUJBTkQsTUFNTyxJQUFJLEtBQUssT0FBTCxDQUFhLElBQWpCLEVBQXVCO0FBQzFCLHlCQUFLLE9BQUwsQ0FBYSxJQUFiLENBQWtCLEtBQUssUUFBdkIsRUFBaUMsS0FBSyxHQUFMLENBQVMsTUFBMUMsRUFBa0Qsb0JBQWxEO0FBQ0EsMkJBQU8sT0FBTyxLQUFLLE9BQUwsQ0FBYSxJQUEzQjtBQUNIO0FBQ0o7QUFDSjs7OzRDQUUwQixNLEVBQW1CO0FBQzFDLGdCQUFNLFVBQVUsSUFBSSxXQUFKLENBQWdCLE1BQWhCLENBQWhCO0FBQ0EsZ0JBQU0sU0FBUyxRQUFRLE1BQXZCO0FBQ0EsZ0JBQUksU0FBUyxFQUFiO0FBQ0EsZ0JBQUksY0FBYyxLQUFLLEdBQUwsQ0FBUyxDQUFULEVBQVksRUFBWixJQUFrQixDQUFwQztBQUNBLGdCQUFJLElBQUksQ0FBUjtBQUNBLG1CQUFPLElBQUksTUFBWCxFQUFtQjtBQUNmLG9CQUFJLElBQUksV0FBSixHQUFrQixNQUF0QixFQUE4QjtBQUMxQixrQ0FBYyxTQUFTLENBQXZCO0FBQ0g7QUFDRCwwQkFBVSxPQUFPLFlBQVAsQ0FBb0IsS0FBcEIsQ0FBMEIsSUFBMUIsRUFBZ0MsUUFBUSxRQUFSLENBQWlCLENBQWpCLEVBQW9CLElBQUksV0FBeEIsQ0FBaEMsQ0FBVjtBQUNBLHFCQUFLLFdBQUw7QUFDSDtBQUNELG1CQUFPLE1BQVA7QUFDSDs7Ozs7O0FBNUVMLFFBQUEsR0FBQSxHQUFBLEdBQUE7Ozs7OztBQ05BLElBQUEsZ0JBQUEsUUFBQSxlQUFBLENBQUE7QUFDQSxJQUFBLGtCQUFBLFFBQUEsaUJBQUEsQ0FBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBZ0IsR0FBaEIsQ0FBb0IsTUFBcEIsRUFBK0MsT0FBL0MsRUFBa0U7QUFDOUQsUUFBTSxVQUFVLElBQUksT0FBSixDQUF3QixVQUFDLE9BQUQsRUFBVSxNQUFWLEVBQW9CO0FBQ3hELFlBQU0sU0FBUyxJQUFJLGdCQUFBLFNBQUosQ0FBYyxNQUFkLEVBQXNCLE9BQXRCLENBQWY7QUFDQSxlQUFPLE1BQVAsQ0FBYyxNQUFkLEVBQXNCLE9BQXRCO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQU0sVUFBVSxPQUFPLE9BQXZCO0FBQ0EsZUFBTyxPQUFQLEdBQWlCLFVBQUMsT0FBRCxFQUFvQjtBQUNqQyxtQkFBTyxPQUFQO0FBRUEsZ0JBQU0sS0FBSyxTQUFMLEVBQUssR0FBSztBQUNaLG9CQUFJLE9BQUosRUFBYTtBQUNULDRCQUFRLE9BQVI7QUFDQSwyQkFBTyxPQUFQLEdBQWlCLE9BQWpCO0FBQ0gsaUJBSEQsTUFHTztBQUNILDJCQUFPLE9BQVAsR0FBaUIsT0FBTyxLQUF4QjtBQUNIO0FBQ0osYUFQRDtBQVNBLHVCQUFXLEVBQVgsRUFBZSxDQUFmO0FBQ0gsU0FiRDtBQWVBLGVBQU8sT0FBUDtBQUNBLFlBQUksQ0FBQyxPQUFPLE9BQVosRUFBcUI7QUFDakI7QUFDSDtBQUVEO0FBQ0Esc0JBQUEsSUFBQSxDQUFLLGFBQUwsQ0FBbUIsT0FBTyxVQUExQixFQUFzQyxNQUF0QztBQUNILEtBaENlLENBQWhCO0FBa0NBLFFBQU0sa0JBQW1CLE9BQXpCO0FBQ0Esb0JBQWdCLEtBQWhCLEdBQXdCLFVBQUMsT0FBRCxFQUFZO0FBQ2hDLHdCQUFnQixJQUFoQixDQUFxQixVQUFDLE9BQUQsRUFBd0I7QUFDekMsb0JBQVEsUUFBUSxFQUFoQixFQUFvQixRQUFRLElBQTVCO0FBQ0gsU0FGRDtBQUdILEtBSkQ7QUFLQSxXQUFPLGVBQVA7QUFDSDtBQTFDRCxRQUFBLEdBQUEsR0FBQSxHQUFBO0FBb0VDLE9BQWUsR0FBZixHQUFxQixHQUFyQjs7OztBQ2xGRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDMWVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDMWtCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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QUFJLFNBQVMsY0FBVCxDQUF3QixRQUF4QixDQUFKLEVBQTREO0FBQ3BFLG9CQUFZO0FBRHdELEtBQTVELENBQVo7QUFJQSxTQUFBLE9BQUEsQ0FBUSxHQUFSLEVBQWEsVUFBQyxFQUFELEVBQUssSUFBTCxFQUFhO0FBQ3RCLGFBQUEsTUFBQSxDQUFPLEdBQUcsT0FBSCxDQUFXLFlBQVgsQ0FBUCxFQUFpQyxZQUFLO0FBQ2xDLGlCQUFBLE1BQUEsQ0FBTyxLQUFLLENBQUMsWUFBRCxDQUFMLENBQVAsRUFBNkIsVUFBQyxFQUFELEVBQU87QUFDaEMsb0JBQU0sS0FBSyxTQUFMLEVBQUssR0FBSztBQUNaO0FBQ0EsOEJBQVUsRUFBVjtBQUNILGlCQUhEO0FBS0EsMkJBQVcsRUFBWCxFQUFlLElBQWY7QUFDSCxhQVBEO0FBUUgsU0FURDtBQVVILEtBWEQ7QUFZSCxDQWpCRDtBQW1CQSxJQUFNLFlBQVksU0FBWixTQUFZLENBQUMsRUFBRCxFQUEyQjtBQUN6QyxPQUFHLFVBQUgsR0FBZ0IsSUFBaEIsQ0FBcUIsVUFBQyxJQUFELEVBQVM7QUFDMUIsWUFBTSxJQUFJLE9BQU8sSUFBUCxDQUFZLGFBQVosRUFBMkIsbUJBQTNCLENBQVY7QUFDQSxVQUFFLFFBQUYsQ0FBVyxLQUFYLENBQWlCLGVBQWUsSUFBZixHQUFzQix1QkFBdkM7QUFDSCxLQUhEO0FBSUgsQ0FMRCIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIi8vIEF1dG9nZW5lcmF0ZWRcbi8vIC0tLS0tLS0tLS0tLS1cbi8vIGd1bHBmaWxlLmpzIC0tPiBnZW5lcmF0ZUJ1aWxkSW5mb1xuXG5leHBvcnQgY29uc3QgQnVpbGQgPSB7XG4gICAgdmVyc2lvbjogXCI2LjIyLWNjMjliYTM0NjQwMGJkYjI5ZjQ1OWQ4ZDUwMjA1NmQxNDE1ZTljZTRcIixcbiAgICB3YXNtU2l6ZTogMjE2NzU0MCxcbiAgICBqc1NpemU6ICA1MDM1MzYsXG59O1xuIiwiaW1wb3J0IHsgRG9zIH0gZnJvbSBcIi4vanMtZG9zXCI7XG5pbXBvcnQgeyBEb3NNb2R1bGUgfSBmcm9tIFwiLi9qcy1kb3MtbW9kdWxlXCI7XG5pbXBvcnQgeyBYaHIgfSBmcm9tIFwiLi9qcy1kb3MteGhyXCI7XG5cbmludGVyZmFjZSBMb3dMZXZlbEFwaSB7XG4gICAgc2VuZDogKGV2ZW50OiBzdHJpbmcsIG1zZz86IGFueSwgY2FsbGJhY2s/OiAobXNnOiBzdHJpbmcpID0+IHZvaWQpID0+IHZvaWQ7XG4gICAgcGluZzogKG1zZzogc3RyaW5nKSA9PiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgRG9zQ29tbWFuZEludGVmYWNlIHtcbiAgICBwdWJsaWMgZG9zOiBEb3NNb2R1bGU7XG4gICAgcHJpdmF0ZSBlbTogdHlwZW9mIE1vZHVsZTtcbiAgICBwcml2YXRlIGFwaTogTG93TGV2ZWxBcGk7XG4gICAgcHJpdmF0ZSBvbnJlYWR5OiAoY2k6IERvc0NvbW1hbmRJbnRlZmFjZSkgPT4gdm9pZDtcblxuICAgIHByaXZhdGUgc2hlbGxJbnB1dFF1ZXVlOiBzdHJpbmdbXSA9IFtdO1xuICAgIHByaXZhdGUgc2hlbGxJbnB1dENsaWVudHM6IEFycmF5PCgpID0+IHZvaWQ+ID0gW107XG5cbiAgICBjb25zdHJ1Y3Rvcihkb3M6IERvc01vZHVsZSwgb25yZWFkeTogKGNpOiBEb3NDb21tYW5kSW50ZWZhY2UpID0+IHZvaWQpIHtcbiAgICAgICAgdGhpcy5kb3MgPSBkb3M7XG4gICAgICAgIHRoaXMuZW0gPSAoZG9zIGFzIGFueSk7XG4gICAgICAgIHRoaXMuYXBpID0gKGRvcyBhcyBhbnkpO1xuICAgICAgICB0aGlzLmFwaS5waW5nID0gKG1zZzogc3RyaW5nLCAuLi5hcmdzOiBhbnlbXSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5vbnBpbmcobXNnLCBhcmdzKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5vbnJlYWR5ID0gb25yZWFkeTtcbiAgICB9XG5cbiAgICBwdWJsaWMgd2lkdGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvcy5jYW52YXMud2lkdGg7XG4gICAgfVxuXG4gICAgcHVibGljIGhlaWdodCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG9zLmNhbnZhcy5oZWlnaHQ7XG4gICAgfVxuXG4gICAgcHVibGljIHNoZWxsKC4uLmNtZDogc3RyaW5nW10pIHtcbiAgICAgICAgaWYgKGNtZC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNoZWxsSW5wdXRDbGllbnRzLnB1c2gocmVzb2x2ZSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG5leHQgb2YgY21kKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zaGVsbElucHV0UXVldWUucHVzaChuZXh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucmVxdWVzdFNoZWxsSW5wdXQoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHVibGljIHNjcmVlbnNob3QoKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5hcGkuc2VuZChcInNjcmVlbnNob3RcIiwgXCJcIiwgKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHB1YmxpYyBleGl0KCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5hcGkuc2VuZChcImV4aXRcIik7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5kb3MuZXJyb3IoXCJSdW50aW1lIGlzIHN0aWxsIGFsaXZlIVwiKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cblxuICAgIHByaXZhdGUgc2VuZEtleVByZXNzKGNvZGU6IG51bWJlcikge1xuICAgICAgICB0aGlzLmFwaS5zZW5kKFwic2RsX2tleV9ldmVudFwiLCBjb2RlICsgXCJcIik7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZXF1ZXN0U2hlbGxJbnB1dCgpIHtcbiAgICAgICAgdGhpcy5zZW5kS2V5UHJlc3MoMTMpO1xuICAgIH1cblxuICAgIHByaXZhdGUgb25waW5nKG1zZzogc3RyaW5nLCBhcmdzOiBhbnlbXSkge1xuICAgICAgICBzd2l0Y2ggKG1zZykge1xuICAgICAgICAgICAgY2FzZSBcInJlYWR5XCI6XG4gICAgICAgICAgICAgICAgdGhpcy5vbnJlYWR5KHRoaXMpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInNoZWxsX2lucHV0XCI6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2hlbGxJbnB1dFF1ZXVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29uc3QgYnVmZmVyOiBudW1iZXIgPSBhcmdzWzBdO1xuICAgICAgICAgICAgICAgIGNvbnN0IG1heExlbmd0aDogbnVtYmVyID0gYXJnc1sxXTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGNtZCA9IHRoaXMuc2hlbGxJbnB1dFF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgY29uc3QgY21kTGVuZ3RoID0gKHRoaXMuZW0gYXMgYW55KS5sZW5ndGhCeXRlc1VURjgoY21kKSArIDE7XG5cbiAgICAgICAgICAgICAgICBpZiAoY21kTGVuZ3RoID4gbWF4TGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZG9zLm9uZXJyb3IoXCJDYW4ndCBleGVjdXRlIGNtZCAnXCIgKyBjbWQgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCInLCBiZWNhdXNlIGl0J3MgYmlnZ2VyIHRoZW4gbWF4IGNtZCBsZW5ndGggXCIgKyBtYXhMZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgKHRoaXMuZW0gYXMgYW55KS5zdHJpbmdUb1VURjgoY21kLCBidWZmZXIsIGNtZExlbmd0aCk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zaGVsbElucHV0UXVldWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgcmVzb2x2ZSBvZiB0aGlzLnNoZWxsSW5wdXRDbGllbnRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaGVsbElucHV0Q2xpZW50cyA9IFtdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVxdWVzdFNoZWxsSW5wdXQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgLy8gZG8gbm90aGluZ1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgRG9zIH0gZnJvbSBcIi4vanMtZG9zXCI7XG5pbXBvcnQgeyBEb3NNb2R1bGUgfSBmcm9tIFwiLi9qcy1kb3MtbW9kdWxlXCI7XG5pbXBvcnQgeyBYaHIgfSBmcm9tIFwiLi9qcy1kb3MteGhyXCI7XG5cbi8vIEZTXG4vLyA9PVxuLy8gQXBpIGZvciB3b3JraW5nIHdpdGggaW5tZW1vcnkgZmlsZSBzeXN0ZW0gdGhhdCB1c2VkIGJ5IGVtdWxhdGlvbiBsYXllclxuXG5leHBvcnQgY2xhc3MgRG9zRlMge1xuICAgIHByaXZhdGUgZG9zOiBEb3NNb2R1bGU7XG4gICAgcHJpdmF0ZSBlbTogdHlwZW9mIE1vZHVsZTtcblxuICAgIGNvbnN0cnVjdG9yKGRvczogRG9zTW9kdWxlKSB7XG4gICAgICAgIHRoaXMuZG9zID0gZG9zO1xuICAgICAgICB0aGlzLmVtID0gZG9zIGFzIGFueTtcbiAgICB9XG5cbiAgICAvLyAqKmV4dHJhY3QqKiAtIGRvd25sb2FkcyB1cmwgYW5kIGV4dHJhY3QgaXQgaW4gY3dkIChjd2Qgd2lsbCBiZSBtb3VudGVkIGFzIEM6KSxcbiAgICAvLyBzdXBwb3J0ZWQgb25seSB6aXAgYXJjaGl2ZVxuICAgIHB1YmxpYyBleHRyYWN0KHVybDogc3RyaW5nLCB0eXBlOiBzdHJpbmcgPSBcInppcFwiKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZTx2b2lkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICBpZiAodHlwZSAhPT0gXCJ6aXBcIikge1xuICAgICAgICAgICAgICAgIHJlamVjdChcIk9ubHkgWklQIGFyY2hpdmUgaXMgc3VwcG9ydGVkXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbmV3IFhocih1cmwsIHtcbiAgICAgICAgICAgICAgICByZXNwb25zZVR5cGU6IFwiYXJyYXlidWZmZXJcIixcbiAgICAgICAgICAgICAgICBmYWlsOiAobXNnKSA9PiByZWplY3QobXNnKSxcbiAgICAgICAgICAgICAgICBwcm9ncmVzczogKHRvdGFsLCBsb2FkZWQpID0+IHRoaXMuZG9zLm9ucHJvZ3Jlc3MoXCJEb3dubG9hZGluZyBcIiArIHVybCwgdG90YWwsIGxvYWRlZCksXG4gICAgICAgICAgICAgICAgc3VjY2VzczogKGRhdGE6IEFycmF5QnVmZmVyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJ1ZmZlciA9IHRoaXMuZW0uX21hbGxvYyhieXRlcy5sZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVtLkhFQVBVOC5zZXQoYnl0ZXMsIGJ1ZmZlcik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJldGNvZGUgPSAodGhpcy5lbSBhcyBhbnkpLl9leHRyYWN0X3ppcChidWZmZXIsIGJ5dGVzLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW0uX2ZyZWUoYnVmZmVyKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAocmV0Y29kZSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiQ2FuJ3QgZXh0cmFjdCB6aXAsIHJldGNvZGUgXCIgKyByZXRjb2RlICsgXCIsIHNlZSBtb3JlIGluZm8gaW4gbG9nc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQnVpbGQgfSBmcm9tIFwiLi9qcy1kb3MtYnVpbGRcIjtcbmltcG9ydCB7IERvc01vZHVsZSB9IGZyb20gXCIuL2pzLWRvcy1tb2R1bGVcIjtcbmltcG9ydCB7IFhociB9IGZyb20gXCIuL2pzLWRvcy14aHJcIjtcblxuY2xhc3MgRG9zSG9zdCB7XG5cbiAgICBwdWJsaWMgd2FzbVN1cHBvcnRlZCA9IGZhbHNlO1xuICAgIHB1YmxpYyBnbG9iYWwgPSB3aW5kb3cgYXMgYW55O1xuXG4gICAgcHJpdmF0ZSB3ZG9zYm94UHJvbWlzZTogUHJvbWlzZTxhbnk+ID0gbnVsbDtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmdsb2JhbC5leHBvcnRzID0ge307XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgV2ViQXNzZW1ibHkgPT09IFwib2JqZWN0XCIgJiZcbiAgICAgICAgICAgICAgICB0eXBlb2YgV2ViQXNzZW1ibHkuaW5zdGFudGlhdGUgPT09IFwiZnVuY3Rpb25cIiAmJlxuICAgICAgICAgICAgICAgIHR5cGVvZiBXZWJBc3NlbWJseS5jb21waWxlID09PSBcImZ1bmN0aW9uXCIpIHtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHdtb2R1bGUgPSBuZXcgV2ViQXNzZW1ibHkuTW9kdWxlKFVpbnQ4QXJyYXkub2YoMHgwLCAweDYxLCAweDczLCAweDZkLCAweDAxLCAweDAwLCAweDAwLCAweDAwKSk7XG4gICAgICAgICAgICAgICAgaWYgKHdtb2R1bGUgaW5zdGFuY2VvZiBXZWJBc3NlbWJseS5Nb2R1bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy53YXNtU3VwcG9ydGVkID0gbmV3IFdlYkFzc2VtYmx5Lkluc3RhbmNlKHdtb2R1bGUpIGluc3RhbmNlb2YgV2ViQXNzZW1ibHkuSW5zdGFuY2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gZG8gbm90aGluZyBXZWJBc3NlbWJseSBpcyBub3Qgc3VwcG9ydGVkXG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnBvbHlmaWxsKCk7XG4gICAgfVxuXG4gICAgcHVibGljIHJlc29sdmVEb3NCb3godXJsOiBzdHJpbmcsIG1vZHVsZTogRG9zTW9kdWxlKSB7XG4gICAgICAgIGlmICh0aGlzLmdsb2JhbC5leHBvcnRzLldET1NCT1gpIHtcbiAgICAgICAgICAgIG1vZHVsZS5vbmRvc2JveCh0aGlzLmdsb2JhbC5leHBvcnRzLldET1NCT1gsIHRoaXMuZ2xvYmFsLmV4cG9ydHMuaW5zdGFudGlhdGVXYXNtKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGhpcy53YXNtU3VwcG9ydGVkKSB7XG4gICAgICAgICAgICBtb2R1bGUub25lcnJvcihcIldlYkFzc2VtYmx5IGlzIG5vdCBzdXBwb3J0ZWQsIGNhbid0IHJlc29sdmUgd2Rvc2JveFwiKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLndkb3Nib3hQcm9taXNlID09PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLndkb3Nib3hQcm9taXNlID0gdGhpcy5jb21waWxlRG9zQm94KHVybCwgbW9kdWxlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMud2Rvc2JveFByb21pc2UudGhlbigoaW5zdGFuY2U6IGFueSkgPT4ge1xuICAgICAgICAgICAgLy8gbGVhdmUgcHJvbWlzZSBzY29wZVxuICAgICAgICAgICAgY29uc3QgZm4gPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy53ZG9zYm94UHJvbWlzZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgbW9kdWxlLm9uZG9zYm94KHRoaXMuZ2xvYmFsLmV4cG9ydHMuV0RPU0JPWCwgdGhpcy5nbG9iYWwuZXhwb3J0cy5pbnN0YW50aWF0ZVdhc20pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZm4sIDEpO1xuICAgICAgICB9LCAobWVzc2FnZTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAvLyBsZWF2ZSBwcm9taXNlIHNjb3BlXG4gICAgICAgICAgICBjb25zdCBmbiA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLndkb3Nib3hQcm9taXNlID0gbnVsbDtcbiAgICAgICAgICAgICAgICBtb2R1bGUub25lcnJvcihtZXNzYWdlKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZuLCAxKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjb21waWxlRG9zQm94KHVybDogc3RyaW5nLCBtb2R1bGU6IERvc01vZHVsZSkge1xuICAgICAgICBjb25zdCBidWlsZFRvdGFsID0gQnVpbGQud2FzbVNpemUgKyBCdWlsZC5qc1NpemU7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCB3YXNtVXJsID0gdXJsLnJlcGxhY2UoXCIuanNcIiwgXCIud2FzbS5qc1wiKTtcblxuICAgICAgICAgICAgbmV3IFhocih3YXNtVXJsLCB7XG4gICAgICAgICAgICAgICAgcmVzcG9uc2VUeXBlOiBcImFycmF5YnVmZmVyXCIsXG4gICAgICAgICAgICAgICAgcHJvZ3Jlc3M6ICh0b3RhbCwgbG9hZGVkKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtb2R1bGUub25wcm9ncmVzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlLm9ucHJvZ3Jlc3MoXCJSZXNvbHZpbmcgRG9zQm94XCIsIGJ1aWxkVG90YWwsIGxvYWRlZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGZhaWw6ICh1cmw6IHN0cmluZywgc3RhdHVzOiBudW1iZXIsIG1lc3NhZ2U6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJDYW4ndCBkb3dubG9hZCB3YXNtLCBjb2RlOiBcIiArIHN0YXR1cyArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIiwgbWVzc2FnZTogXCIgKyBtZXNzYWdlICsgXCIsIHVybDogXCIgKyB1cmwpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc3VjY2VzczogKHJlc3BvbnNlOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJvbWlzZSA9IFdlYkFzc2VtYmx5LmNvbXBpbGUocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBvbnJlamVjdCA9IChyZWFzb246IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHJlYXNvbiArIFwiXCIpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBwcm9taXNlLmNhdGNoKG9ucmVqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgcHJvbWlzZS50aGVuKCh3YXNtTW9kdWxlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdsb2JhbC5leHBvcnRzLmluc3RhbnRpYXRlV2FzbSA9IChpbmZvOiBhbnksIHJlY2VpdmVJbnN0YW5jZTogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFdlYkFzc2VtYmx5Lmluc3RhbnRpYXRlKHdhc21Nb2R1bGUsIGluZm8pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChvbnJlamVjdClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKGluc3RhbmNlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNlaXZlSW5zdGFuY2UoaW5zdGFuY2UsIHdhc21Nb2R1bGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBYaHIodXJsLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3M6ICh0b3RhbCwgbG9hZGVkKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtb2R1bGUub25wcm9ncmVzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlLm9ucHJvZ3Jlc3MoXCJSZXNvbHZpbmcgRG9zQm94XCIsIGJ1aWxkVG90YWwsIEJ1aWxkLndhc21TaXplICsgbG9hZGVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFpbDogKHVybDogc3RyaW5nLCBzdGF0dXM6IG51bWJlciwgbWVzc2FnZTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIkNhbid0IGRvd25sb2FkIHdkb3Nib3guanMsIGNvZGU6IFwiICsgc3RhdHVzICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiLCBtZXNzYWdlOiBcIiArIG1lc3NhZ2UgKyBcIiwgdXJsOiBcIiArIHVybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiAocmVzcG9uc2U6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGUub25wcm9ncmVzcyhcIlJlc29sdmluZyBEb3NCb3hcIiwgYnVpbGRUb3RhbCwgYnVpbGRUb3RhbCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogdHNsaW50OmRpc2FibGU6bm8tZXZhbCAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmFsLmNhbGwod2luZG93LCByZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUodGhpcy5nbG9iYWwuZXhwb3J0cy5XRE9TQk9YKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyogdHNsaW50OmRpc2FibGU6bm8tYml0d2lzZSAqL1xuICAgIC8qIHRzbGludDpkaXNhYmxlOm9ubHktYXJyb3ctZnVuY3Rpb25zICovXG4gICAgcHJpdmF0ZSBwb2x5ZmlsbCgpIHtcbiAgICAgICAgaWYgKCFNYXRoLmltdWwgfHwgTWF0aC5pbXVsKDB4ZmZmZmZmZmYsIDUpICE9PSAtNSkge1xuICAgICAgICAgICAgTWF0aC5pbXVsID0gZnVuY3Rpb24gaW11bChhOiBhbnksIGI6IGFueSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGFoID0gYSA+Pj4gMTY7XG4gICAgICAgICAgICAgICAgY29uc3QgYWwgPSBhICYgMHhmZmZmO1xuICAgICAgICAgICAgICAgIGNvbnN0IGJoID0gYiA+Pj4gMTY7XG4gICAgICAgICAgICAgICAgY29uc3QgYmwgPSBiICYgMHhmZmZmO1xuICAgICAgICAgICAgICAgIHJldHVybiAoYWwgKiBibCArICgoYWggKiBibCArIGFsICogYmgpIDw8IDE2KSkgfCAwO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBNYXRoLmltdWwgPSBNYXRoLmltdWw7XG5cbiAgICAgICAgaWYgKCFNYXRoLmZyb3VuZCkge1xuICAgICAgICAgICAgTWF0aC5mcm91bmQgPSBmdW5jdGlvbih4KSB7IHJldHVybiB4OyB9O1xuICAgICAgICB9XG4gICAgICAgIE1hdGguZnJvdW5kID0gTWF0aC5mcm91bmQ7XG5cbiAgICAgICAgaWYgKCFNYXRoLmNsejMyKSB7XG4gICAgICAgICAgICBNYXRoLmNsejMyID0gZnVuY3Rpb24oeCkge1xuICAgICAgICAgICAgICAgIHggPSB4ID4+PiAwO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMzI7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoeCAmICgxIDw8ICgzMSAtIGkpKSkgeyByZXR1cm4gaTsgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gMzI7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIE1hdGguY2x6MzIgPSBNYXRoLmNsejMyO1xuXG4gICAgICAgIGlmICghTWF0aC50cnVuYykge1xuICAgICAgICAgICAgTWF0aC50cnVuYyA9IGZ1bmN0aW9uKHgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geCA8IDAgPyBNYXRoLmNlaWwoeCkgOiBNYXRoLmZsb29yKHgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBNYXRoLnRydW5jID0gTWF0aC50cnVuYztcbiAgICB9XG59XG5cbmV4cG9ydCBjb25zdCBIb3N0ID0gbmV3IERvc0hvc3QoKTtcbiIsImltcG9ydCB7IERvc1J1bnRpbWUgfSBmcm9tIFwiLi9qcy1kb3NcIjtcbmltcG9ydCB7IERvc0NvbW1hbmRJbnRlZmFjZSB9IGZyb20gXCIuL2pzLWRvcy1jaVwiO1xuaW1wb3J0IHsgRG9zRlMgfSBmcm9tIFwiLi9qcy1kb3MtZnNcIjtcbmltcG9ydCB7IERvc09wdGlvbnMgfSBmcm9tIFwiLi9qcy1kb3Mtb3B0aW9uc1wiO1xuaW1wb3J0IHsgRG9zVWkgfSBmcm9tIFwiLi9qcy1kb3MtdWlcIjtcblxuZXhwb3J0IGNsYXNzIERvc01vZHVsZSBleHRlbmRzIERvc09wdGlvbnMge1xuICAgIHB1YmxpYyBpc1ZhbGlkOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHVibGljIGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQgPSBudWxsO1xuICAgIHByaXZhdGUgY2k6IFByb21pc2U8RG9zQ29tbWFuZEludGVmYWNlPiA9IG51bGw7XG4gICAgcHJpdmF0ZSBpbnN0YW5jZTogYW55O1xuICAgIHByaXZhdGUgZnM6IERvc0ZTID0gbnVsbDtcbiAgICBwcml2YXRlIHVpOiBEb3NVaSA9IG51bGw7XG4gICAgcHJpdmF0ZSBvbnJlYWR5OiAocnVudGltZTogRG9zUnVudGltZSkgPT4gdm9pZDtcblxuICAgIGNvbnN0cnVjdG9yKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQsIG9ucmVhZHk6IChydW50aW1lOiBEb3NSdW50aW1lKSA9PiB2b2lkKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuY2FudmFzID0gY2FudmFzO1xuICAgICAgICB0aGlzLm9ucmVhZHkgPSBvbnJlYWR5O1xuICAgIH1cblxuICAgIHB1YmxpYyBkZWJ1ZyhtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5sb2coXCJbREVCVUddIFwiICsgbWVzc2FnZSk7XG4gICAgfVxuXG4gICAgcHVibGljIGluZm8obWVzc2FnZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMubG9nKFwiW0lORk9dIFwiICsgbWVzc2FnZSk7XG4gICAgfVxuXG4gICAgcHVibGljIHdhcm4obWVzc2FnZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMubG9nKFwiW1dBUk5dIFwiICsgbWVzc2FnZSk7XG4gICAgfVxuXG4gICAgcHVibGljIGVycm9yKG1lc3NhZ2U6IHN0cmluZykge1xuICAgICAgICB0aGlzLmxvZyhcIltFUlJPUl0gXCIgKyBtZXNzYWdlKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgb25kb3Nib3goZG9zYm94OiBhbnksIGluc3RhbnRpYXRlV2FzbTogYW55KSB7XG4gICAgICAgIHRoaXMuaW5mbyhcIkRvc0JveCByZXNvbHZlZFwiKTtcbiAgICAgICAgKHRoaXMgYXMgYW55KS5pbnN0YW50aWF0ZVdhc20gPSBpbnN0YW50aWF0ZVdhc207XG4gICAgICAgIHRoaXMuaW5zdGFuY2UgPSBuZXcgZG9zYm94KHRoaXMpO1xuICAgICAgICAvLyBlbXNjcmlwdGVuIHdpbGwgY2FsbCB0aGlzLm9uUnVudGltZUluaXRpYWxpemVkXG4gICAgICAgIC8vIHdoZW4gcnVudGltZSB3aWxsIHJlYWR5XG4gICAgfVxuXG4gICAgcHVibGljIHJlc29sdmUoKSB7XG4gICAgICAgIGlmICghdGhpcy53ZG9zYm94VXJsKSB7XG4gICAgICAgICAgICB0aGlzLndkb3Nib3hVcmwgPSBcIndkb3Nib3guanNcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGhpcy5sb2cpIHtcbiAgICAgICAgICAgIC8qIHRzbGludDpkaXNhYmxlOm5vLWNvbnNvbGUgKi9cbiAgICAgICAgICAgIHRoaXMubG9nID0gKG1lc3NhZ2U6IHN0cmluZykgPT4gY29uc29sZS5sb2cobWVzc2FnZSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRoaXMuY2FudmFzKSB7XG4gICAgICAgICAgICB0aGlzLm9uZXJyb3IoXCJjYW52YXMgZmllbGQgaXMgcmVxdWlyZWQsIGJ1dCBub3Qgc2V0IVwiKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGhpcy5vbnByb2dyZXNzKSB7XG4gICAgICAgICAgICB0aGlzLnVpID0gbmV3IERvc1VpKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5vbnByb2dyZXNzID0gKHN0YWdlLCB0b3RhbCwgbG9hZGVkKSA9PiB0aGlzLnVpLm9ucHJvZ3Jlc3Moc3RhZ2UsIHRvdGFsLCBsb2FkZWQpO1xuICAgICAgICB9XG5cbiAgICAgICAgKHRoaXMgYXMgYW55KS5TREwgPSB7XG4gICAgICAgICAgICBkZWZhdWx0czoge1xuICAgICAgICAgICAgICAgIHdpZGh0OiAzMjAsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAyMDAsXG4gICAgICAgICAgICAgICAgY29weU9uTG9jazogZmFsc2UsXG4gICAgICAgICAgICAgICAgZGlzY2FyZE9uTG9jazogdHJ1ZSxcbiAgICAgICAgICAgICAgICBvcGFxdWVGcm9udEJ1ZmZlcjogZmFsc2UsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuaXNWYWxpZCA9IHRydWU7XG4gICAgfVxuXG4gICAgcHVibGljIG9uUnVudGltZUluaXRpYWxpemVkKCkge1xuICAgICAgICBjb25zdCBtYWluRm4gPSAoYXJnczogc3RyaW5nW10pID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLnVpICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy51aS5kZXRhY2goKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVpID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFyZ3MudW5zaGlmdChcIi1jXCIsIFwibW91bnQgYyAuXCIsIFwiLWNcIiwgXCJjOlwiKTtcbiAgICAgICAgICAgICh0aGlzIGFzIGFueSkuY2FsbE1haW4oYXJncyk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8RG9zQ29tbWFuZEludGVmYWNlPigocmVzb2x2ZSkgPT4ge1xuICAgICAgICAgICAgICAgIG5ldyBEb3NDb21tYW5kSW50ZWZhY2UodGhpcywgKGNpOiBEb3NDb21tYW5kSW50ZWZhY2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShjaSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5mcyA9IG5ldyBEb3NGUyh0aGlzKTtcbiAgICAgICAgdGhpcy5vbnJlYWR5KHtcbiAgICAgICAgICAgIGZzOiB0aGlzLmZzLFxuICAgICAgICAgICAgbWFpbjogbWFpbkZuLFxuICAgICAgICB9KTtcbiAgICB9XG5cbn1cbiIsImltcG9ydCB7IERvc0NvbW1hbmRJbnRlZmFjZSB9IGZyb20gXCIuL2pzLWRvcy1jaVwiO1xuaW1wb3J0IHsgRG9zRlMgfSBmcm9tIFwiLi9qcy1kb3MtZnNcIjtcblxuLy8gRG9zT3B0aW9uc1xuLy8gLS0tLS0tLS0tLVxuLy8gSXMgYSBvcHRpb25zIG9iamVjdCB0aGF0IHlvdSBwYXNzIHRvIGNvbnN0cnVjdG9yIG9mIFtEb3NdKGpzLWRvcy5odG1sKVxuLy8gY2xhc3MsIHRvIGNvbmZpZ3VyZSBlbXVsYXRpb24gbGF5ZXI6XG5leHBvcnQgY2xhc3MgRG9zT3B0aW9ucyB7XG5cbiAgICAvLyBvbnByb2dyZXNzXG4gICAgLy8gLS0tLS0tLS0tLVxuICAgIC8vIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIHdoaWxlIGpzLWRvcyBpcyBsb2FkaW5nXG4gICAgcHVibGljIG9ucHJvZ3Jlc3M/OiAoc3RhZ2U6IHN0cmluZywgdG90YWw6IG51bWJlciwgbG9hZGVkOiBudW1iZXIpID0+IHZvaWQ7XG5cbiAgICAvLyBvbmVycm9yXG4gICAgLy8gLS0tLS0tLVxuICAgIC8vIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIHdoZW4gZXJyb3IgaGFwcGVuc1xuICAgIHB1YmxpYyBvbmVycm9yPzogKG1lc3NhZ2U6IHN0cmluZykgPT4gdm9pZDtcblxuICAgIC8vIGxvZ1xuICAgIC8vIC0tLVxuICAgIC8vICB5b3UgY2FuIHByb3ZpZGUgbG9nIGZ1bmN0aW9uLCB0byBvdmVycmlkZSBsb2dnaW5nLCBieSBkZWZhdWx0IGpzLWRvcyB1c2VzIGNvbnNvbGUubG9nIGFzIGltcGxlbWVudGF0aW9uXG4gICAgcHVibGljIGxvZz86IChtZXNzYWdlOiBzdHJpbmcpID0+IHZvaWQ7XG5cbiAgICAvLyB3ZG9zYm94VXJsXG4gICAgLy8gLS0tLS0tLS0tLVxuICAgIC8vIHlvdSBjYW4gc2V0IGFsdGVybmF0aXZlIHVybCBmb3IgZG93bmxvYWRpbmcganMtZG9zIHNjcmlwdCwgZGVmYXVsdCBpcyAnd2Rvc2JveC5qcydcbiAgICBwdWJsaWMgd2Rvc2JveFVybD86IHN0cmluZztcblxufVxuIiwiaW1wb3J0IHsgRG9zTW9kdWxlIH0gZnJvbSBcIi4vanMtZG9zLW1vZHVsZVwiO1xuXG4vLyBKc0Rvc1VpXG4vLyA9PT09PT09XG4vLyBPcHRpb25hbCB1aSBtb2R1bGUgdG8gc2hvdyBwcm9ncmVzcyBpZiBvbnByb2dyZXNzIGlzIG5vdCBzZXQgYnkgY2xpZW50XG5cbmV4cG9ydCBjbGFzcyBEb3NVaSB7XG4gICAgcHJpdmF0ZSBjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50O1xuICAgIHByaXZhdGUgZG9zOiBEb3NNb2R1bGU7XG5cbiAgICBwcml2YXRlIG92ZXJsYXk6IEhUTUxEaXZFbGVtZW50O1xuICAgIHByaXZhdGUgbG9hZGVyTWVzc2FnZTogSFRNTERpdkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBoaWRkZW46IGJvb2xlYW47XG5cbiAgICBjb25zdHJ1Y3Rvcihkb3M6IERvc01vZHVsZSkge1xuICAgICAgICB0aGlzLmRvcyA9IGRvcztcbiAgICAgICAgdGhpcy5jYW52YXMgPSBkb3MuY2FudmFzO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJqcy1kb3MtdWktY3NzXCIpID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIikgYXMgSFRNTFN0eWxlRWxlbWVudDtcbiAgICAgICAgICAgICAgICBzdHlsZS5pZCA9IFwianMtZG9zLXVpLWNzc1wiO1xuICAgICAgICAgICAgICAgIHN0eWxlLmlubmVySFRNTCA9IHRoaXMuY3NzO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc3R5bGUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5jYW52YXMucGFyZW50RWxlbWVudC5jbGFzc05hbWUgIT09IFwiZG9zYm94LWNvbnRhaW5lclwiKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSBhcyBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgICAgICAgICBjb250YWluZXIuY2xhc3NOYW1lID0gXCJkb3Nib3gtY29udGFpbmVyXCI7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnQgPSB0aGlzLmNhbnZhcy5wYXJlbnRFbGVtZW50O1xuICAgICAgICAgICAgICAgIHBhcmVudC5yZXBsYWNlQ2hpbGQoY29udGFpbmVyLCB0aGlzLmNhbnZhcyk7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuY2FudmFzKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpIGFzIEhUTUxEaXZFbGVtZW50O1xuICAgICAgICAgICAgICAgIG92ZXJsYXkuY2xhc3NOYW1lID0gXCJkb3Nib3gtb3ZlcmxheVwiO1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChvdmVybGF5KTtcblxuICAgICAgICAgICAgICAgIG92ZXJsYXkuaW5uZXJIVE1MID0gdGhpcy5vdmVybGF5SHRtbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5jYW52YXMucGFyZW50RWxlbWVudDtcbiAgICAgICAgICAgIHRoaXMub3ZlcmxheSA9IHRoaXMuY2hpbGRCeUlkKGNvbnRhaW5lciwgXCJkb3Nib3gtb3ZlcmxheVwiKTtcbiAgICAgICAgICAgIHRoaXMubG9hZGVyTWVzc2FnZSA9IHRoaXMuY2hpbGRCeUlkKHRoaXMub3ZlcmxheSwgXCJkb3Nib3gtbG9hZGVyLW1lc3NhZ2VcIik7XG5cbiAgICAgICAgICAgIHRoaXMuaGlkZGVuID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmhpZGUoKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgdGhpcy5vbnByb2dyZXNzID0gdGhpcy5vbnByb2dyZXNzRmFsbGJhY2s7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgb25wcm9ncmVzcyhzdGFnZTogc3RyaW5nLCB0b3RhbDogbnVtYmVyLCBsb2FkZWQ6IG51bWJlcikge1xuICAgICAgICBjb25zdCBtZXNzYWdlID0gc3RhZ2UgKyBcIiBcIiArIE1hdGgucm91bmQobG9hZGVkICogMTAwIC8gdG90YWwgKiAxMCkgLyAxMCArIFwiJVwiO1xuICAgICAgICB0aGlzLmxvYWRlck1lc3NhZ2UuaW5uZXJIVE1MID0gbWVzc2FnZTtcbiAgICAgICAgdGhpcy5kb3MuaW5mbyhtZXNzYWdlKTtcblxuICAgICAgICBpZiAobG9hZGVkID49IHRvdGFsKSB7XG4gICAgICAgICAgICB0aGlzLmhpZGUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2hvdygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGRldGFjaCgpIHtcbiAgICAgICAgdGhpcy5oaWRlKCk7XG4gICAgICAgIHRoaXMub25wcm9ncmVzcyA9IHRoaXMub25wcm9ncmVzc0ZhbGxiYWNrO1xuICAgIH1cblxuICAgIHB1YmxpYyBoaWRlKCkge1xuICAgICAgICBpZiAodGhpcy5oaWRkZW4pIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmhpZGRlbiA9IHRydWU7XG4gICAgICAgIHRoaXMub3ZlcmxheS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImRpc3BsYXk6IG5vbmVcIik7XG4gICAgfVxuXG4gICAgcHVibGljIHNob3coKSB7XG4gICAgICAgIGlmICghdGhpcy5oaWRkZW4pIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmhpZGRlbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLm92ZXJsYXkuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJkaXNwbGF5OiBibG9ja1wiKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG9ucHJvZ3Jlc3NGYWxsYmFjayhzdGFnZTogc3RyaW5nLCB0b3RhbDogbnVtYmVyLCBsb2FkZWQ6IG51bWJlcikge1xuICAgICAgICB0aGlzLmRvcy5pbmZvKHN0YWdlICsgXCIgXCIgKyBsb2FkZWQgKiAxMDAgLyB0b3RhbCArIFwiJVwiKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNoaWxkQnlJZChwYXJlbnQ6IEVsZW1lbnQsIGNsYXNzTmFtZTogc3RyaW5nKSB7XG4gICAgICAgIGlmIChwYXJlbnQgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXJlbnQuY2hpbGRFbGVtZW50Q291bnQ7ICsraSkge1xuICAgICAgICAgICAgbGV0IGNoaWxkID0gcGFyZW50LmNoaWxkcmVuW2ldO1xuICAgICAgICAgICAgaWYgKGNoaWxkLmNsYXNzTmFtZSA9PT0gY2xhc3NOYW1lKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkIGFzIEhUTUxEaXZFbGVtZW50O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjaGlsZCA9IHRoaXMuY2hpbGRCeUlkKGNoaWxkLCBjbGFzc05hbWUpO1xuICAgICAgICAgICAgaWYgKGNoaWxkICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkIGFzIEhUTUxEaXZFbGVtZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgLyogdHNsaW50OmRpc2FibGU6bWVtYmVyLW9yZGVyaW5nICovXG4gICAgLyogdHNsaW50OmRpc2FibGU6bWF4LWxpbmUtbGVuZ3RoICovXG4gICAgcHJpdmF0ZSBjc3M6IHN0cmluZyA9IGBcbiAgICAuZG9zYm94LWNvbnRhaW5lciB7IHBvc2l0aW9uOiByZWxhdGl2ZTsgbWluLXdpZHRoOiAzMjBweDsgbWluLWhlaWdodDogMjAwcHg7IGRpc3BsYXk6IGlubGluZS1ibG9jazsgfVxuICAgIC5kb3Nib3gtb3ZlcmxheSwgLmRvc2JveC1sb2FkZXIgeyBwb3NpdGlvbjogYWJzb2x1dGU7IGxlZnQ6IDA7IHJpZ2h0OiAwOyB0b3A6IDA7IGJvdHRvbTogMDsgYmFja2dyb3VuZC1jb2xvcjogcmdiYSg1MSwgNTEsIDUxLCAwLjcpOyB9XG4gICAgLmRvc2JveC1zdGFydCB7IHRleHQtYWxpZ246IGNlbnRlcjsgcG9zaXRpb246IGFic29sdXRlOyBsZWZ0OiAwOyByaWdodDogMDsgYm90dG9tOiA1MCU7IGNvbG9yOiAjZjgwOyBmb250LXNpemU6IDEuNWVtOyB0ZXh0LWRlY29yYXRpb246IHVuZGVybGluZTsgY3Vyc29yOiBwb2ludGVyOyB9XG4gICAgLmRvc2JveC1vdmVybGF5IGEgeyBjb2xvcjogI2Y4MDsgfVxuICAgIC5kb3Nib3gtcG93ZXJlZCB7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgcmlnaHQ6IDFlbTsgYm90dG9tOiAxZW07IGZvbnQtc2l6ZTogMC44ZW07IGNvbG9yOiAjOUM5QzlDOyB9XG4gICAgLmRvc2JveC1sb2FkZXItbWVzc2FnZSB7IHRleHQtYWxpZ246IGNlbnRlcjsgcG9zaXRpb246IGFic29sdXRlOyBsZWZ0OiAwOyByaWdodDogMDsgYm90dG9tOiA1MCU7IG1hcmdpbjogMCAwIC0zZW0gMDsgYm94LXNpemluZzogYm9yZGVyLWJveDsgY29sb3I6ICNmODA7IGZvbnQtc2l6ZTogMS41ZW07IH1cbiAgICBALW1vei1rZXlmcmFtZXMgbG9hZGluZyB7IDAlIHsgbGVmdDogMDsgfSA1MCUgeyBsZWZ0OiA4LjMzMzMzZW07IH0gMTAwJSB7IGxlZnQ6IDA7IH0gfSBALXdlYmtpdC1rZXlmcmFtZXMgbG9hZGluZyB7IDAlIHsgbGVmdDogMDsgfSA1MCUgeyBsZWZ0OiA4LjMzMzMzZW07IH0gMTAwJSB7IGxlZnQ6IDA7IH0gfSBAa2V5ZnJhbWVzIGxvYWRpbmcgeyAwJSB7IGxlZnQ6IDA7IH0gNTAlIHsgbGVmdDogOC4zMzMzM2VtOyB9IDEwMCUgeyBsZWZ0OiAwOyB9IH0gLnN0LWxvYWRlciB7IHdpZHRoOiAxMGVtOyBoZWlnaHQ6IDIuNWVtOyBwb3NpdGlvbjogYWJzb2x1dGU7IHRvcDogNTAlOyBsZWZ0OiA1MCU7IG1hcmdpbjogLTEuMjVlbSAwIDAgLTVlbTsgYm94LXNpemluZzogYm9yZGVyLWJveDsgfVxuICAgIC5zdC1sb2FkZXI6YmVmb3JlLCAuc3QtbG9hZGVyOmFmdGVyIHsgY29udGVudDogXCJcIjsgZGlzcGxheTogYmxvY2s7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAwOyBib3R0b206IDA7IHdpZHRoOiAxLjI1ZW07IGJveC1zaXppbmc6IGJvcmRlci1ib3g7IGJvcmRlcjogMC4yNWVtIHNvbGlkICNmODA7IH1cbiAgICAuc3QtbG9hZGVyOmJlZm9yZSB7IGxlZnQ6IC0wLjc2OTIzZW07IGJvcmRlci1yaWdodDogMDsgfVxuICAgIC5zdC1sb2FkZXI6YWZ0ZXIgeyByaWdodDogLTAuNzY5MjNlbTsgYm9yZGVyLWxlZnQ6IDA7IH1cbiAgICAuc3QtbG9hZGVyIC5lcXVhbCB7IGRpc3BsYXk6IGJsb2NrOyBwb3NpdGlvbjogYWJzb2x1dGU7IHRvcDogNTAlOyBtYXJnaW4tdG9wOiAtMC41ZW07IGxlZnQ6IDQuMTY2NjdlbTsgaGVpZ2h0OiAxZW07IHdpZHRoOiAxLjY2NjY3ZW07IGJvcmRlcjogMC4yNWVtIHNvbGlkICNmODA7IGJveC1zaXppbmc6IGJvcmRlci1ib3g7IGJvcmRlci13aWR0aDogMC4yNWVtIDA7IC1tb3otYW5pbWF0aW9uOiBsb2FkaW5nIDEuNXMgaW5maW5pdGUgZWFzZS1pbi1vdXQ7IC13ZWJraXQtYW5pbWF0aW9uOiBsb2FkaW5nIDEuNXMgaW5maW5pdGUgZWFzZS1pbi1vdXQ7IGFuaW1hdGlvbjogbG9hZGluZyAxLjVzIGluZmluaXRlIGVhc2UtaW4tb3V0OyBiYWNrZ3JvdW5kOiAjZjgwOyB9XG4gICAgYDtcblxuICAgIC8qIHRzbGludDpkaXNhYmxlOm1lbWJlci1vcmRlcmluZyAqL1xuICAgIC8qIHRzbGludDpkaXNhYmxlOm1heC1saW5lLWxlbmd0aCAqL1xuICAgIHByaXZhdGUgb3ZlcmxheUh0bWw6IHN0cmluZyA9IGBcbiAgICAgICAgPGRpdiBjbGFzcz1cImRvc2JveC1sb2FkZXJcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzdC1sb2FkZXJcIj5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImVxdWFsXCI+PC9zcGFuPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZG9zYm94LWxvYWRlci1tZXNzYWdlXCI+PC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZG9zYm94LXBvd2VyZWRcIj5cbiAgICAgICAgICAgIFBvd2VyZWQgYnkgJm5ic3A7PGEgaHJlZj1cImh0dHBzOi8vanMtZG9zLmNvbVwiPmpzLWRvcy5jb208L2E+ICg2LjIyKVxuICAgICAgICA8L2Rpdj5cbiAgICBgO1xufVxuIiwiaW50ZXJmYWNlIFhock9wdGlvbnMge1xuICAgIG1ldGhvZD86IHN0cmluZztcbiAgICBzdWNjZXNzPzogKHJlc3BvbnNlOiBhbnkpID0+IHZvaWQ7XG4gICAgcHJvZ3Jlc3M/OiAodG90YWw6IG51bWJlciwgbG9hZGVkOiBudW1iZXIpID0+IHZvaWQ7XG4gICAgZmFpbD86ICh1cmw6IHN0cmluZywgc3RhdHVzOiBudW1iZXIsIG1lc3NhZ2U6IHN0cmluZykgPT4gdm9pZDtcbiAgICBkYXRhPzogc3RyaW5nO1xuICAgIHJlc3BvbnNlVHlwZT86IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIFhociB7XG4gICAgcHJpdmF0ZSByZXNvdXJjZTogc3RyaW5nO1xuICAgIHByaXZhdGUgb3B0aW9uczogWGhyT3B0aW9ucztcbiAgICBwcml2YXRlIHhocjogWE1MSHR0cFJlcXVlc3Q7XG4gICAgcHJpdmF0ZSB0b3RhbDogbnVtYmVyID0gMDtcbiAgICBwcml2YXRlIGxvYWRlZDogbnVtYmVyID0gMDtcblxuICAgIGNvbnN0cnVjdG9yKHVybDogc3RyaW5nLCBvcHRpb25zOiBYaHJPcHRpb25zKSB7XG4gICAgICAgIHRoaXMucmVzb3VyY2UgPSB1cmw7XG4gICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgIHRoaXMub3B0aW9ucy5tZXRob2QgPSBvcHRpb25zLm1ldGhvZCB8fCBcIkdFVFwiO1xuICAgICAgICB0aGlzLnhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICB0aGlzLnhoci5vcGVuKHRoaXMub3B0aW9ucy5tZXRob2QsIHVybCwgdHJ1ZSk7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMubWV0aG9kID09PSBcIlBPU1RcIikge1xuICAgICAgICAgICAgdGhpcy54aHIuc2V0UmVxdWVzdEhlYWRlcihcIkNvbnRlbnQtdHlwZVwiLCBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnhoci5vdmVycmlkZU1pbWVUeXBlKFwidGV4dC9wbGFpbjsgY2hhcnNldD14LXVzZXItZGVmaW5lZFwiKTtcblxuICAgICAgICBsZXQgcHJvZ3Jlc3NMaXN0bmVyO1xuICAgICAgICBpZiAodHlwZW9mIChwcm9ncmVzc0xpc3RuZXIgPSB0aGlzLnhocikuYWRkRXZlbnRMaXN0ZW5lciA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICBwcm9ncmVzc0xpc3RuZXIuYWRkRXZlbnRMaXN0ZW5lcihcInByb2dyZXNzXCIsIChldnQpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnRvdGFsID0gZXZ0LnRvdGFsO1xuICAgICAgICAgICAgICAgIHRoaXMubG9hZGVkID0gZXZ0LmxvYWRlZDtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnByb2dyZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMucHJvZ3Jlc3MoZXZ0LnRvdGFsLCBldnQubG9hZGVkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBlcnJvckxpc3RlbmVyO1xuICAgICAgICBpZiAodHlwZW9mIChlcnJvckxpc3RlbmVyID0gdGhpcy54aHIpLmFkZEV2ZW50TGlzdGVuZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgZXJyb3JMaXN0ZW5lci5hZGRFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgKGV2dCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZmFpbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMuZmFpbCh0aGlzLnJlc291cmNlLCB0aGlzLnhoci5zdGF0dXMsIFwiY29ubmVjdGlvbiBwcm9ibGVtXCIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVsZXRlIHRoaXMub3B0aW9ucy5mYWlsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMueGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9ICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm9uUmVhZHlTdGF0ZUNoYW5nZSgpO1xuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnJlc3BvbnNlVHlwZSkge1xuICAgICAgICAgICAgdGhpcy54aHIucmVzcG9uc2VUeXBlID0gdGhpcy5vcHRpb25zLnJlc3BvbnNlVHlwZSBhcyBYTUxIdHRwUmVxdWVzdFJlc3BvbnNlVHlwZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnhoci5zZW5kKHRoaXMub3B0aW9ucy5kYXRhKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgb25SZWFkeVN0YXRlQ2hhbmdlKCkge1xuICAgICAgICBpZiAodGhpcy54aHIucmVhZHlTdGF0ZSA9PT0gNCkge1xuICAgICAgICAgICAgaWYgKHRoaXMueGhyLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRvdGFsID0gTWF0aC5tYXgodGhpcy50b3RhbCwgdGhpcy5sb2FkZWQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMucHJvZ3Jlc3ModG90YWwsIHRvdGFsKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5zdWNjZXNzKHRoaXMueGhyLnJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9ucy5mYWlsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLmZhaWwodGhpcy5yZXNvdXJjZSwgdGhpcy54aHIuc3RhdHVzLCBcImNvbm5lY3Rpb24gcHJvYmxlbVwiKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVsZXRlIHRoaXMub3B0aW9ucy5mYWlsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGFycmF5QnVmZmVyVG9TdHJpbmcoYnVmZmVyOiBBcnJheUJ1ZmZlcikge1xuICAgICAgICBjb25zdCBidWZWaWV3ID0gbmV3IFVpbnQxNkFycmF5KGJ1ZmZlcik7XG4gICAgICAgIGNvbnN0IGxlbmd0aCA9IGJ1ZlZpZXcubGVuZ3RoO1xuICAgICAgICBsZXQgcmVzdWx0ID0gXCJcIjtcbiAgICAgICAgbGV0IG1heENhbGxTaXplID0gTWF0aC5wb3coMiwgMTYpIC0gMTtcbiAgICAgICAgbGV0IGkgPSAwO1xuICAgICAgICB3aGlsZSAoaSA8IGxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKGkgKyBtYXhDYWxsU2l6ZSA+IGxlbmd0aCkge1xuICAgICAgICAgICAgICAgIG1heENhbGxTaXplID0gbGVuZ3RoIC0gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc3VsdCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIGJ1ZlZpZXcuc3ViYXJyYXkoaSwgaSArIG1heENhbGxTaXplKSk7XG4gICAgICAgICAgICBpICs9IG1heENhbGxTaXplO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG59XG4iLCJcbmltcG9ydCB7IERvc0NvbW1hbmRJbnRlZmFjZSB9IGZyb20gXCIuL2pzLWRvcy1jaVwiO1xuaW1wb3J0IHsgRG9zRlMgfSBmcm9tIFwiLi9qcy1kb3MtZnNcIjtcbmltcG9ydCB7IEhvc3QgfSBmcm9tIFwiLi9qcy1kb3MtaG9zdFwiO1xuaW1wb3J0IHsgRG9zTW9kdWxlIH0gZnJvbSBcIi4vanMtZG9zLW1vZHVsZVwiO1xuaW1wb3J0IHsgRG9zT3B0aW9ucyB9IGZyb20gXCIuL2pzLWRvcy1vcHRpb25zXCI7XG5cbi8vIERvc1xuLy8gPT09XG4vLyBEb3MgZnVuY3Rpb24gaXMgZW50cnkgcG9pbnQgdGhhdCBwcm92aWRlcyBlbXVsYXRpb24gbGF5ZXIuXG4vLyBBcyBlbXVsYXRpb24gbGF5ZXIganMtZG9zIHVzZXMgW0Rvc0JveCBwb3J0ZWQgdG8gZW1zY3JpcHRlbl0oaHR0cHM6Ly9naXRodWIuY29tL2RyZWFtbGF5ZXJzL2VtLWRvc2JveC8jY29tcGlsaW5nKS5cbi8vXG4vLyAqKmNhbnZhcyoqIC0gaXMgKipyZXF1aXJlZCoqLCB5b3Ugc2hvdWxkIHNldCBleGlzdGluZyBIVE1MQ2FudmFzRWxlbWVudCwgaXQgd2lsbCBiZSB1c2VkIGZvciByZW5kZXIgZG9zIHNjcmVlblxuLy8gKipvcHRpb25zKiogLSBTZWUgW0Rvc09wdGlvbnNdKGpzLWRvcy1vcHRpb25zLmh0bWwpIHRvIHVuZGVyc3RhbmQgaG93IHlvdSBjYW4gY29uZmlndXJlIERvcyBjbGFzcy5cbmV4cG9ydCBmdW5jdGlvbiBEb3MoY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCwgb3B0aW9uczogRG9zT3B0aW9ucykge1xuICAgIGNvbnN0IHByb21pc2UgPSBuZXcgUHJvbWlzZTxEb3NSdW50aW1lPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIGNvbnN0IG1vZHVsZSA9IG5ldyBEb3NNb2R1bGUoY2FudmFzLCByZXNvbHZlKTtcbiAgICAgICAgT2JqZWN0LmFzc2lnbihtb2R1bGUsIG9wdGlvbnMpO1xuXG4gICAgICAgIC8vIEVycm9yc1xuICAgICAgICAvLyAtLS0tLS1cbiAgICAgICAgLy8gRXJyb3IgcHJvcGFnYXRpb24gc2hvdWxkIHN1cHBvcnQgYm90aCB3YXlzOlxuICAgICAgICAvLyAxLiBUaHJvdWdoIHJlamVjdCBvZiBwcm9taXNlXG4gICAgICAgIC8vIDIuIEZpcmUgb25lcnJvciBmdW5jdGlvbiBvZiBEb3NPcHRpb25zIG9iamVjdFxuICAgICAgICBjb25zdCBvbmVycm9yID0gbW9kdWxlLm9uZXJyb3I7XG4gICAgICAgIG1vZHVsZS5vbmVycm9yID0gKG1lc3NhZ2U6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgcmVqZWN0KG1lc3NhZ2UpO1xuXG4gICAgICAgICAgICBjb25zdCBmbiA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAob25lcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBvbmVycm9yKG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICBtb2R1bGUub25lcnJvciA9IG9uZXJyb3I7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kdWxlLm9uZXJyb3IgPSBtb2R1bGUuZXJyb3I7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgc2V0VGltZW91dChmbiwgMSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgbW9kdWxlLnJlc29sdmUoKTtcbiAgICAgICAgaWYgKCFtb2R1bGUuaXNWYWxpZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2VlIFtIb3N0XShqcy1kb3MtaG9zdC5odG1sKSB0byB1bmRlcnN0YW5kIHJlc29sdmluZyBvZiBlbXVsYXRpb24gbGF5ZXIgKGRvc2JveCkuXG4gICAgICAgIEhvc3QucmVzb2x2ZURvc0JveChtb2R1bGUud2Rvc2JveFVybCwgbW9kdWxlKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGRvc1JlYWR5UHJvbWlzZSA9IChwcm9taXNlIGFzIHVua25vd24pIGFzIERvc1JlYWR5UHJvbWlzZTtcbiAgICBkb3NSZWFkeVByb21pc2UucmVhZHkgPSAob25yZWFkeSkgPT4ge1xuICAgICAgICBkb3NSZWFkeVByb21pc2UudGhlbigocnVudGltZTogRG9zUnVudGltZSkgPT4ge1xuICAgICAgICAgICAgb25yZWFkeShydW50aW1lLmZzLCBydW50aW1lLm1haW4pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBkb3NSZWFkeVByb21pc2U7XG59XG5cbi8vIERvc1JlYWR5UHJvbWlzZVxuLy8gLS0tLS0tLS0tLS0tLS0tXG4vLyBJcyBQcm9taXNlIG9iamVjdCB3aXRoIGFkZGl0aW9uYWwgbWV0aG9kIHJlYWR5LiBJdCByZXR1cm5lZCBieSAgRG9zIGZ1bmN0aW9uXG4vLyB3aGVuIHByb21pc2UgaXMgcmVzb2x2ZWQgaXQgbWVhbnMgdGhhdCBEb3NCb3ggcnVudGltZSBpcyByZWFkeSBmb3IgdXNlXG4vLyBhbmQgeW91IGNhbiBzdGFydCB5b3VyIHByb2dyYW1cblxuLy8gRG9zUnVudGltZVxuLy8gLS0tLS0tLS0tLVxuZXhwb3J0IHR5cGUgRG9zTWFpbkZuID0gKGFyZ3M6IHN0cmluZ1tdKSA9PiBQcm9taXNlPERvc0NvbW1hbmRJbnRlZmFjZT47XG5cbmV4cG9ydCBpbnRlcmZhY2UgRG9zUnVudGltZSB7XG4gICAgZnM6IERvc0ZTO1xuICAgIG1haW46IERvc01haW5Gbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBEb3NSZWFkeVByb21pc2UgZXh0ZW5kcyBQcm9taXNlPERvc1J1bnRpbWU+IHtcbiAgICAvLyByZWFkeVxuICAgIC8vIC0tLS0tLS1cbiAgICAvLyBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBiZWZvcmUgcnVubmluZyBlbnRyeSBwb2ludCBvZiBkb3Nib3hcbiAgICAvLyB3aXRoIGl0IHlvdSBjYW4gY2hhbmdlIGNvbW1hbmQgbGluZSBhcmd1bWVudHMgdGhhdCBwYXNzZWQgdG8gZG9zYm94XG4gICAgLy8gb3IgY29uZmlndXJlIEZTIGxheWVyXG4gICAgcmVhZHk6IChvbnJlYWR5OiAoZnM6IERvc0ZTLCBtYWluOiBEb3NNYWluRm4pID0+IHZvaWQpID0+IHZvaWQ7XG59XG5cbih3aW5kb3cgYXMgYW55KS5Eb3MgPSBEb3M7XG4iLCIndXNlIHN0cmljdCc7XG5cbi8vIGNvbXBhcmUgYW5kIGlzQnVmZmVyIHRha2VuIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL2Zlcm9zcy9idWZmZXIvYmxvYi82ODBlOWU1ZTQ4OGYyMmFhYzI3NTk5YTU3ZGM4NDRhNjMxNTkyOGRkL2luZGV4LmpzXG4vLyBvcmlnaW5hbCBub3RpY2U6XG5cbi8qIVxuICogVGhlIGJ1ZmZlciBtb2R1bGUgZnJvbSBub2RlLmpzLCBmb3IgdGhlIGJyb3dzZXIuXG4gKlxuICogQGF1dGhvciAgIEZlcm9zcyBBYm91a2hhZGlqZWggPGZlcm9zc0BmZXJvc3Mub3JnPiA8aHR0cDovL2Zlcm9zcy5vcmc+XG4gKiBAbGljZW5zZSAgTUlUXG4gKi9cbmZ1bmN0aW9uIGNvbXBhcmUoYSwgYikge1xuICBpZiAoYSA9PT0gYikge1xuICAgIHJldHVybiAwO1xuICB9XG5cbiAgdmFyIHggPSBhLmxlbmd0aDtcbiAgdmFyIHkgPSBiLmxlbmd0aDtcblxuICBmb3IgKHZhciBpID0gMCwgbGVuID0gTWF0aC5taW4oeCwgeSk7IGkgPCBsZW47ICsraSkge1xuICAgIGlmIChhW2ldICE9PSBiW2ldKSB7XG4gICAgICB4ID0gYVtpXTtcbiAgICAgIHkgPSBiW2ldO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgaWYgKHggPCB5KSB7XG4gICAgcmV0dXJuIC0xO1xuICB9XG4gIGlmICh5IDwgeCkge1xuICAgIHJldHVybiAxO1xuICB9XG4gIHJldHVybiAwO1xufVxuZnVuY3Rpb24gaXNCdWZmZXIoYikge1xuICBpZiAoZ2xvYmFsLkJ1ZmZlciAmJiB0eXBlb2YgZ2xvYmFsLkJ1ZmZlci5pc0J1ZmZlciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHJldHVybiBnbG9iYWwuQnVmZmVyLmlzQnVmZmVyKGIpO1xuICB9XG4gIHJldHVybiAhIShiICE9IG51bGwgJiYgYi5faXNCdWZmZXIpO1xufVxuXG4vLyBiYXNlZCBvbiBub2RlIGFzc2VydCwgb3JpZ2luYWwgbm90aWNlOlxuXG4vLyBodHRwOi8vd2lraS5jb21tb25qcy5vcmcvd2lraS9Vbml0X1Rlc3RpbmcvMS4wXG4vL1xuLy8gVEhJUyBJUyBOT1QgVEVTVEVEIE5PUiBMSUtFTFkgVE8gV09SSyBPVVRTSURFIFY4IVxuLy9cbi8vIE9yaWdpbmFsbHkgZnJvbSBuYXJ3aGFsLmpzIChodHRwOi8vbmFyd2hhbGpzLm9yZylcbi8vIENvcHlyaWdodCAoYykgMjAwOSBUaG9tYXMgUm9iaW5zb24gPDI4MG5vcnRoLmNvbT5cbi8vXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4vLyBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAnU29mdHdhcmUnKSwgdG9cbi8vIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlXG4vLyByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Jcbi8vIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4vLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4vLyBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgJ0FTIElTJywgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuLy8gSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4vLyBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbi8vIEFVVEhPUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOXG4vLyBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OXG4vLyBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxudmFyIHV0aWwgPSByZXF1aXJlKCd1dGlsLycpO1xudmFyIGhhc093biA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG52YXIgcFNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlO1xudmFyIGZ1bmN0aW9uc0hhdmVOYW1lcyA9IChmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBmdW5jdGlvbiBmb28oKSB7fS5uYW1lID09PSAnZm9vJztcbn0oKSk7XG5mdW5jdGlvbiBwVG9TdHJpbmcgKG9iaikge1xuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaik7XG59XG5mdW5jdGlvbiBpc1ZpZXcoYXJyYnVmKSB7XG4gIGlmIChpc0J1ZmZlcihhcnJidWYpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGlmICh0eXBlb2YgZ2xvYmFsLkFycmF5QnVmZmVyICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGlmICh0eXBlb2YgQXJyYXlCdWZmZXIuaXNWaWV3ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgcmV0dXJuIEFycmF5QnVmZmVyLmlzVmlldyhhcnJidWYpO1xuICB9XG4gIGlmICghYXJyYnVmKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGlmIChhcnJidWYgaW5zdGFuY2VvZiBEYXRhVmlldykge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGlmIChhcnJidWYuYnVmZmVyICYmIGFycmJ1Zi5idWZmZXIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cbi8vIDEuIFRoZSBhc3NlcnQgbW9kdWxlIHByb3ZpZGVzIGZ1bmN0aW9ucyB0aGF0IHRocm93XG4vLyBBc3NlcnRpb25FcnJvcidzIHdoZW4gcGFydGljdWxhciBjb25kaXRpb25zIGFyZSBub3QgbWV0LiBUaGVcbi8vIGFzc2VydCBtb2R1bGUgbXVzdCBjb25mb3JtIHRvIHRoZSBmb2xsb3dpbmcgaW50ZXJmYWNlLlxuXG52YXIgYXNzZXJ0ID0gbW9kdWxlLmV4cG9ydHMgPSBvaztcblxuLy8gMi4gVGhlIEFzc2VydGlvbkVycm9yIGlzIGRlZmluZWQgaW4gYXNzZXJ0LlxuLy8gbmV3IGFzc2VydC5Bc3NlcnRpb25FcnJvcih7IG1lc3NhZ2U6IG1lc3NhZ2UsXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0dWFsOiBhY3R1YWwsXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWQ6IGV4cGVjdGVkIH0pXG5cbnZhciByZWdleCA9IC9cXHMqZnVuY3Rpb25cXHMrKFteXFwoXFxzXSopXFxzKi87XG4vLyBiYXNlZCBvbiBodHRwczovL2dpdGh1Yi5jb20vbGpoYXJiL2Z1bmN0aW9uLnByb3RvdHlwZS5uYW1lL2Jsb2IvYWRlZWVlYzhiZmNjNjA2OGIxODdkN2Q5ZmIzZDViYjFkM2EzMDg5OS9pbXBsZW1lbnRhdGlvbi5qc1xuZnVuY3Rpb24gZ2V0TmFtZShmdW5jKSB7XG4gIGlmICghdXRpbC5pc0Z1bmN0aW9uKGZ1bmMpKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmIChmdW5jdGlvbnNIYXZlTmFtZXMpIHtcbiAgICByZXR1cm4gZnVuYy5uYW1lO1xuICB9XG4gIHZhciBzdHIgPSBmdW5jLnRvU3RyaW5nKCk7XG4gIHZhciBtYXRjaCA9IHN0ci5tYXRjaChyZWdleCk7XG4gIHJldHVybiBtYXRjaCAmJiBtYXRjaFsxXTtcbn1cbmFzc2VydC5Bc3NlcnRpb25FcnJvciA9IGZ1bmN0aW9uIEFzc2VydGlvbkVycm9yKG9wdGlvbnMpIHtcbiAgdGhpcy5uYW1lID0gJ0Fzc2VydGlvbkVycm9yJztcbiAgdGhpcy5hY3R1YWwgPSBvcHRpb25zLmFjdHVhbDtcbiAgdGhpcy5leHBlY3RlZCA9IG9wdGlvbnMuZXhwZWN0ZWQ7XG4gIHRoaXMub3BlcmF0b3IgPSBvcHRpb25zLm9wZXJhdG9yO1xuICBpZiAob3B0aW9ucy5tZXNzYWdlKSB7XG4gICAgdGhpcy5tZXNzYWdlID0gb3B0aW9ucy5tZXNzYWdlO1xuICAgIHRoaXMuZ2VuZXJhdGVkTWVzc2FnZSA9IGZhbHNlO1xuICB9IGVsc2Uge1xuICAgIHRoaXMubWVzc2FnZSA9IGdldE1lc3NhZ2UodGhpcyk7XG4gICAgdGhpcy5nZW5lcmF0ZWRNZXNzYWdlID0gdHJ1ZTtcbiAgfVxuICB2YXIgc3RhY2tTdGFydEZ1bmN0aW9uID0gb3B0aW9ucy5zdGFja1N0YXJ0RnVuY3Rpb24gfHwgZmFpbDtcbiAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgc3RhY2tTdGFydEZ1bmN0aW9uKTtcbiAgfSBlbHNlIHtcbiAgICAvLyBub24gdjggYnJvd3NlcnMgc28gd2UgY2FuIGhhdmUgYSBzdGFja3RyYWNlXG4gICAgdmFyIGVyciA9IG5ldyBFcnJvcigpO1xuICAgIGlmIChlcnIuc3RhY2spIHtcbiAgICAgIHZhciBvdXQgPSBlcnIuc3RhY2s7XG5cbiAgICAgIC8vIHRyeSB0byBzdHJpcCB1c2VsZXNzIGZyYW1lc1xuICAgICAgdmFyIGZuX25hbWUgPSBnZXROYW1lKHN0YWNrU3RhcnRGdW5jdGlvbik7XG4gICAgICB2YXIgaWR4ID0gb3V0LmluZGV4T2YoJ1xcbicgKyBmbl9uYW1lKTtcbiAgICAgIGlmIChpZHggPj0gMCkge1xuICAgICAgICAvLyBvbmNlIHdlIGhhdmUgbG9jYXRlZCB0aGUgZnVuY3Rpb24gZnJhbWVcbiAgICAgICAgLy8gd2UgbmVlZCB0byBzdHJpcCBvdXQgZXZlcnl0aGluZyBiZWZvcmUgaXQgKGFuZCBpdHMgbGluZSlcbiAgICAgICAgdmFyIG5leHRfbGluZSA9IG91dC5pbmRleE9mKCdcXG4nLCBpZHggKyAxKTtcbiAgICAgICAgb3V0ID0gb3V0LnN1YnN0cmluZyhuZXh0X2xpbmUgKyAxKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5zdGFjayA9IG91dDtcbiAgICB9XG4gIH1cbn07XG5cbi8vIGFzc2VydC5Bc3NlcnRpb25FcnJvciBpbnN0YW5jZW9mIEVycm9yXG51dGlsLmluaGVyaXRzKGFzc2VydC5Bc3NlcnRpb25FcnJvciwgRXJyb3IpO1xuXG5mdW5jdGlvbiB0cnVuY2F0ZShzLCBuKSB7XG4gIGlmICh0eXBlb2YgcyA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gcy5sZW5ndGggPCBuID8gcyA6IHMuc2xpY2UoMCwgbik7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHM7XG4gIH1cbn1cbmZ1bmN0aW9uIGluc3BlY3Qoc29tZXRoaW5nKSB7XG4gIGlmIChmdW5jdGlvbnNIYXZlTmFtZXMgfHwgIXV0aWwuaXNGdW5jdGlvbihzb21ldGhpbmcpKSB7XG4gICAgcmV0dXJuIHV0aWwuaW5zcGVjdChzb21ldGhpbmcpO1xuICB9XG4gIHZhciByYXduYW1lID0gZ2V0TmFtZShzb21ldGhpbmcpO1xuICB2YXIgbmFtZSA9IHJhd25hbWUgPyAnOiAnICsgcmF3bmFtZSA6ICcnO1xuICByZXR1cm4gJ1tGdW5jdGlvbicgKyAgbmFtZSArICddJztcbn1cbmZ1bmN0aW9uIGdldE1lc3NhZ2Uoc2VsZikge1xuICByZXR1cm4gdHJ1bmNhdGUoaW5zcGVjdChzZWxmLmFjdHVhbCksIDEyOCkgKyAnICcgK1xuICAgICAgICAgc2VsZi5vcGVyYXRvciArICcgJyArXG4gICAgICAgICB0cnVuY2F0ZShpbnNwZWN0KHNlbGYuZXhwZWN0ZWQpLCAxMjgpO1xufVxuXG4vLyBBdCBwcmVzZW50IG9ubHkgdGhlIHRocmVlIGtleXMgbWVudGlvbmVkIGFib3ZlIGFyZSB1c2VkIGFuZFxuLy8gdW5kZXJzdG9vZCBieSB0aGUgc3BlYy4gSW1wbGVtZW50YXRpb25zIG9yIHN1YiBtb2R1bGVzIGNhbiBwYXNzXG4vLyBvdGhlciBrZXlzIHRvIHRoZSBBc3NlcnRpb25FcnJvcidzIGNvbnN0cnVjdG9yIC0gdGhleSB3aWxsIGJlXG4vLyBpZ25vcmVkLlxuXG4vLyAzLiBBbGwgb2YgdGhlIGZvbGxvd2luZyBmdW5jdGlvbnMgbXVzdCB0aHJvdyBhbiBBc3NlcnRpb25FcnJvclxuLy8gd2hlbiBhIGNvcnJlc3BvbmRpbmcgY29uZGl0aW9uIGlzIG5vdCBtZXQsIHdpdGggYSBtZXNzYWdlIHRoYXRcbi8vIG1heSBiZSB1bmRlZmluZWQgaWYgbm90IHByb3ZpZGVkLiAgQWxsIGFzc2VydGlvbiBtZXRob2RzIHByb3ZpZGVcbi8vIGJvdGggdGhlIGFjdHVhbCBhbmQgZXhwZWN0ZWQgdmFsdWVzIHRvIHRoZSBhc3NlcnRpb24gZXJyb3IgZm9yXG4vLyBkaXNwbGF5IHB1cnBvc2VzLlxuXG5mdW5jdGlvbiBmYWlsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2UsIG9wZXJhdG9yLCBzdGFja1N0YXJ0RnVuY3Rpb24pIHtcbiAgdGhyb3cgbmV3IGFzc2VydC5Bc3NlcnRpb25FcnJvcih7XG4gICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICBhY3R1YWw6IGFjdHVhbCxcbiAgICBleHBlY3RlZDogZXhwZWN0ZWQsXG4gICAgb3BlcmF0b3I6IG9wZXJhdG9yLFxuICAgIHN0YWNrU3RhcnRGdW5jdGlvbjogc3RhY2tTdGFydEZ1bmN0aW9uXG4gIH0pO1xufVxuXG4vLyBFWFRFTlNJT04hIGFsbG93cyBmb3Igd2VsbCBiZWhhdmVkIGVycm9ycyBkZWZpbmVkIGVsc2V3aGVyZS5cbmFzc2VydC5mYWlsID0gZmFpbDtcblxuLy8gNC4gUHVyZSBhc3NlcnRpb24gdGVzdHMgd2hldGhlciBhIHZhbHVlIGlzIHRydXRoeSwgYXMgZGV0ZXJtaW5lZFxuLy8gYnkgISFndWFyZC5cbi8vIGFzc2VydC5vayhndWFyZCwgbWVzc2FnZV9vcHQpO1xuLy8gVGhpcyBzdGF0ZW1lbnQgaXMgZXF1aXZhbGVudCB0byBhc3NlcnQuZXF1YWwodHJ1ZSwgISFndWFyZCxcbi8vIG1lc3NhZ2Vfb3B0KTsuIFRvIHRlc3Qgc3RyaWN0bHkgZm9yIHRoZSB2YWx1ZSB0cnVlLCB1c2Vcbi8vIGFzc2VydC5zdHJpY3RFcXVhbCh0cnVlLCBndWFyZCwgbWVzc2FnZV9vcHQpOy5cblxuZnVuY3Rpb24gb2sodmFsdWUsIG1lc3NhZ2UpIHtcbiAgaWYgKCF2YWx1ZSkgZmFpbCh2YWx1ZSwgdHJ1ZSwgbWVzc2FnZSwgJz09JywgYXNzZXJ0Lm9rKTtcbn1cbmFzc2VydC5vayA9IG9rO1xuXG4vLyA1LiBUaGUgZXF1YWxpdHkgYXNzZXJ0aW9uIHRlc3RzIHNoYWxsb3csIGNvZXJjaXZlIGVxdWFsaXR5IHdpdGhcbi8vID09LlxuLy8gYXNzZXJ0LmVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2Vfb3B0KTtcblxuYXNzZXJ0LmVxdWFsID0gZnVuY3Rpb24gZXF1YWwoYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZSkge1xuICBpZiAoYWN0dWFsICE9IGV4cGVjdGVkKSBmYWlsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2UsICc9PScsIGFzc2VydC5lcXVhbCk7XG59O1xuXG4vLyA2LiBUaGUgbm9uLWVxdWFsaXR5IGFzc2VydGlvbiB0ZXN0cyBmb3Igd2hldGhlciB0d28gb2JqZWN0cyBhcmUgbm90IGVxdWFsXG4vLyB3aXRoICE9IGFzc2VydC5ub3RFcXVhbChhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlX29wdCk7XG5cbmFzc2VydC5ub3RFcXVhbCA9IGZ1bmN0aW9uIG5vdEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2UpIHtcbiAgaWYgKGFjdHVhbCA9PSBleHBlY3RlZCkge1xuICAgIGZhaWwoYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZSwgJyE9JywgYXNzZXJ0Lm5vdEVxdWFsKTtcbiAgfVxufTtcblxuLy8gNy4gVGhlIGVxdWl2YWxlbmNlIGFzc2VydGlvbiB0ZXN0cyBhIGRlZXAgZXF1YWxpdHkgcmVsYXRpb24uXG4vLyBhc3NlcnQuZGVlcEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2Vfb3B0KTtcblxuYXNzZXJ0LmRlZXBFcXVhbCA9IGZ1bmN0aW9uIGRlZXBFcXVhbChhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlKSB7XG4gIGlmICghX2RlZXBFcXVhbChhY3R1YWwsIGV4cGVjdGVkLCBmYWxzZSkpIHtcbiAgICBmYWlsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2UsICdkZWVwRXF1YWwnLCBhc3NlcnQuZGVlcEVxdWFsKTtcbiAgfVxufTtcblxuYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCA9IGZ1bmN0aW9uIGRlZXBTdHJpY3RFcXVhbChhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlKSB7XG4gIGlmICghX2RlZXBFcXVhbChhY3R1YWwsIGV4cGVjdGVkLCB0cnVlKSkge1xuICAgIGZhaWwoYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZSwgJ2RlZXBTdHJpY3RFcXVhbCcsIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwpO1xuICB9XG59O1xuXG5mdW5jdGlvbiBfZGVlcEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIHN0cmljdCwgbWVtb3MpIHtcbiAgLy8gNy4xLiBBbGwgaWRlbnRpY2FsIHZhbHVlcyBhcmUgZXF1aXZhbGVudCwgYXMgZGV0ZXJtaW5lZCBieSA9PT0uXG4gIGlmIChhY3R1YWwgPT09IGV4cGVjdGVkKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gZWxzZSBpZiAoaXNCdWZmZXIoYWN0dWFsKSAmJiBpc0J1ZmZlcihleHBlY3RlZCkpIHtcbiAgICByZXR1cm4gY29tcGFyZShhY3R1YWwsIGV4cGVjdGVkKSA9PT0gMDtcblxuICAvLyA3LjIuIElmIHRoZSBleHBlY3RlZCB2YWx1ZSBpcyBhIERhdGUgb2JqZWN0LCB0aGUgYWN0dWFsIHZhbHVlIGlzXG4gIC8vIGVxdWl2YWxlbnQgaWYgaXQgaXMgYWxzbyBhIERhdGUgb2JqZWN0IHRoYXQgcmVmZXJzIHRvIHRoZSBzYW1lIHRpbWUuXG4gIH0gZWxzZSBpZiAodXRpbC5pc0RhdGUoYWN0dWFsKSAmJiB1dGlsLmlzRGF0ZShleHBlY3RlZCkpIHtcbiAgICByZXR1cm4gYWN0dWFsLmdldFRpbWUoKSA9PT0gZXhwZWN0ZWQuZ2V0VGltZSgpO1xuXG4gIC8vIDcuMyBJZiB0aGUgZXhwZWN0ZWQgdmFsdWUgaXMgYSBSZWdFeHAgb2JqZWN0LCB0aGUgYWN0dWFsIHZhbHVlIGlzXG4gIC8vIGVxdWl2YWxlbnQgaWYgaXQgaXMgYWxzbyBhIFJlZ0V4cCBvYmplY3Qgd2l0aCB0aGUgc2FtZSBzb3VyY2UgYW5kXG4gIC8vIHByb3BlcnRpZXMgKGBnbG9iYWxgLCBgbXVsdGlsaW5lYCwgYGxhc3RJbmRleGAsIGBpZ25vcmVDYXNlYCkuXG4gIH0gZWxzZSBpZiAodXRpbC5pc1JlZ0V4cChhY3R1YWwpICYmIHV0aWwuaXNSZWdFeHAoZXhwZWN0ZWQpKSB7XG4gICAgcmV0dXJuIGFjdHVhbC5zb3VyY2UgPT09IGV4cGVjdGVkLnNvdXJjZSAmJlxuICAgICAgICAgICBhY3R1YWwuZ2xvYmFsID09PSBleHBlY3RlZC5nbG9iYWwgJiZcbiAgICAgICAgICAgYWN0dWFsLm11bHRpbGluZSA9PT0gZXhwZWN0ZWQubXVsdGlsaW5lICYmXG4gICAgICAgICAgIGFjdHVhbC5sYXN0SW5kZXggPT09IGV4cGVjdGVkLmxhc3RJbmRleCAmJlxuICAgICAgICAgICBhY3R1YWwuaWdub3JlQ2FzZSA9PT0gZXhwZWN0ZWQuaWdub3JlQ2FzZTtcblxuICAvLyA3LjQuIE90aGVyIHBhaXJzIHRoYXQgZG8gbm90IGJvdGggcGFzcyB0eXBlb2YgdmFsdWUgPT0gJ29iamVjdCcsXG4gIC8vIGVxdWl2YWxlbmNlIGlzIGRldGVybWluZWQgYnkgPT0uXG4gIH0gZWxzZSBpZiAoKGFjdHVhbCA9PT0gbnVsbCB8fCB0eXBlb2YgYWN0dWFsICE9PSAnb2JqZWN0JykgJiZcbiAgICAgICAgICAgICAoZXhwZWN0ZWQgPT09IG51bGwgfHwgdHlwZW9mIGV4cGVjdGVkICE9PSAnb2JqZWN0JykpIHtcbiAgICByZXR1cm4gc3RyaWN0ID8gYWN0dWFsID09PSBleHBlY3RlZCA6IGFjdHVhbCA9PSBleHBlY3RlZDtcblxuICAvLyBJZiBib3RoIHZhbHVlcyBhcmUgaW5zdGFuY2VzIG9mIHR5cGVkIGFycmF5cywgd3JhcCB0aGVpciB1bmRlcmx5aW5nXG4gIC8vIEFycmF5QnVmZmVycyBpbiBhIEJ1ZmZlciBlYWNoIHRvIGluY3JlYXNlIHBlcmZvcm1hbmNlXG4gIC8vIFRoaXMgb3B0aW1pemF0aW9uIHJlcXVpcmVzIHRoZSBhcnJheXMgdG8gaGF2ZSB0aGUgc2FtZSB0eXBlIGFzIGNoZWNrZWQgYnlcbiAgLy8gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyAoYWthIHBUb1N0cmluZykuIE5ldmVyIHBlcmZvcm0gYmluYXJ5XG4gIC8vIGNvbXBhcmlzb25zIGZvciBGbG9hdCpBcnJheXMsIHRob3VnaCwgc2luY2UgZS5nLiArMCA9PT0gLTAgYnV0IHRoZWlyXG4gIC8vIGJpdCBwYXR0ZXJucyBhcmUgbm90IGlkZW50aWNhbC5cbiAgfSBlbHNlIGlmIChpc1ZpZXcoYWN0dWFsKSAmJiBpc1ZpZXcoZXhwZWN0ZWQpICYmXG4gICAgICAgICAgICAgcFRvU3RyaW5nKGFjdHVhbCkgPT09IHBUb1N0cmluZyhleHBlY3RlZCkgJiZcbiAgICAgICAgICAgICAhKGFjdHVhbCBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheSB8fFxuICAgICAgICAgICAgICAgYWN0dWFsIGluc3RhbmNlb2YgRmxvYXQ2NEFycmF5KSkge1xuICAgIHJldHVybiBjb21wYXJlKG5ldyBVaW50OEFycmF5KGFjdHVhbC5idWZmZXIpLFxuICAgICAgICAgICAgICAgICAgIG5ldyBVaW50OEFycmF5KGV4cGVjdGVkLmJ1ZmZlcikpID09PSAwO1xuXG4gIC8vIDcuNSBGb3IgYWxsIG90aGVyIE9iamVjdCBwYWlycywgaW5jbHVkaW5nIEFycmF5IG9iamVjdHMsIGVxdWl2YWxlbmNlIGlzXG4gIC8vIGRldGVybWluZWQgYnkgaGF2aW5nIHRoZSBzYW1lIG51bWJlciBvZiBvd25lZCBwcm9wZXJ0aWVzIChhcyB2ZXJpZmllZFxuICAvLyB3aXRoIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCksIHRoZSBzYW1lIHNldCBvZiBrZXlzXG4gIC8vIChhbHRob3VnaCBub3QgbmVjZXNzYXJpbHkgdGhlIHNhbWUgb3JkZXIpLCBlcXVpdmFsZW50IHZhbHVlcyBmb3IgZXZlcnlcbiAgLy8gY29ycmVzcG9uZGluZyBrZXksIGFuZCBhbiBpZGVudGljYWwgJ3Byb3RvdHlwZScgcHJvcGVydHkuIE5vdGU6IHRoaXNcbiAgLy8gYWNjb3VudHMgZm9yIGJvdGggbmFtZWQgYW5kIGluZGV4ZWQgcHJvcGVydGllcyBvbiBBcnJheXMuXG4gIH0gZWxzZSBpZiAoaXNCdWZmZXIoYWN0dWFsKSAhPT0gaXNCdWZmZXIoZXhwZWN0ZWQpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9IGVsc2Uge1xuICAgIG1lbW9zID0gbWVtb3MgfHwge2FjdHVhbDogW10sIGV4cGVjdGVkOiBbXX07XG5cbiAgICB2YXIgYWN0dWFsSW5kZXggPSBtZW1vcy5hY3R1YWwuaW5kZXhPZihhY3R1YWwpO1xuICAgIGlmIChhY3R1YWxJbmRleCAhPT0gLTEpIHtcbiAgICAgIGlmIChhY3R1YWxJbmRleCA9PT0gbWVtb3MuZXhwZWN0ZWQuaW5kZXhPZihleHBlY3RlZCkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgbWVtb3MuYWN0dWFsLnB1c2goYWN0dWFsKTtcbiAgICBtZW1vcy5leHBlY3RlZC5wdXNoKGV4cGVjdGVkKTtcblxuICAgIHJldHVybiBvYmpFcXVpdihhY3R1YWwsIGV4cGVjdGVkLCBzdHJpY3QsIG1lbW9zKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBpc0FyZ3VtZW50cyhvYmplY3QpIHtcbiAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvYmplY3QpID09ICdbb2JqZWN0IEFyZ3VtZW50c10nO1xufVxuXG5mdW5jdGlvbiBvYmpFcXVpdihhLCBiLCBzdHJpY3QsIGFjdHVhbFZpc2l0ZWRPYmplY3RzKSB7XG4gIGlmIChhID09PSBudWxsIHx8IGEgPT09IHVuZGVmaW5lZCB8fCBiID09PSBudWxsIHx8IGIgPT09IHVuZGVmaW5lZClcbiAgICByZXR1cm4gZmFsc2U7XG4gIC8vIGlmIG9uZSBpcyBhIHByaW1pdGl2ZSwgdGhlIG90aGVyIG11c3QgYmUgc2FtZVxuICBpZiAodXRpbC5pc1ByaW1pdGl2ZShhKSB8fCB1dGlsLmlzUHJpbWl0aXZlKGIpKVxuICAgIHJldHVybiBhID09PSBiO1xuICBpZiAoc3RyaWN0ICYmIE9iamVjdC5nZXRQcm90b3R5cGVPZihhKSAhPT0gT2JqZWN0LmdldFByb3RvdHlwZU9mKGIpKVxuICAgIHJldHVybiBmYWxzZTtcbiAgdmFyIGFJc0FyZ3MgPSBpc0FyZ3VtZW50cyhhKTtcbiAgdmFyIGJJc0FyZ3MgPSBpc0FyZ3VtZW50cyhiKTtcbiAgaWYgKChhSXNBcmdzICYmICFiSXNBcmdzKSB8fCAoIWFJc0FyZ3MgJiYgYklzQXJncykpXG4gICAgcmV0dXJuIGZhbHNlO1xuICBpZiAoYUlzQXJncykge1xuICAgIGEgPSBwU2xpY2UuY2FsbChhKTtcbiAgICBiID0gcFNsaWNlLmNhbGwoYik7XG4gICAgcmV0dXJuIF9kZWVwRXF1YWwoYSwgYiwgc3RyaWN0KTtcbiAgfVxuICB2YXIga2EgPSBvYmplY3RLZXlzKGEpO1xuICB2YXIga2IgPSBvYmplY3RLZXlzKGIpO1xuICB2YXIga2V5LCBpO1xuICAvLyBoYXZpbmcgdGhlIHNhbWUgbnVtYmVyIG9mIG93bmVkIHByb3BlcnRpZXMgKGtleXMgaW5jb3Jwb3JhdGVzXG4gIC8vIGhhc093blByb3BlcnR5KVxuICBpZiAoa2EubGVuZ3RoICE9PSBrYi5sZW5ndGgpXG4gICAgcmV0dXJuIGZhbHNlO1xuICAvL3RoZSBzYW1lIHNldCBvZiBrZXlzIChhbHRob3VnaCBub3QgbmVjZXNzYXJpbHkgdGhlIHNhbWUgb3JkZXIpLFxuICBrYS5zb3J0KCk7XG4gIGtiLnNvcnQoKTtcbiAgLy9+fn5jaGVhcCBrZXkgdGVzdFxuICBmb3IgKGkgPSBrYS5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgIGlmIChrYVtpXSAhPT0ga2JbaV0pXG4gICAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgLy9lcXVpdmFsZW50IHZhbHVlcyBmb3IgZXZlcnkgY29ycmVzcG9uZGluZyBrZXksIGFuZFxuICAvL35+fnBvc3NpYmx5IGV4cGVuc2l2ZSBkZWVwIHRlc3RcbiAgZm9yIChpID0ga2EubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICBrZXkgPSBrYVtpXTtcbiAgICBpZiAoIV9kZWVwRXF1YWwoYVtrZXldLCBiW2tleV0sIHN0cmljdCwgYWN0dWFsVmlzaXRlZE9iamVjdHMpKVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHJldHVybiB0cnVlO1xufVxuXG4vLyA4LiBUaGUgbm9uLWVxdWl2YWxlbmNlIGFzc2VydGlvbiB0ZXN0cyBmb3IgYW55IGRlZXAgaW5lcXVhbGl0eS5cbi8vIGFzc2VydC5ub3REZWVwRXF1YWwoYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZV9vcHQpO1xuXG5hc3NlcnQubm90RGVlcEVxdWFsID0gZnVuY3Rpb24gbm90RGVlcEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2UpIHtcbiAgaWYgKF9kZWVwRXF1YWwoYWN0dWFsLCBleHBlY3RlZCwgZmFsc2UpKSB7XG4gICAgZmFpbChhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlLCAnbm90RGVlcEVxdWFsJywgYXNzZXJ0Lm5vdERlZXBFcXVhbCk7XG4gIH1cbn07XG5cbmFzc2VydC5ub3REZWVwU3RyaWN0RXF1YWwgPSBub3REZWVwU3RyaWN0RXF1YWw7XG5mdW5jdGlvbiBub3REZWVwU3RyaWN0RXF1YWwoYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZSkge1xuICBpZiAoX2RlZXBFcXVhbChhY3R1YWwsIGV4cGVjdGVkLCB0cnVlKSkge1xuICAgIGZhaWwoYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZSwgJ25vdERlZXBTdHJpY3RFcXVhbCcsIG5vdERlZXBTdHJpY3RFcXVhbCk7XG4gIH1cbn1cblxuXG4vLyA5LiBUaGUgc3RyaWN0IGVxdWFsaXR5IGFzc2VydGlvbiB0ZXN0cyBzdHJpY3QgZXF1YWxpdHksIGFzIGRldGVybWluZWQgYnkgPT09LlxuLy8gYXNzZXJ0LnN0cmljdEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2Vfb3B0KTtcblxuYXNzZXJ0LnN0cmljdEVxdWFsID0gZnVuY3Rpb24gc3RyaWN0RXF1YWwoYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZSkge1xuICBpZiAoYWN0dWFsICE9PSBleHBlY3RlZCkge1xuICAgIGZhaWwoYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZSwgJz09PScsIGFzc2VydC5zdHJpY3RFcXVhbCk7XG4gIH1cbn07XG5cbi8vIDEwLiBUaGUgc3RyaWN0IG5vbi1lcXVhbGl0eSBhc3NlcnRpb24gdGVzdHMgZm9yIHN0cmljdCBpbmVxdWFsaXR5LCBhc1xuLy8gZGV0ZXJtaW5lZCBieSAhPT0uICBhc3NlcnQubm90U3RyaWN0RXF1YWwoYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZV9vcHQpO1xuXG5hc3NlcnQubm90U3RyaWN0RXF1YWwgPSBmdW5jdGlvbiBub3RTdHJpY3RFcXVhbChhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlKSB7XG4gIGlmIChhY3R1YWwgPT09IGV4cGVjdGVkKSB7XG4gICAgZmFpbChhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlLCAnIT09JywgYXNzZXJ0Lm5vdFN0cmljdEVxdWFsKTtcbiAgfVxufTtcblxuZnVuY3Rpb24gZXhwZWN0ZWRFeGNlcHRpb24oYWN0dWFsLCBleHBlY3RlZCkge1xuICBpZiAoIWFjdHVhbCB8fCAhZXhwZWN0ZWQpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGV4cGVjdGVkKSA9PSAnW29iamVjdCBSZWdFeHBdJykge1xuICAgIHJldHVybiBleHBlY3RlZC50ZXN0KGFjdHVhbCk7XG4gIH1cblxuICB0cnkge1xuICAgIGlmIChhY3R1YWwgaW5zdGFuY2VvZiBleHBlY3RlZCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gICAgLy8gSWdub3JlLiAgVGhlIGluc3RhbmNlb2YgY2hlY2sgZG9lc24ndCB3b3JrIGZvciBhcnJvdyBmdW5jdGlvbnMuXG4gIH1cblxuICBpZiAoRXJyb3IuaXNQcm90b3R5cGVPZihleHBlY3RlZCkpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICByZXR1cm4gZXhwZWN0ZWQuY2FsbCh7fSwgYWN0dWFsKSA9PT0gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gX3RyeUJsb2NrKGJsb2NrKSB7XG4gIHZhciBlcnJvcjtcbiAgdHJ5IHtcbiAgICBibG9jaygpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgZXJyb3IgPSBlO1xuICB9XG4gIHJldHVybiBlcnJvcjtcbn1cblxuZnVuY3Rpb24gX3Rocm93cyhzaG91bGRUaHJvdywgYmxvY2ssIGV4cGVjdGVkLCBtZXNzYWdlKSB7XG4gIHZhciBhY3R1YWw7XG5cbiAgaWYgKHR5cGVvZiBibG9jayAhPT0gJ2Z1bmN0aW9uJykge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wiYmxvY2tcIiBhcmd1bWVudCBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcbiAgfVxuXG4gIGlmICh0eXBlb2YgZXhwZWN0ZWQgPT09ICdzdHJpbmcnKSB7XG4gICAgbWVzc2FnZSA9IGV4cGVjdGVkO1xuICAgIGV4cGVjdGVkID0gbnVsbDtcbiAgfVxuXG4gIGFjdHVhbCA9IF90cnlCbG9jayhibG9jayk7XG5cbiAgbWVzc2FnZSA9IChleHBlY3RlZCAmJiBleHBlY3RlZC5uYW1lID8gJyAoJyArIGV4cGVjdGVkLm5hbWUgKyAnKS4nIDogJy4nKSArXG4gICAgICAgICAgICAobWVzc2FnZSA/ICcgJyArIG1lc3NhZ2UgOiAnLicpO1xuXG4gIGlmIChzaG91bGRUaHJvdyAmJiAhYWN0dWFsKSB7XG4gICAgZmFpbChhY3R1YWwsIGV4cGVjdGVkLCAnTWlzc2luZyBleHBlY3RlZCBleGNlcHRpb24nICsgbWVzc2FnZSk7XG4gIH1cblxuICB2YXIgdXNlclByb3ZpZGVkTWVzc2FnZSA9IHR5cGVvZiBtZXNzYWdlID09PSAnc3RyaW5nJztcbiAgdmFyIGlzVW53YW50ZWRFeGNlcHRpb24gPSAhc2hvdWxkVGhyb3cgJiYgdXRpbC5pc0Vycm9yKGFjdHVhbCk7XG4gIHZhciBpc1VuZXhwZWN0ZWRFeGNlcHRpb24gPSAhc2hvdWxkVGhyb3cgJiYgYWN0dWFsICYmICFleHBlY3RlZDtcblxuICBpZiAoKGlzVW53YW50ZWRFeGNlcHRpb24gJiZcbiAgICAgIHVzZXJQcm92aWRlZE1lc3NhZ2UgJiZcbiAgICAgIGV4cGVjdGVkRXhjZXB0aW9uKGFjdHVhbCwgZXhwZWN0ZWQpKSB8fFxuICAgICAgaXNVbmV4cGVjdGVkRXhjZXB0aW9uKSB7XG4gICAgZmFpbChhY3R1YWwsIGV4cGVjdGVkLCAnR290IHVud2FudGVkIGV4Y2VwdGlvbicgKyBtZXNzYWdlKTtcbiAgfVxuXG4gIGlmICgoc2hvdWxkVGhyb3cgJiYgYWN0dWFsICYmIGV4cGVjdGVkICYmXG4gICAgICAhZXhwZWN0ZWRFeGNlcHRpb24oYWN0dWFsLCBleHBlY3RlZCkpIHx8ICghc2hvdWxkVGhyb3cgJiYgYWN0dWFsKSkge1xuICAgIHRocm93IGFjdHVhbDtcbiAgfVxufVxuXG4vLyAxMS4gRXhwZWN0ZWQgdG8gdGhyb3cgYW4gZXJyb3I6XG4vLyBhc3NlcnQudGhyb3dzKGJsb2NrLCBFcnJvcl9vcHQsIG1lc3NhZ2Vfb3B0KTtcblxuYXNzZXJ0LnRocm93cyA9IGZ1bmN0aW9uKGJsb2NrLCAvKm9wdGlvbmFsKi9lcnJvciwgLypvcHRpb25hbCovbWVzc2FnZSkge1xuICBfdGhyb3dzKHRydWUsIGJsb2NrLCBlcnJvciwgbWVzc2FnZSk7XG59O1xuXG4vLyBFWFRFTlNJT04hIFRoaXMgaXMgYW5ub3lpbmcgdG8gd3JpdGUgb3V0c2lkZSB0aGlzIG1vZHVsZS5cbmFzc2VydC5kb2VzTm90VGhyb3cgPSBmdW5jdGlvbihibG9jaywgLypvcHRpb25hbCovZXJyb3IsIC8qb3B0aW9uYWwqL21lc3NhZ2UpIHtcbiAgX3Rocm93cyhmYWxzZSwgYmxvY2ssIGVycm9yLCBtZXNzYWdlKTtcbn07XG5cbmFzc2VydC5pZkVycm9yID0gZnVuY3Rpb24oZXJyKSB7IGlmIChlcnIpIHRocm93IGVycjsgfTtcblxudmFyIG9iamVjdEtleXMgPSBPYmplY3Qua2V5cyB8fCBmdW5jdGlvbiAob2JqKSB7XG4gIHZhciBrZXlzID0gW107XG4gIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICBpZiAoaGFzT3duLmNhbGwob2JqLCBrZXkpKSBrZXlzLnB1c2goa2V5KTtcbiAgfVxuICByZXR1cm4ga2V5cztcbn07XG4iLCJpZiAodHlwZW9mIE9iamVjdC5jcmVhdGUgPT09ICdmdW5jdGlvbicpIHtcbiAgLy8gaW1wbGVtZW50YXRpb24gZnJvbSBzdGFuZGFyZCBub2RlLmpzICd1dGlsJyBtb2R1bGVcbiAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBpbmhlcml0cyhjdG9yLCBzdXBlckN0b3IpIHtcbiAgICBjdG9yLnN1cGVyXyA9IHN1cGVyQ3RvclxuICAgIGN0b3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckN0b3IucHJvdG90eXBlLCB7XG4gICAgICBjb25zdHJ1Y3Rvcjoge1xuICAgICAgICB2YWx1ZTogY3RvcixcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcbn0gZWxzZSB7XG4gIC8vIG9sZCBzY2hvb2wgc2hpbSBmb3Igb2xkIGJyb3dzZXJzXG4gIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gaW5oZXJpdHMoY3Rvciwgc3VwZXJDdG9yKSB7XG4gICAgY3Rvci5zdXBlcl8gPSBzdXBlckN0b3JcbiAgICB2YXIgVGVtcEN0b3IgPSBmdW5jdGlvbiAoKSB7fVxuICAgIFRlbXBDdG9yLnByb3RvdHlwZSA9IHN1cGVyQ3Rvci5wcm90b3R5cGVcbiAgICBjdG9yLnByb3RvdHlwZSA9IG5ldyBUZW1wQ3RvcigpXG4gICAgY3Rvci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBjdG9yXG4gIH1cbn1cbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gaXNCdWZmZXIoYXJnKSB7XG4gIHJldHVybiBhcmcgJiYgdHlwZW9mIGFyZyA9PT0gJ29iamVjdCdcbiAgICAmJiB0eXBlb2YgYXJnLmNvcHkgPT09ICdmdW5jdGlvbidcbiAgICAmJiB0eXBlb2YgYXJnLmZpbGwgPT09ICdmdW5jdGlvbidcbiAgICAmJiB0eXBlb2YgYXJnLnJlYWRVSW50OCA9PT0gJ2Z1bmN0aW9uJztcbn0iLCIvLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy5cbi8vXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYVxuLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZVxuLy8gXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nXG4vLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsXG4vLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0XG4vLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGVcbi8vIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkXG4vLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTXG4vLyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GXG4vLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOXG4vLyBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUlxuLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRVxuLy8gVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxudmFyIGZvcm1hdFJlZ0V4cCA9IC8lW3NkaiVdL2c7XG5leHBvcnRzLmZvcm1hdCA9IGZ1bmN0aW9uKGYpIHtcbiAgaWYgKCFpc1N0cmluZyhmKSkge1xuICAgIHZhciBvYmplY3RzID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIG9iamVjdHMucHVzaChpbnNwZWN0KGFyZ3VtZW50c1tpXSkpO1xuICAgIH1cbiAgICByZXR1cm4gb2JqZWN0cy5qb2luKCcgJyk7XG4gIH1cblxuICB2YXIgaSA9IDE7XG4gIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICB2YXIgbGVuID0gYXJncy5sZW5ndGg7XG4gIHZhciBzdHIgPSBTdHJpbmcoZikucmVwbGFjZShmb3JtYXRSZWdFeHAsIGZ1bmN0aW9uKHgpIHtcbiAgICBpZiAoeCA9PT0gJyUlJykgcmV0dXJuICclJztcbiAgICBpZiAoaSA+PSBsZW4pIHJldHVybiB4O1xuICAgIHN3aXRjaCAoeCkge1xuICAgICAgY2FzZSAnJXMnOiByZXR1cm4gU3RyaW5nKGFyZ3NbaSsrXSk7XG4gICAgICBjYXNlICclZCc6IHJldHVybiBOdW1iZXIoYXJnc1tpKytdKTtcbiAgICAgIGNhc2UgJyVqJzpcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoYXJnc1tpKytdKTtcbiAgICAgICAgfSBjYXRjaCAoXykge1xuICAgICAgICAgIHJldHVybiAnW0NpcmN1bGFyXSc7XG4gICAgICAgIH1cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiB4O1xuICAgIH1cbiAgfSk7XG4gIGZvciAodmFyIHggPSBhcmdzW2ldOyBpIDwgbGVuOyB4ID0gYXJnc1srK2ldKSB7XG4gICAgaWYgKGlzTnVsbCh4KSB8fCAhaXNPYmplY3QoeCkpIHtcbiAgICAgIHN0ciArPSAnICcgKyB4O1xuICAgIH0gZWxzZSB7XG4gICAgICBzdHIgKz0gJyAnICsgaW5zcGVjdCh4KTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHN0cjtcbn07XG5cblxuLy8gTWFyayB0aGF0IGEgbWV0aG9kIHNob3VsZCBub3QgYmUgdXNlZC5cbi8vIFJldHVybnMgYSBtb2RpZmllZCBmdW5jdGlvbiB3aGljaCB3YXJucyBvbmNlIGJ5IGRlZmF1bHQuXG4vLyBJZiAtLW5vLWRlcHJlY2F0aW9uIGlzIHNldCwgdGhlbiBpdCBpcyBhIG5vLW9wLlxuZXhwb3J0cy5kZXByZWNhdGUgPSBmdW5jdGlvbihmbiwgbXNnKSB7XG4gIC8vIEFsbG93IGZvciBkZXByZWNhdGluZyB0aGluZ3MgaW4gdGhlIHByb2Nlc3Mgb2Ygc3RhcnRpbmcgdXAuXG4gIGlmIChpc1VuZGVmaW5lZChnbG9iYWwucHJvY2VzcykpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZXhwb3J0cy5kZXByZWNhdGUoZm4sIG1zZykuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9XG5cbiAgaWYgKHByb2Nlc3Mubm9EZXByZWNhdGlvbiA9PT0gdHJ1ZSkge1xuICAgIHJldHVybiBmbjtcbiAgfVxuXG4gIHZhciB3YXJuZWQgPSBmYWxzZTtcbiAgZnVuY3Rpb24gZGVwcmVjYXRlZCgpIHtcbiAgICBpZiAoIXdhcm5lZCkge1xuICAgICAgaWYgKHByb2Nlc3MudGhyb3dEZXByZWNhdGlvbikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IobXNnKTtcbiAgICAgIH0gZWxzZSBpZiAocHJvY2Vzcy50cmFjZURlcHJlY2F0aW9uKSB7XG4gICAgICAgIGNvbnNvbGUudHJhY2UobXNnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IobXNnKTtcbiAgICAgIH1cbiAgICAgIHdhcm5lZCA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9XG5cbiAgcmV0dXJuIGRlcHJlY2F0ZWQ7XG59O1xuXG5cbnZhciBkZWJ1Z3MgPSB7fTtcbnZhciBkZWJ1Z0Vudmlyb247XG5leHBvcnRzLmRlYnVnbG9nID0gZnVuY3Rpb24oc2V0KSB7XG4gIGlmIChpc1VuZGVmaW5lZChkZWJ1Z0Vudmlyb24pKVxuICAgIGRlYnVnRW52aXJvbiA9IHByb2Nlc3MuZW52Lk5PREVfREVCVUcgfHwgJyc7XG4gIHNldCA9IHNldC50b1VwcGVyQ2FzZSgpO1xuICBpZiAoIWRlYnVnc1tzZXRdKSB7XG4gICAgaWYgKG5ldyBSZWdFeHAoJ1xcXFxiJyArIHNldCArICdcXFxcYicsICdpJykudGVzdChkZWJ1Z0Vudmlyb24pKSB7XG4gICAgICB2YXIgcGlkID0gcHJvY2Vzcy5waWQ7XG4gICAgICBkZWJ1Z3Nbc2V0XSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgbXNnID0gZXhwb3J0cy5mb3JtYXQuYXBwbHkoZXhwb3J0cywgYXJndW1lbnRzKTtcbiAgICAgICAgY29uc29sZS5lcnJvcignJXMgJWQ6ICVzJywgc2V0LCBwaWQsIG1zZyk7XG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICBkZWJ1Z3Nbc2V0XSA9IGZ1bmN0aW9uKCkge307XG4gICAgfVxuICB9XG4gIHJldHVybiBkZWJ1Z3Nbc2V0XTtcbn07XG5cblxuLyoqXG4gKiBFY2hvcyB0aGUgdmFsdWUgb2YgYSB2YWx1ZS4gVHJ5cyB0byBwcmludCB0aGUgdmFsdWUgb3V0XG4gKiBpbiB0aGUgYmVzdCB3YXkgcG9zc2libGUgZ2l2ZW4gdGhlIGRpZmZlcmVudCB0eXBlcy5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3QgdG8gcHJpbnQgb3V0LlxuICogQHBhcmFtIHtPYmplY3R9IG9wdHMgT3B0aW9uYWwgb3B0aW9ucyBvYmplY3QgdGhhdCBhbHRlcnMgdGhlIG91dHB1dC5cbiAqL1xuLyogbGVnYWN5OiBvYmosIHNob3dIaWRkZW4sIGRlcHRoLCBjb2xvcnMqL1xuZnVuY3Rpb24gaW5zcGVjdChvYmosIG9wdHMpIHtcbiAgLy8gZGVmYXVsdCBvcHRpb25zXG4gIHZhciBjdHggPSB7XG4gICAgc2VlbjogW10sXG4gICAgc3R5bGl6ZTogc3R5bGl6ZU5vQ29sb3JcbiAgfTtcbiAgLy8gbGVnYWN5Li4uXG4gIGlmIChhcmd1bWVudHMubGVuZ3RoID49IDMpIGN0eC5kZXB0aCA9IGFyZ3VtZW50c1syXTtcbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPj0gNCkgY3R4LmNvbG9ycyA9IGFyZ3VtZW50c1szXTtcbiAgaWYgKGlzQm9vbGVhbihvcHRzKSkge1xuICAgIC8vIGxlZ2FjeS4uLlxuICAgIGN0eC5zaG93SGlkZGVuID0gb3B0cztcbiAgfSBlbHNlIGlmIChvcHRzKSB7XG4gICAgLy8gZ290IGFuIFwib3B0aW9uc1wiIG9iamVjdFxuICAgIGV4cG9ydHMuX2V4dGVuZChjdHgsIG9wdHMpO1xuICB9XG4gIC8vIHNldCBkZWZhdWx0IG9wdGlvbnNcbiAgaWYgKGlzVW5kZWZpbmVkKGN0eC5zaG93SGlkZGVuKSkgY3R4LnNob3dIaWRkZW4gPSBmYWxzZTtcbiAgaWYgKGlzVW5kZWZpbmVkKGN0eC5kZXB0aCkpIGN0eC5kZXB0aCA9IDI7XG4gIGlmIChpc1VuZGVmaW5lZChjdHguY29sb3JzKSkgY3R4LmNvbG9ycyA9IGZhbHNlO1xuICBpZiAoaXNVbmRlZmluZWQoY3R4LmN1c3RvbUluc3BlY3QpKSBjdHguY3VzdG9tSW5zcGVjdCA9IHRydWU7XG4gIGlmIChjdHguY29sb3JzKSBjdHguc3R5bGl6ZSA9IHN0eWxpemVXaXRoQ29sb3I7XG4gIHJldHVybiBmb3JtYXRWYWx1ZShjdHgsIG9iaiwgY3R4LmRlcHRoKTtcbn1cbmV4cG9ydHMuaW5zcGVjdCA9IGluc3BlY3Q7XG5cblxuLy8gaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9BTlNJX2VzY2FwZV9jb2RlI2dyYXBoaWNzXG5pbnNwZWN0LmNvbG9ycyA9IHtcbiAgJ2JvbGQnIDogWzEsIDIyXSxcbiAgJ2l0YWxpYycgOiBbMywgMjNdLFxuICAndW5kZXJsaW5lJyA6IFs0LCAyNF0sXG4gICdpbnZlcnNlJyA6IFs3LCAyN10sXG4gICd3aGl0ZScgOiBbMzcsIDM5XSxcbiAgJ2dyZXknIDogWzkwLCAzOV0sXG4gICdibGFjaycgOiBbMzAsIDM5XSxcbiAgJ2JsdWUnIDogWzM0LCAzOV0sXG4gICdjeWFuJyA6IFszNiwgMzldLFxuICAnZ3JlZW4nIDogWzMyLCAzOV0sXG4gICdtYWdlbnRhJyA6IFszNSwgMzldLFxuICAncmVkJyA6IFszMSwgMzldLFxuICAneWVsbG93JyA6IFszMywgMzldXG59O1xuXG4vLyBEb24ndCB1c2UgJ2JsdWUnIG5vdCB2aXNpYmxlIG9uIGNtZC5leGVcbmluc3BlY3Quc3R5bGVzID0ge1xuICAnc3BlY2lhbCc6ICdjeWFuJyxcbiAgJ251bWJlcic6ICd5ZWxsb3cnLFxuICAnYm9vbGVhbic6ICd5ZWxsb3cnLFxuICAndW5kZWZpbmVkJzogJ2dyZXknLFxuICAnbnVsbCc6ICdib2xkJyxcbiAgJ3N0cmluZyc6ICdncmVlbicsXG4gICdkYXRlJzogJ21hZ2VudGEnLFxuICAvLyBcIm5hbWVcIjogaW50ZW50aW9uYWxseSBub3Qgc3R5bGluZ1xuICAncmVnZXhwJzogJ3JlZCdcbn07XG5cblxuZnVuY3Rpb24gc3R5bGl6ZVdpdGhDb2xvcihzdHIsIHN0eWxlVHlwZSkge1xuICB2YXIgc3R5bGUgPSBpbnNwZWN0LnN0eWxlc1tzdHlsZVR5cGVdO1xuXG4gIGlmIChzdHlsZSkge1xuICAgIHJldHVybiAnXFx1MDAxYlsnICsgaW5zcGVjdC5jb2xvcnNbc3R5bGVdWzBdICsgJ20nICsgc3RyICtcbiAgICAgICAgICAgJ1xcdTAwMWJbJyArIGluc3BlY3QuY29sb3JzW3N0eWxlXVsxXSArICdtJztcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gc3RyO1xuICB9XG59XG5cblxuZnVuY3Rpb24gc3R5bGl6ZU5vQ29sb3Ioc3RyLCBzdHlsZVR5cGUpIHtcbiAgcmV0dXJuIHN0cjtcbn1cblxuXG5mdW5jdGlvbiBhcnJheVRvSGFzaChhcnJheSkge1xuICB2YXIgaGFzaCA9IHt9O1xuXG4gIGFycmF5LmZvckVhY2goZnVuY3Rpb24odmFsLCBpZHgpIHtcbiAgICBoYXNoW3ZhbF0gPSB0cnVlO1xuICB9KTtcblxuICByZXR1cm4gaGFzaDtcbn1cblxuXG5mdW5jdGlvbiBmb3JtYXRWYWx1ZShjdHgsIHZhbHVlLCByZWN1cnNlVGltZXMpIHtcbiAgLy8gUHJvdmlkZSBhIGhvb2sgZm9yIHVzZXItc3BlY2lmaWVkIGluc3BlY3QgZnVuY3Rpb25zLlxuICAvLyBDaGVjayB0aGF0IHZhbHVlIGlzIGFuIG9iamVjdCB3aXRoIGFuIGluc3BlY3QgZnVuY3Rpb24gb24gaXRcbiAgaWYgKGN0eC5jdXN0b21JbnNwZWN0ICYmXG4gICAgICB2YWx1ZSAmJlxuICAgICAgaXNGdW5jdGlvbih2YWx1ZS5pbnNwZWN0KSAmJlxuICAgICAgLy8gRmlsdGVyIG91dCB0aGUgdXRpbCBtb2R1bGUsIGl0J3MgaW5zcGVjdCBmdW5jdGlvbiBpcyBzcGVjaWFsXG4gICAgICB2YWx1ZS5pbnNwZWN0ICE9PSBleHBvcnRzLmluc3BlY3QgJiZcbiAgICAgIC8vIEFsc28gZmlsdGVyIG91dCBhbnkgcHJvdG90eXBlIG9iamVjdHMgdXNpbmcgdGhlIGNpcmN1bGFyIGNoZWNrLlxuICAgICAgISh2YWx1ZS5jb25zdHJ1Y3RvciAmJiB2YWx1ZS5jb25zdHJ1Y3Rvci5wcm90b3R5cGUgPT09IHZhbHVlKSkge1xuICAgIHZhciByZXQgPSB2YWx1ZS5pbnNwZWN0KHJlY3Vyc2VUaW1lcywgY3R4KTtcbiAgICBpZiAoIWlzU3RyaW5nKHJldCkpIHtcbiAgICAgIHJldCA9IGZvcm1hdFZhbHVlKGN0eCwgcmV0LCByZWN1cnNlVGltZXMpO1xuICAgIH1cbiAgICByZXR1cm4gcmV0O1xuICB9XG5cbiAgLy8gUHJpbWl0aXZlIHR5cGVzIGNhbm5vdCBoYXZlIHByb3BlcnRpZXNcbiAgdmFyIHByaW1pdGl2ZSA9IGZvcm1hdFByaW1pdGl2ZShjdHgsIHZhbHVlKTtcbiAgaWYgKHByaW1pdGl2ZSkge1xuICAgIHJldHVybiBwcmltaXRpdmU7XG4gIH1cblxuICAvLyBMb29rIHVwIHRoZSBrZXlzIG9mIHRoZSBvYmplY3QuXG4gIHZhciBrZXlzID0gT2JqZWN0LmtleXModmFsdWUpO1xuICB2YXIgdmlzaWJsZUtleXMgPSBhcnJheVRvSGFzaChrZXlzKTtcblxuICBpZiAoY3R4LnNob3dIaWRkZW4pIHtcbiAgICBrZXlzID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModmFsdWUpO1xuICB9XG5cbiAgLy8gSUUgZG9lc24ndCBtYWtlIGVycm9yIGZpZWxkcyBub24tZW51bWVyYWJsZVxuICAvLyBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvaWUvZHd3NTJzYnQodj12cy45NCkuYXNweFxuICBpZiAoaXNFcnJvcih2YWx1ZSlcbiAgICAgICYmIChrZXlzLmluZGV4T2YoJ21lc3NhZ2UnKSA+PSAwIHx8IGtleXMuaW5kZXhPZignZGVzY3JpcHRpb24nKSA+PSAwKSkge1xuICAgIHJldHVybiBmb3JtYXRFcnJvcih2YWx1ZSk7XG4gIH1cblxuICAvLyBTb21lIHR5cGUgb2Ygb2JqZWN0IHdpdGhvdXQgcHJvcGVydGllcyBjYW4gYmUgc2hvcnRjdXR0ZWQuXG4gIGlmIChrZXlzLmxlbmd0aCA9PT0gMCkge1xuICAgIGlmIChpc0Z1bmN0aW9uKHZhbHVlKSkge1xuICAgICAgdmFyIG5hbWUgPSB2YWx1ZS5uYW1lID8gJzogJyArIHZhbHVlLm5hbWUgOiAnJztcbiAgICAgIHJldHVybiBjdHguc3R5bGl6ZSgnW0Z1bmN0aW9uJyArIG5hbWUgKyAnXScsICdzcGVjaWFsJyk7XG4gICAgfVxuICAgIGlmIChpc1JlZ0V4cCh2YWx1ZSkpIHtcbiAgICAgIHJldHVybiBjdHguc3R5bGl6ZShSZWdFeHAucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodmFsdWUpLCAncmVnZXhwJyk7XG4gICAgfVxuICAgIGlmIChpc0RhdGUodmFsdWUpKSB7XG4gICAgICByZXR1cm4gY3R4LnN0eWxpemUoRGF0ZS5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh2YWx1ZSksICdkYXRlJyk7XG4gICAgfVxuICAgIGlmIChpc0Vycm9yKHZhbHVlKSkge1xuICAgICAgcmV0dXJuIGZvcm1hdEVycm9yKHZhbHVlKTtcbiAgICB9XG4gIH1cblxuICB2YXIgYmFzZSA9ICcnLCBhcnJheSA9IGZhbHNlLCBicmFjZXMgPSBbJ3snLCAnfSddO1xuXG4gIC8vIE1ha2UgQXJyYXkgc2F5IHRoYXQgdGhleSBhcmUgQXJyYXlcbiAgaWYgKGlzQXJyYXkodmFsdWUpKSB7XG4gICAgYXJyYXkgPSB0cnVlO1xuICAgIGJyYWNlcyA9IFsnWycsICddJ107XG4gIH1cblxuICAvLyBNYWtlIGZ1bmN0aW9ucyBzYXkgdGhhdCB0aGV5IGFyZSBmdW5jdGlvbnNcbiAgaWYgKGlzRnVuY3Rpb24odmFsdWUpKSB7XG4gICAgdmFyIG4gPSB2YWx1ZS5uYW1lID8gJzogJyArIHZhbHVlLm5hbWUgOiAnJztcbiAgICBiYXNlID0gJyBbRnVuY3Rpb24nICsgbiArICddJztcbiAgfVxuXG4gIC8vIE1ha2UgUmVnRXhwcyBzYXkgdGhhdCB0aGV5IGFyZSBSZWdFeHBzXG4gIGlmIChpc1JlZ0V4cCh2YWx1ZSkpIHtcbiAgICBiYXNlID0gJyAnICsgUmVnRXhwLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbHVlKTtcbiAgfVxuXG4gIC8vIE1ha2UgZGF0ZXMgd2l0aCBwcm9wZXJ0aWVzIGZpcnN0IHNheSB0aGUgZGF0ZVxuICBpZiAoaXNEYXRlKHZhbHVlKSkge1xuICAgIGJhc2UgPSAnICcgKyBEYXRlLnByb3RvdHlwZS50b1VUQ1N0cmluZy5jYWxsKHZhbHVlKTtcbiAgfVxuXG4gIC8vIE1ha2UgZXJyb3Igd2l0aCBtZXNzYWdlIGZpcnN0IHNheSB0aGUgZXJyb3JcbiAgaWYgKGlzRXJyb3IodmFsdWUpKSB7XG4gICAgYmFzZSA9ICcgJyArIGZvcm1hdEVycm9yKHZhbHVlKTtcbiAgfVxuXG4gIGlmIChrZXlzLmxlbmd0aCA9PT0gMCAmJiAoIWFycmF5IHx8IHZhbHVlLmxlbmd0aCA9PSAwKSkge1xuICAgIHJldHVybiBicmFjZXNbMF0gKyBiYXNlICsgYnJhY2VzWzFdO1xuICB9XG5cbiAgaWYgKHJlY3Vyc2VUaW1lcyA8IDApIHtcbiAgICBpZiAoaXNSZWdFeHAodmFsdWUpKSB7XG4gICAgICByZXR1cm4gY3R4LnN0eWxpemUoUmVnRXhwLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbHVlKSwgJ3JlZ2V4cCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gY3R4LnN0eWxpemUoJ1tPYmplY3RdJywgJ3NwZWNpYWwnKTtcbiAgICB9XG4gIH1cblxuICBjdHguc2Vlbi5wdXNoKHZhbHVlKTtcblxuICB2YXIgb3V0cHV0O1xuICBpZiAoYXJyYXkpIHtcbiAgICBvdXRwdXQgPSBmb3JtYXRBcnJheShjdHgsIHZhbHVlLCByZWN1cnNlVGltZXMsIHZpc2libGVLZXlzLCBrZXlzKTtcbiAgfSBlbHNlIHtcbiAgICBvdXRwdXQgPSBrZXlzLm1hcChmdW5jdGlvbihrZXkpIHtcbiAgICAgIHJldHVybiBmb3JtYXRQcm9wZXJ0eShjdHgsIHZhbHVlLCByZWN1cnNlVGltZXMsIHZpc2libGVLZXlzLCBrZXksIGFycmF5KTtcbiAgICB9KTtcbiAgfVxuXG4gIGN0eC5zZWVuLnBvcCgpO1xuXG4gIHJldHVybiByZWR1Y2VUb1NpbmdsZVN0cmluZyhvdXRwdXQsIGJhc2UsIGJyYWNlcyk7XG59XG5cblxuZnVuY3Rpb24gZm9ybWF0UHJpbWl0aXZlKGN0eCwgdmFsdWUpIHtcbiAgaWYgKGlzVW5kZWZpbmVkKHZhbHVlKSlcbiAgICByZXR1cm4gY3R4LnN0eWxpemUoJ3VuZGVmaW5lZCcsICd1bmRlZmluZWQnKTtcbiAgaWYgKGlzU3RyaW5nKHZhbHVlKSkge1xuICAgIHZhciBzaW1wbGUgPSAnXFwnJyArIEpTT04uc3RyaW5naWZ5KHZhbHVlKS5yZXBsYWNlKC9eXCJ8XCIkL2csICcnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLycvZywgXCJcXFxcJ1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcXFxcIi9nLCAnXCInKSArICdcXCcnO1xuICAgIHJldHVybiBjdHguc3R5bGl6ZShzaW1wbGUsICdzdHJpbmcnKTtcbiAgfVxuICBpZiAoaXNOdW1iZXIodmFsdWUpKVxuICAgIHJldHVybiBjdHguc3R5bGl6ZSgnJyArIHZhbHVlLCAnbnVtYmVyJyk7XG4gIGlmIChpc0Jvb2xlYW4odmFsdWUpKVxuICAgIHJldHVybiBjdHguc3R5bGl6ZSgnJyArIHZhbHVlLCAnYm9vbGVhbicpO1xuICAvLyBGb3Igc29tZSByZWFzb24gdHlwZW9mIG51bGwgaXMgXCJvYmplY3RcIiwgc28gc3BlY2lhbCBjYXNlIGhlcmUuXG4gIGlmIChpc051bGwodmFsdWUpKVxuICAgIHJldHVybiBjdHguc3R5bGl6ZSgnbnVsbCcsICdudWxsJyk7XG59XG5cblxuZnVuY3Rpb24gZm9ybWF0RXJyb3IodmFsdWUpIHtcbiAgcmV0dXJuICdbJyArIEVycm9yLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbHVlKSArICddJztcbn1cblxuXG5mdW5jdGlvbiBmb3JtYXRBcnJheShjdHgsIHZhbHVlLCByZWN1cnNlVGltZXMsIHZpc2libGVLZXlzLCBrZXlzKSB7XG4gIHZhciBvdXRwdXQgPSBbXTtcbiAgZm9yICh2YXIgaSA9IDAsIGwgPSB2YWx1ZS5sZW5ndGg7IGkgPCBsOyArK2kpIHtcbiAgICBpZiAoaGFzT3duUHJvcGVydHkodmFsdWUsIFN0cmluZyhpKSkpIHtcbiAgICAgIG91dHB1dC5wdXNoKGZvcm1hdFByb3BlcnR5KGN0eCwgdmFsdWUsIHJlY3Vyc2VUaW1lcywgdmlzaWJsZUtleXMsXG4gICAgICAgICAgU3RyaW5nKGkpLCB0cnVlKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG91dHB1dC5wdXNoKCcnKTtcbiAgICB9XG4gIH1cbiAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xuICAgIGlmICgha2V5Lm1hdGNoKC9eXFxkKyQvKSkge1xuICAgICAgb3V0cHV0LnB1c2goZm9ybWF0UHJvcGVydHkoY3R4LCB2YWx1ZSwgcmVjdXJzZVRpbWVzLCB2aXNpYmxlS2V5cyxcbiAgICAgICAgICBrZXksIHRydWUpKTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gb3V0cHV0O1xufVxuXG5cbmZ1bmN0aW9uIGZvcm1hdFByb3BlcnR5KGN0eCwgdmFsdWUsIHJlY3Vyc2VUaW1lcywgdmlzaWJsZUtleXMsIGtleSwgYXJyYXkpIHtcbiAgdmFyIG5hbWUsIHN0ciwgZGVzYztcbiAgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodmFsdWUsIGtleSkgfHwgeyB2YWx1ZTogdmFsdWVba2V5XSB9O1xuICBpZiAoZGVzYy5nZXQpIHtcbiAgICBpZiAoZGVzYy5zZXQpIHtcbiAgICAgIHN0ciA9IGN0eC5zdHlsaXplKCdbR2V0dGVyL1NldHRlcl0nLCAnc3BlY2lhbCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdHIgPSBjdHguc3R5bGl6ZSgnW0dldHRlcl0nLCAnc3BlY2lhbCcpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBpZiAoZGVzYy5zZXQpIHtcbiAgICAgIHN0ciA9IGN0eC5zdHlsaXplKCdbU2V0dGVyXScsICdzcGVjaWFsJyk7XG4gICAgfVxuICB9XG4gIGlmICghaGFzT3duUHJvcGVydHkodmlzaWJsZUtleXMsIGtleSkpIHtcbiAgICBuYW1lID0gJ1snICsga2V5ICsgJ10nO1xuICB9XG4gIGlmICghc3RyKSB7XG4gICAgaWYgKGN0eC5zZWVuLmluZGV4T2YoZGVzYy52YWx1ZSkgPCAwKSB7XG4gICAgICBpZiAoaXNOdWxsKHJlY3Vyc2VUaW1lcykpIHtcbiAgICAgICAgc3RyID0gZm9ybWF0VmFsdWUoY3R4LCBkZXNjLnZhbHVlLCBudWxsKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHN0ciA9IGZvcm1hdFZhbHVlKGN0eCwgZGVzYy52YWx1ZSwgcmVjdXJzZVRpbWVzIC0gMSk7XG4gICAgICB9XG4gICAgICBpZiAoc3RyLmluZGV4T2YoJ1xcbicpID4gLTEpIHtcbiAgICAgICAgaWYgKGFycmF5KSB7XG4gICAgICAgICAgc3RyID0gc3RyLnNwbGl0KCdcXG4nKS5tYXAoZnVuY3Rpb24obGluZSkge1xuICAgICAgICAgICAgcmV0dXJuICcgICcgKyBsaW5lO1xuICAgICAgICAgIH0pLmpvaW4oJ1xcbicpLnN1YnN0cigyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzdHIgPSAnXFxuJyArIHN0ci5zcGxpdCgnXFxuJykubWFwKGZ1bmN0aW9uKGxpbmUpIHtcbiAgICAgICAgICAgIHJldHVybiAnICAgJyArIGxpbmU7XG4gICAgICAgICAgfSkuam9pbignXFxuJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgc3RyID0gY3R4LnN0eWxpemUoJ1tDaXJjdWxhcl0nLCAnc3BlY2lhbCcpO1xuICAgIH1cbiAgfVxuICBpZiAoaXNVbmRlZmluZWQobmFtZSkpIHtcbiAgICBpZiAoYXJyYXkgJiYga2V5Lm1hdGNoKC9eXFxkKyQvKSkge1xuICAgICAgcmV0dXJuIHN0cjtcbiAgICB9XG4gICAgbmFtZSA9IEpTT04uc3RyaW5naWZ5KCcnICsga2V5KTtcbiAgICBpZiAobmFtZS5tYXRjaCgvXlwiKFthLXpBLVpfXVthLXpBLVpfMC05XSopXCIkLykpIHtcbiAgICAgIG5hbWUgPSBuYW1lLnN1YnN0cigxLCBuYW1lLmxlbmd0aCAtIDIpO1xuICAgICAgbmFtZSA9IGN0eC5zdHlsaXplKG5hbWUsICduYW1lJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoLycvZywgXCJcXFxcJ1wiKVxuICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFxcXFwiL2csICdcIicpXG4gICAgICAgICAgICAgICAgIC5yZXBsYWNlKC8oXlwifFwiJCkvZywgXCInXCIpO1xuICAgICAgbmFtZSA9IGN0eC5zdHlsaXplKG5hbWUsICdzdHJpbmcnKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbmFtZSArICc6ICcgKyBzdHI7XG59XG5cblxuZnVuY3Rpb24gcmVkdWNlVG9TaW5nbGVTdHJpbmcob3V0cHV0LCBiYXNlLCBicmFjZXMpIHtcbiAgdmFyIG51bUxpbmVzRXN0ID0gMDtcbiAgdmFyIGxlbmd0aCA9IG91dHB1dC5yZWR1Y2UoZnVuY3Rpb24ocHJldiwgY3VyKSB7XG4gICAgbnVtTGluZXNFc3QrKztcbiAgICBpZiAoY3VyLmluZGV4T2YoJ1xcbicpID49IDApIG51bUxpbmVzRXN0Kys7XG4gICAgcmV0dXJuIHByZXYgKyBjdXIucmVwbGFjZSgvXFx1MDAxYlxcW1xcZFxcZD9tL2csICcnKS5sZW5ndGggKyAxO1xuICB9LCAwKTtcblxuICBpZiAobGVuZ3RoID4gNjApIHtcbiAgICByZXR1cm4gYnJhY2VzWzBdICtcbiAgICAgICAgICAgKGJhc2UgPT09ICcnID8gJycgOiBiYXNlICsgJ1xcbiAnKSArXG4gICAgICAgICAgICcgJyArXG4gICAgICAgICAgIG91dHB1dC5qb2luKCcsXFxuICAnKSArXG4gICAgICAgICAgICcgJyArXG4gICAgICAgICAgIGJyYWNlc1sxXTtcbiAgfVxuXG4gIHJldHVybiBicmFjZXNbMF0gKyBiYXNlICsgJyAnICsgb3V0cHV0LmpvaW4oJywgJykgKyAnICcgKyBicmFjZXNbMV07XG59XG5cblxuLy8gTk9URTogVGhlc2UgdHlwZSBjaGVja2luZyBmdW5jdGlvbnMgaW50ZW50aW9uYWxseSBkb24ndCB1c2UgYGluc3RhbmNlb2ZgXG4vLyBiZWNhdXNlIGl0IGlzIGZyYWdpbGUgYW5kIGNhbiBiZSBlYXNpbHkgZmFrZWQgd2l0aCBgT2JqZWN0LmNyZWF0ZSgpYC5cbmZ1bmN0aW9uIGlzQXJyYXkoYXIpIHtcbiAgcmV0dXJuIEFycmF5LmlzQXJyYXkoYXIpO1xufVxuZXhwb3J0cy5pc0FycmF5ID0gaXNBcnJheTtcblxuZnVuY3Rpb24gaXNCb29sZWFuKGFyZykge1xuICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ2Jvb2xlYW4nO1xufVxuZXhwb3J0cy5pc0Jvb2xlYW4gPSBpc0Jvb2xlYW47XG5cbmZ1bmN0aW9uIGlzTnVsbChhcmcpIHtcbiAgcmV0dXJuIGFyZyA9PT0gbnVsbDtcbn1cbmV4cG9ydHMuaXNOdWxsID0gaXNOdWxsO1xuXG5mdW5jdGlvbiBpc051bGxPclVuZGVmaW5lZChhcmcpIHtcbiAgcmV0dXJuIGFyZyA9PSBudWxsO1xufVxuZXhwb3J0cy5pc051bGxPclVuZGVmaW5lZCA9IGlzTnVsbE9yVW5kZWZpbmVkO1xuXG5mdW5jdGlvbiBpc051bWJlcihhcmcpIHtcbiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdudW1iZXInO1xufVxuZXhwb3J0cy5pc051bWJlciA9IGlzTnVtYmVyO1xuXG5mdW5jdGlvbiBpc1N0cmluZyhhcmcpIHtcbiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdzdHJpbmcnO1xufVxuZXhwb3J0cy5pc1N0cmluZyA9IGlzU3RyaW5nO1xuXG5mdW5jdGlvbiBpc1N5bWJvbChhcmcpIHtcbiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdzeW1ib2wnO1xufVxuZXhwb3J0cy5pc1N5bWJvbCA9IGlzU3ltYm9sO1xuXG5mdW5jdGlvbiBpc1VuZGVmaW5lZChhcmcpIHtcbiAgcmV0dXJuIGFyZyA9PT0gdm9pZCAwO1xufVxuZXhwb3J0cy5pc1VuZGVmaW5lZCA9IGlzVW5kZWZpbmVkO1xuXG5mdW5jdGlvbiBpc1JlZ0V4cChyZSkge1xuICByZXR1cm4gaXNPYmplY3QocmUpICYmIG9iamVjdFRvU3RyaW5nKHJlKSA9PT0gJ1tvYmplY3QgUmVnRXhwXSc7XG59XG5leHBvcnRzLmlzUmVnRXhwID0gaXNSZWdFeHA7XG5cbmZ1bmN0aW9uIGlzT2JqZWN0KGFyZykge1xuICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ29iamVjdCcgJiYgYXJnICE9PSBudWxsO1xufVxuZXhwb3J0cy5pc09iamVjdCA9IGlzT2JqZWN0O1xuXG5mdW5jdGlvbiBpc0RhdGUoZCkge1xuICByZXR1cm4gaXNPYmplY3QoZCkgJiYgb2JqZWN0VG9TdHJpbmcoZCkgPT09ICdbb2JqZWN0IERhdGVdJztcbn1cbmV4cG9ydHMuaXNEYXRlID0gaXNEYXRlO1xuXG5mdW5jdGlvbiBpc0Vycm9yKGUpIHtcbiAgcmV0dXJuIGlzT2JqZWN0KGUpICYmXG4gICAgICAob2JqZWN0VG9TdHJpbmcoZSkgPT09ICdbb2JqZWN0IEVycm9yXScgfHwgZSBpbnN0YW5jZW9mIEVycm9yKTtcbn1cbmV4cG9ydHMuaXNFcnJvciA9IGlzRXJyb3I7XG5cbmZ1bmN0aW9uIGlzRnVuY3Rpb24oYXJnKSB7XG4gIHJldHVybiB0eXBlb2YgYXJnID09PSAnZnVuY3Rpb24nO1xufVxuZXhwb3J0cy5pc0Z1bmN0aW9uID0gaXNGdW5jdGlvbjtcblxuZnVuY3Rpb24gaXNQcmltaXRpdmUoYXJnKSB7XG4gIHJldHVybiBhcmcgPT09IG51bGwgfHxcbiAgICAgICAgIHR5cGVvZiBhcmcgPT09ICdib29sZWFuJyB8fFxuICAgICAgICAgdHlwZW9mIGFyZyA9PT0gJ251bWJlcicgfHxcbiAgICAgICAgIHR5cGVvZiBhcmcgPT09ICdzdHJpbmcnIHx8XG4gICAgICAgICB0eXBlb2YgYXJnID09PSAnc3ltYm9sJyB8fCAgLy8gRVM2IHN5bWJvbFxuICAgICAgICAgdHlwZW9mIGFyZyA9PT0gJ3VuZGVmaW5lZCc7XG59XG5leHBvcnRzLmlzUHJpbWl0aXZlID0gaXNQcmltaXRpdmU7XG5cbmV4cG9ydHMuaXNCdWZmZXIgPSByZXF1aXJlKCcuL3N1cHBvcnQvaXNCdWZmZXInKTtcblxuZnVuY3Rpb24gb2JqZWN0VG9TdHJpbmcobykge1xuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pO1xufVxuXG5cbmZ1bmN0aW9uIHBhZChuKSB7XG4gIHJldHVybiBuIDwgMTAgPyAnMCcgKyBuLnRvU3RyaW5nKDEwKSA6IG4udG9TdHJpbmcoMTApO1xufVxuXG5cbnZhciBtb250aHMgPSBbJ0phbicsICdGZWInLCAnTWFyJywgJ0FwcicsICdNYXknLCAnSnVuJywgJ0p1bCcsICdBdWcnLCAnU2VwJyxcbiAgICAgICAgICAgICAgJ09jdCcsICdOb3YnLCAnRGVjJ107XG5cbi8vIDI2IEZlYiAxNjoxOTozNFxuZnVuY3Rpb24gdGltZXN0YW1wKCkge1xuICB2YXIgZCA9IG5ldyBEYXRlKCk7XG4gIHZhciB0aW1lID0gW3BhZChkLmdldEhvdXJzKCkpLFxuICAgICAgICAgICAgICBwYWQoZC5nZXRNaW51dGVzKCkpLFxuICAgICAgICAgICAgICBwYWQoZC5nZXRTZWNvbmRzKCkpXS5qb2luKCc6Jyk7XG4gIHJldHVybiBbZC5nZXREYXRlKCksIG1vbnRoc1tkLmdldE1vbnRoKCldLCB0aW1lXS5qb2luKCcgJyk7XG59XG5cblxuLy8gbG9nIGlzIGp1c3QgYSB0aGluIHdyYXBwZXIgdG8gY29uc29sZS5sb2cgdGhhdCBwcmVwZW5kcyBhIHRpbWVzdGFtcFxuZXhwb3J0cy5sb2cgPSBmdW5jdGlvbigpIHtcbiAgY29uc29sZS5sb2coJyVzIC0gJXMnLCB0aW1lc3RhbXAoKSwgZXhwb3J0cy5mb3JtYXQuYXBwbHkoZXhwb3J0cywgYXJndW1lbnRzKSk7XG59O1xuXG5cbi8qKlxuICogSW5oZXJpdCB0aGUgcHJvdG90eXBlIG1ldGhvZHMgZnJvbSBvbmUgY29uc3RydWN0b3IgaW50byBhbm90aGVyLlxuICpcbiAqIFRoZSBGdW5jdGlvbi5wcm90b3R5cGUuaW5oZXJpdHMgZnJvbSBsYW5nLmpzIHJld3JpdHRlbiBhcyBhIHN0YW5kYWxvbmVcbiAqIGZ1bmN0aW9uIChub3Qgb24gRnVuY3Rpb24ucHJvdG90eXBlKS4gTk9URTogSWYgdGhpcyBmaWxlIGlzIHRvIGJlIGxvYWRlZFxuICogZHVyaW5nIGJvb3RzdHJhcHBpbmcgdGhpcyBmdW5jdGlvbiBuZWVkcyB0byBiZSByZXdyaXR0ZW4gdXNpbmcgc29tZSBuYXRpdmVcbiAqIGZ1bmN0aW9ucyBhcyBwcm90b3R5cGUgc2V0dXAgdXNpbmcgbm9ybWFsIEphdmFTY3JpcHQgZG9lcyBub3Qgd29yayBhc1xuICogZXhwZWN0ZWQgZHVyaW5nIGJvb3RzdHJhcHBpbmcgKHNlZSBtaXJyb3IuanMgaW4gcjExNDkwMykuXG4gKlxuICogQHBhcmFtIHtmdW5jdGlvbn0gY3RvciBDb25zdHJ1Y3RvciBmdW5jdGlvbiB3aGljaCBuZWVkcyB0byBpbmhlcml0IHRoZVxuICogICAgIHByb3RvdHlwZS5cbiAqIEBwYXJhbSB7ZnVuY3Rpb259IHN1cGVyQ3RvciBDb25zdHJ1Y3RvciBmdW5jdGlvbiB0byBpbmhlcml0IHByb3RvdHlwZSBmcm9tLlxuICovXG5leHBvcnRzLmluaGVyaXRzID0gcmVxdWlyZSgnaW5oZXJpdHMnKTtcblxuZXhwb3J0cy5fZXh0ZW5kID0gZnVuY3Rpb24ob3JpZ2luLCBhZGQpIHtcbiAgLy8gRG9uJ3QgZG8gYW55dGhpbmcgaWYgYWRkIGlzbid0IGFuIG9iamVjdFxuICBpZiAoIWFkZCB8fCAhaXNPYmplY3QoYWRkKSkgcmV0dXJuIG9yaWdpbjtcblxuICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGFkZCk7XG4gIHZhciBpID0ga2V5cy5sZW5ndGg7XG4gIHdoaWxlIChpLS0pIHtcbiAgICBvcmlnaW5ba2V5c1tpXV0gPSBhZGRba2V5c1tpXV07XG4gIH1cbiAgcmV0dXJuIG9yaWdpbjtcbn07XG5cbmZ1bmN0aW9uIGhhc093blByb3BlcnR5KG9iaiwgcHJvcCkge1xuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7XG59XG4iLCIvLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXJcbnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcblxuLy8gY2FjaGVkIGZyb20gd2hhdGV2ZXIgZ2xvYmFsIGlzIHByZXNlbnQgc28gdGhhdCB0ZXN0IHJ1bm5lcnMgdGhhdCBzdHViIGl0XG4vLyBkb24ndCBicmVhayB0aGluZ3MuICBCdXQgd2UgbmVlZCB0byB3cmFwIGl0IGluIGEgdHJ5IGNhdGNoIGluIGNhc2UgaXQgaXNcbi8vIHdyYXBwZWQgaW4gc3RyaWN0IG1vZGUgY29kZSB3aGljaCBkb2Vzbid0IGRlZmluZSBhbnkgZ2xvYmFscy4gIEl0J3MgaW5zaWRlIGFcbi8vIGZ1bmN0aW9uIGJlY2F1c2UgdHJ5L2NhdGNoZXMgZGVvcHRpbWl6ZSBpbiBjZXJ0YWluIGVuZ2luZXMuXG5cbnZhciBjYWNoZWRTZXRUaW1lb3V0O1xudmFyIGNhY2hlZENsZWFyVGltZW91dDtcblxuZnVuY3Rpb24gZGVmYXVsdFNldFRpbW91dCgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3NldFRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbmZ1bmN0aW9uIGRlZmF1bHRDbGVhclRpbWVvdXQgKCkge1xuICAgIHRocm93IG5ldyBFcnJvcignY2xlYXJUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG59XG4oZnVuY3Rpb24gKCkge1xuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2Ygc2V0VGltZW91dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2YgY2xlYXJUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgIH1cbn0gKCkpXG5mdW5jdGlvbiBydW5UaW1lb3V0KGZ1bikge1xuICAgIGlmIChjYWNoZWRTZXRUaW1lb3V0ID09PSBzZXRUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICAvLyBpZiBzZXRUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuICAgIGlmICgoY2FjaGVkU2V0VGltZW91dCA9PT0gZGVmYXVsdFNldFRpbW91dCB8fCAhY2FjaGVkU2V0VGltZW91dCkgJiYgc2V0VGltZW91dCkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dChmdW4sIDApO1xuICAgIH0gY2F0Y2goZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwobnVsbCwgZnVuLCAwKTtcbiAgICAgICAgfSBjYXRjaChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yXG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKHRoaXMsIGZ1biwgMCk7XG4gICAgICAgIH1cbiAgICB9XG5cblxufVxuZnVuY3Rpb24gcnVuQ2xlYXJUaW1lb3V0KG1hcmtlcikge1xuICAgIGlmIChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGNsZWFyVGltZW91dCkge1xuICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnNcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICAvLyBpZiBjbGVhclRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGRlZmF1bHRDbGVhclRpbWVvdXQgfHwgIWNhY2hlZENsZWFyVGltZW91dCkgJiYgY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCAgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbChudWxsLCBtYXJrZXIpO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yLlxuICAgICAgICAgICAgLy8gU29tZSB2ZXJzaW9ucyBvZiBJLkUuIGhhdmUgZGlmZmVyZW50IHJ1bGVzIGZvciBjbGVhclRpbWVvdXQgdnMgc2V0VGltZW91dFxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKHRoaXMsIG1hcmtlcik7XG4gICAgICAgIH1cbiAgICB9XG5cblxuXG59XG52YXIgcXVldWUgPSBbXTtcbnZhciBkcmFpbmluZyA9IGZhbHNlO1xudmFyIGN1cnJlbnRRdWV1ZTtcbnZhciBxdWV1ZUluZGV4ID0gLTE7XG5cbmZ1bmN0aW9uIGNsZWFuVXBOZXh0VGljaygpIHtcbiAgICBpZiAoIWRyYWluaW5nIHx8ICFjdXJyZW50UXVldWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7XG4gICAgICAgIHF1ZXVlID0gY3VycmVudFF1ZXVlLmNvbmNhdChxdWV1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgIH1cbiAgICBpZiAocXVldWUubGVuZ3RoKSB7XG4gICAgICAgIGRyYWluUXVldWUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYWluUXVldWUoKSB7XG4gICAgaWYgKGRyYWluaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHRpbWVvdXQgPSBydW5UaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7XG4gICAgZHJhaW5pbmcgPSB0cnVlO1xuXG4gICAgdmFyIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB3aGlsZShsZW4pIHtcbiAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7XG4gICAgICAgIHF1ZXVlID0gW107XG4gICAgICAgIHdoaWxlICgrK3F1ZXVlSW5kZXggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UXVldWVbcXVldWVJbmRleF0ucnVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgICAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgfVxuICAgIGN1cnJlbnRRdWV1ZSA9IG51bGw7XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBydW5DbGVhclRpbWVvdXQodGltZW91dCk7XG59XG5cbnByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7XG4gICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcXVldWUucHVzaChuZXcgSXRlbShmdW4sIGFyZ3MpKTtcbiAgICBpZiAocXVldWUubGVuZ3RoID09PSAxICYmICFkcmFpbmluZykge1xuICAgICAgICBydW5UaW1lb3V0KGRyYWluUXVldWUpO1xuICAgIH1cbn07XG5cbi8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHNcbmZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkge1xuICAgIHRoaXMuZnVuID0gZnVuO1xuICAgIHRoaXMuYXJyYXkgPSBhcnJheTtcbn1cbkl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTtcbn07XG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcbnByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3Vlc1xucHJvY2Vzcy52ZXJzaW9ucyA9IHt9O1xuXG5mdW5jdGlvbiBub29wKCkge31cblxucHJvY2Vzcy5vbiA9IG5vb3A7XG5wcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3Mub25jZSA9IG5vb3A7XG5wcm9jZXNzLm9mZiA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDtcbnByb2Nlc3MuZW1pdCA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRPbmNlTGlzdGVuZXIgPSBub29wO1xuXG5wcm9jZXNzLmxpc3RlbmVycyA9IGZ1bmN0aW9uIChuYW1lKSB7IHJldHVybiBbXSB9XG5cbnByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcblxucHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTtcbnByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5wcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9O1xuIiwiaW1wb3J0ICogYXMgYXNzZXJ0IGZyb20gXCJhc3NlcnRcIjtcbmltcG9ydCB7IERvc0NvbW1hbmRJbnRlZmFjZSB9IGZyb20gXCIuLi9qcy1kb3MtdHMvanMtZG9zLWNpXCI7XG5pbXBvcnQgeyBkb1RoZW4gfSBmcm9tIFwiLi9kb1wiO1xuXG4vLyBDb21wYXJlXG4vLyA9PT09PT09XG4vLyBDb21wYXJlIGltYWdlIGZyb20gdXJsLCBhbmQgc2NyZWVuc2hvdCBmcm9tIERvc0JveFxuXG5leHBvcnQgZnVuY3Rpb24gY29tcGFyZUFuZEV4aXQoaW1hZ2VVcmw6IHN0cmluZywgY2k6IERvc0NvbW1hbmRJbnRlZmFjZSwgZG9uZTogKCkgPT4gdm9pZCkge1xuICAgIGNvbXBhcmUoaW1hZ2VVcmwsIGNpLCAod3JvbmcpID0+IHtcbiAgICAgICAgYXNzZXJ0LmVxdWFsKDAsIHdyb25nKTtcbiAgICAgICAgY2kuZXhpdCgpO1xuICAgICAgICBkb25lKCk7XG4gICAgfSk7XG59XG5cbmNvbnN0IGNvbXBhcmUgPSAoaW1hZ2VVcmw6IHN0cmluZywgY2k6IERvc0NvbW1hbmRJbnRlZmFjZSwgY2FsbGJhY2s6ICh3cm9uZzogbnVtYmVyKSA9PiB2b2lkKSA9PiB7XG4gICAgZG9UaGVuKGNpLnNjcmVlbnNob3QoKSwgKGFjdHVhbFVybDogc3RyaW5nKSA9PiB7XG4gICAgICAgIGNvbnN0IGltZyA9IG5ldyBJbWFnZSgpO1xuICAgICAgICBpbWcub25sb2FkID0gKCkgPT4ge1xuICAgICAgICAgICAgYXNzZXJ0KGltZy53aWR0aCA9PT0gY2kud2lkdGgoKSwgXCJJbnZhbGlkIHdpZHRoOiBcIiArIGNpLndpZHRoKCkgKyBcIiwgc2hvdWxkIGJlIFwiICsgaW1nLndpZHRoKTtcbiAgICAgICAgICAgIGFzc2VydChpbWcuaGVpZ2h0ID09PSBjaS5oZWlnaHQoKSwgXCJJbnZhbGlkIGhlaWdodDogXCIgKyBjaS5oZWlnaHQoKSArIFwiLCBzaG91bGQgYmUgXCIgKyBpbWcuaGVpZ2h0KTtcblxuICAgICAgICAgICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcbiAgICAgICAgICAgIGNhbnZhcy53aWR0aCA9IGltZy53aWR0aDtcbiAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSBpbWcuaGVpZ2h0O1xuICAgICAgICAgICAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcbiAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoaW1nLCAwLCAwKTtcbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkID0gY3R4LmdldEltYWdlRGF0YSgwLCAwLCBpbWcud2lkdGgsIGltZy5oZWlnaHQpLmRhdGE7XG5cbiAgICAgICAgICAgIGNvbnN0IGFjdHVhbEltYWdlID0gbmV3IEltYWdlKCk7XG4gICAgICAgICAgICBhY3R1YWxJbWFnZS5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGltZyk7IC8vIGZvciBjb21wYXJpc29uc1xuICAgICAgICAgICAgICAgIHZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICBkaXYuaW5uZXJIVE1MID0gJ149ZXhwZWN0ZWQsIHY9YWN0dWFsJztcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGRpdik7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhY3R1YWxJbWFnZSk7IC8vIHRvIGdyYWIgaXQgZm9yIGNyZWF0aW5nIHRoZSB0ZXN0IHJlZmVyZW5jZVxuICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICBjb25zdCBhY3R1YWxDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xuICAgICAgICAgICAgICAgIGFjdHVhbENhbnZhcy53aWR0aCA9IGFjdHVhbEltYWdlLndpZHRoO1xuICAgICAgICAgICAgICAgIGFjdHVhbENhbnZhcy5oZWlnaHQgPSBhY3R1YWxJbWFnZS5oZWlnaHQ7XG4gICAgICAgICAgICAgICAgY29uc3QgYWN0dWFsQ3R4ID0gYWN0dWFsQ2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcbiAgICAgICAgICAgICAgICBhY3R1YWxDdHguZHJhd0ltYWdlKGFjdHVhbEltYWdlLCAwLCAwKTtcbiAgICAgICAgICAgICAgICBjb25zdCBhY3R1YWwgPSBhY3R1YWxDdHguZ2V0SW1hZ2VEYXRhKDAsIDAsIGFjdHVhbEltYWdlLndpZHRoLCBhY3R1YWxJbWFnZS5oZWlnaHQpLmRhdGE7XG5cbiAgICAgICAgICAgICAgICBsZXQgdG90YWwgPSAwO1xuICAgICAgICAgICAgICAgIGNvbnN0IHdpZHRoID0gaW1nLndpZHRoO1xuICAgICAgICAgICAgICAgIGNvbnN0IGhlaWdodCA9IGltZy5oZWlnaHQ7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsICs9IE1hdGguYWJzKGV4cGVjdGVkW3kgKiB3aWR0aCAqIDQgKyB4ICogNCArIDBdIC0gYWN0dWFsW3kgKiB3aWR0aCAqIDQgKyB4ICogNCArIDBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsICs9IE1hdGguYWJzKGV4cGVjdGVkW3kgKiB3aWR0aCAqIDQgKyB4ICogNCArIDFdIC0gYWN0dWFsW3kgKiB3aWR0aCAqIDQgKyB4ICogNCArIDFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsICs9IE1hdGguYWJzKGV4cGVjdGVkW3kgKiB3aWR0aCAqIDQgKyB4ICogNCArIDJdIC0gYWN0dWFsW3kgKiB3aWR0aCAqIDQgKyB4ICogNCArIDJdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGZsb29yLCB0byBhbGxvdyBzb21lIG1hcmdpbiBvZiBlcnJvciBmb3IgYW50aWFsaWFzaW5nXG4gICAgICAgICAgICAgICAgY29uc3Qgd3JvbmcgPSBNYXRoLmZsb29yKHRvdGFsIC8gKGltZy53aWR0aCAqIGltZy5oZWlnaHQgKiAzKSk7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2sod3JvbmcpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGFjdHVhbEltYWdlLnNyYyA9IGFjdHVhbFVybDtcbiAgICAgICAgfTtcbiAgICAgICAgaW1nLnNyYyA9IGltYWdlVXJsO1xuICAgIH0pO1xufTtcbiIsImltcG9ydCBhc3NlcnQgPSByZXF1aXJlKFwiYXNzZXJ0XCIpO1xuaW1wb3J0IHsgRG9zTWFpbkZuLCBEb3NSZWFkeVByb21pc2UgfSBmcm9tIFwiLi4vanMtZG9zLXRzL2pzLWRvc1wiO1xuaW1wb3J0IHsgRG9zRlMgfSBmcm9tIFwiLi4vanMtZG9zLXRzL2pzLWRvcy1mc1wiO1xuXG4vLyBEb1xuLy8gPT1cbi8vIFdlIHVzZSB0aGlzIGZ1bmN0aW9ucyB0byBhdm9pZCBwcm9ibGVtIG9mIHRocm93aW5nLFxuLy8gZXhjZXB0aW9ucyBpbnNpZGUgcHJvbWlzZS5cbi8vIE1vY2hhIGNhbid0IGhhbmRsZSBleGNlcHRpb25zIGlmIHRoZXkgYXJlIHRocm93ZWQgaW4gcHJvbWlzZVxuXG5leHBvcnQgZnVuY3Rpb24gZG9UaGVuPFQ+KHByb21pc2U6IFByb21pc2U8VD4sIGZuOiAodjogVCkgPT4gdm9pZCkge1xuICAgIHByb21pc2UudGhlbigodjogVCkgPT4ge1xuICAgICAgICBjb25zdCB0b3BGbiA9ICgpID0+IHtcbiAgICAgICAgICAgIGZuKHYpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHNldFRpbWVvdXQodG9wRm4sIDEpO1xuICAgIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZG9DYXRjaDxUPihwcm9taXNlOiBQcm9taXNlPFQ+LCBmbjogKHY6IHN0cmluZykgPT4gdm9pZCkge1xuICAgIHByb21pc2UuY2F0Y2goKHY6IHN0cmluZykgPT4ge1xuICAgICAgICBjb25zdCB0b3BGbiA9ICgpID0+IHtcbiAgICAgICAgICAgIGZuKHYpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHNldFRpbWVvdXQodG9wRm4sIDEpO1xuICAgIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZG9OZXh0PFQ+KHByb21pc2U6IFByb21pc2U8VD4sIGZuOiAodjogVCkgPT4gdm9pZCkge1xuICAgIGRvVGhlbihwcm9taXNlLCBmbik7XG4gICAgZG9DYXRjaChwcm9taXNlLCAobXNnOiBzdHJpbmcpID0+IGFzc2VydC5mYWlsKG1zZykpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZG9SZWFkeShwcm9taXNlOiBEb3NSZWFkeVByb21pc2UsIGZuOiAoZnM6IERvc0ZTLCBtYWluOiBEb3NNYWluRm4pID0+IHZvaWQpIHtcbiAgICBkb1RoZW4ocHJvbWlzZSwgKHJ1bnRpbWUpID0+IHtcbiAgICAgICAgZm4ocnVudGltZS5mcywgcnVudGltZS5tYWluKTtcbiAgICB9KTtcbiAgICBkb0NhdGNoKHByb21pc2UsIChtc2c6IHN0cmluZykgPT4gYXNzZXJ0LmZhaWwobXNnKSk7XG59XG4iLCIvKiB0c2xpbnQ6ZGlzYWJsZTptYXgtbGluZS1sZW5ndGggKi9cbi8qIHRzbGludDpkaXNhYmxlOm5vLWNvbnNvbGUgKi9cblxuaW1wb3J0ICogYXMgYXNzZXJ0IGZyb20gXCJhc3NlcnRcIjtcbmltcG9ydCB7IERvcyB9IGZyb20gXCIuLi9qcy1kb3MtdHMvanMtZG9zXCI7XG5pbXBvcnQgeyBEb3NDb21tYW5kSW50ZWZhY2UgfSBmcm9tIFwiLi4vanMtZG9zLXRzL2pzLWRvcy1jaVwiO1xuaW1wb3J0IHsgSG9zdCB9IGZyb20gXCIuLi9qcy1kb3MtdHMvanMtZG9zLWhvc3RcIjtcbmltcG9ydCB7IERvc01vZHVsZSB9IGZyb20gXCIuLi9qcy1kb3MtdHMvanMtZG9zLW1vZHVsZVwiO1xuaW1wb3J0IHsgRG9zT3B0aW9ucyB9IGZyb20gXCIuLi9qcy1kb3MtdHMvanMtZG9zLW9wdGlvbnNcIjtcbmltcG9ydCB7IGNvbXBhcmVBbmRFeGl0IH0gZnJvbSBcIi4vY29tcGFyZVwiO1xuaW1wb3J0IHsgZG9DYXRjaCwgZG9OZXh0LCBkb1JlYWR5LCBkb1RoZW4gfSBmcm9tIFwiLi9kb1wiO1xuXG5zdWl0ZShcImpzLWRvcy1ob3N0XCIpO1xuXG50ZXN0KFwibG9hZGVyIHNob3VsZCBub3RpZnkgYWJvdXQgZXJyb3IgaWYgd2FzbSBpcyBub3Qgc3VwcG9ydGVkXCIsIChkb25lKSA9PiB7XG4gICAgY29uc3Qgb2xkVmFsdWUgPSBIb3N0Lndhc21TdXBwb3J0ZWQ7XG4gICAgSG9zdC53YXNtU3VwcG9ydGVkID0gZmFsc2U7XG4gICAgSG9zdC5yZXNvbHZlRG9zQm94KFwid3Jvbmd1cmwuanNcIiwge1xuICAgICAgICBvbmVycm9yOiAobWVzc2FnZTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICBIb3N0Lndhc21TdXBwb3J0ZWQgPSBvbGRWYWx1ZTtcbiAgICAgICAgICAgIGFzc2VydC5lcXVhbChcIldlYkFzc2VtYmx5IGlzIG5vdCBzdXBwb3J0ZWQsIGNhbid0IHJlc29sdmUgd2Rvc2JveFwiLCBtZXNzYWdlKTtcbiAgICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgfSxcbiAgICB9IGFzIERvc01vZHVsZSk7XG59KTtcblxudGVzdChcImxvYWRlciBzaG91bGQgbm90aWZ5IGFib3V0IGVycm9yLCBpZiBpdCBjYW4ndCBkb3dubG9hZCB3ZG9zYm94XCIsIChkb25lKSA9PiB7XG4gICAgSG9zdC5yZXNvbHZlRG9zQm94KFwid3Jvbmd1cmwuanNcIiwge1xuICAgICAgICBvbmVycm9yOiAobWVzc2FnZTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICBhc3NlcnQuZXF1YWwoXCJDYW4ndCBkb3dubG9hZCB3YXNtLCBjb2RlOiA0MDQsIG1lc3NhZ2U6IGNvbm5lY3Rpb24gcHJvYmxlbSwgdXJsOiB3cm9uZ3VybC53YXNtLmpzXCIsIG1lc3NhZ2UpO1xuICAgICAgICAgICAgZG9uZSgpO1xuICAgICAgICB9LFxuICAgIH0gYXMgRG9zTW9kdWxlKTtcbn0pO1xuXG50ZXN0KFwibG9hZGVyIHNob3VsZCBzaG93IHByb2dyZXNzIGxvYWRpbmdcIiwgKGRvbmUpID0+IHtcbiAgICBsZXQgbGFzdExvYWRlZCA9IC0xO1xuICAgIEhvc3QucmVzb2x2ZURvc0JveChcIi93ZG9zYm94LmpzXCIsIHtcbiAgICAgICAgb25wcm9ncmVzczogKHN0YWdlOiBzdHJpbmcsIHRvdGFsOiBudW1iZXIsIGxvYWRlZDogbnVtYmVyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzdGFnZSwgdG90YWwsIGxvYWRlZCk7XG4gICAgICAgICAgICBhc3NlcnQuZXF1YWwodHJ1ZSwgbG9hZGVkIDw9IHRvdGFsLCBsb2FkZWQgKyBcIjw9XCIgKyB0b3RhbCk7XG4gICAgICAgICAgICBhc3NlcnQuZXF1YWwodHJ1ZSwgbGFzdExvYWRlZCA8PSBsb2FkZWQsIGxhc3RMb2FkZWQgKyBcIjw9XCIgKyBsb2FkZWQpO1xuICAgICAgICAgICAgbGFzdExvYWRlZCA9IGxvYWRlZDtcbiAgICAgICAgfSxcbiAgICAgICAgb25kb3Nib3g6IChkb3Nib3g6IGFueSwgaW5zdGFudGlhdGVXYXNtOiBhbnkpID0+IHtcbiAgICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25lcnJvcjogKG1lc3NhZ2U6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgYXNzZXJ0LmZhaWwoKTtcbiAgICAgICAgfSxcbiAgICB9IGFzIERvc01vZHVsZSk7XG59KTtcblxudGVzdChcImxvYWRlciBzaG91bGQgbmV2ZXIgbG9hZCB0d2ljZSB3ZG9zYm94XCIsIChkb25lKSA9PiB7XG4gICAgSG9zdC5yZXNvbHZlRG9zQm94KFwiL3dkb3Nib3guanNcIiwge1xuICAgICAgICBvbnByb2dyZXNzOiAoc3RhZ2U6IHN0cmluZywgdG90YWw6IG51bWJlciwgbG9hZGVkOiBudW1iZXIpID0+IHtcbiAgICAgICAgICAgIGFzc2VydC5mYWlsKCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uZG9zYm94OiAoZG9zYm94OiBhbnksIGluc3RhbnRpYXRlV2FzbTogYW55KSA9PiB7XG4gICAgICAgICAgICBkb25lKCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uZXJyb3I6IChtZXNzYWdlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIGFzc2VydC5mYWlsKCk7XG4gICAgICAgIH0sXG4gICAgfSBhcyBEb3NNb2R1bGUpO1xufSk7XG5cbnRlc3QoXCJsb2FkZXIgc2hvdWxkIGZpcmUgZXZlbnQgd2hlbiB3ZG9zYm94IGlzIGxvYWRlZFwiLCAoZG9uZSkgPT4ge1xuICAgIEhvc3QucmVzb2x2ZURvc0JveChcIi93ZG9zYm94LmpzXCIsIHtcbiAgICAgICAgb25kb3Nib3g6IChkb3Nib3g6IGFueSwgaW5zdGFudGlhdGVXYXNtOiBhbnkpID0+IHtcbiAgICAgICAgICAgIGFzc2VydC5vayhkb3Nib3gpO1xuICAgICAgICAgICAgYXNzZXJ0Lm9rKGluc3RhbnRpYXRlV2FzbSk7XG4gICAgICAgICAgICBkb25lKCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uZXJyb3I6IChtZXNzYWdlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIGFzc2VydC5mYWlsKCk7XG4gICAgICAgIH0sXG4gICAgfSBhcyBEb3NNb2R1bGUpO1xufSk7XG5cbnN1aXRlKFwianMtZG9zXCIpO1xuXG50ZXN0KFwianMtZG9zIGNhbid0IHN0YXJ0IHdpdGhvdXQgY2FudmFzIChsaXN0ZW5lciBzdHlsZSlcIiwgKGRvbmUpID0+IHtcbiAgICBEb3MobnVsbCwge1xuICAgICAgICB3ZG9zYm94VXJsOiBcIi93ZG9zYm94LmpzXCIsXG4gICAgICAgIG9uZXJyb3I6IChtZXNzYWdlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIGFzc2VydC5lcXVhbChcImNhbnZhcyBmaWVsZCBpcyByZXF1aXJlZCwgYnV0IG5vdCBzZXQhXCIsIG1lc3NhZ2UpO1xuICAgICAgICAgICAgZG9uZSgpO1xuICAgICAgICB9LFxuICAgIH0gYXMgRG9zT3B0aW9ucyk7XG59KTtcblxudGVzdChcImpzLWRvcyBjYW4ndCBzdGFydCB3aXRob3V0IGNhbnZhcyAocHJvbWlzZSBzdHlsZSlcIiwgKGRvbmUpID0+IHtcbiAgICBjb25zdCBkb3MgPSBEb3MobnVsbCwge1xuICAgICAgICB3ZG9zYm94VXJsOiBcIi93ZG9zYm94LmpzXCIsXG4gICAgfSBhcyBEb3NPcHRpb25zKTtcbiAgICBkb0NhdGNoKGRvcywgKG1lc3NhZ2UpID0+IHtcbiAgICAgICAgYXNzZXJ0LmVxdWFsKFwiY2FudmFzIGZpZWxkIGlzIHJlcXVpcmVkLCBidXQgbm90IHNldCFcIiwgbWVzc2FnZSk7XG4gICAgICAgIGRvbmUoKTtcbiAgICB9KTtcbiAgICBkb1RoZW4oZG9zLCAoKSA9PiB7XG4gICAgICAgIGFzc2VydC5mYWlsKCk7XG4gICAgfSk7XG59KTtcblxudGVzdChcImpzLWRvcyBzaG91bGQgc3RhcnQgd2l0aCBjYW52YXNcIiwgKGRvbmUpID0+IHtcbiAgICBjb25zdCBkb3MgPSBEb3MoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYW52YXNcIikgYXMgSFRNTENhbnZhc0VsZW1lbnQsIHtcbiAgICAgICAgd2Rvc2JveFVybDogXCIvd2Rvc2JveC5qc1wiLFxuICAgIH0pO1xuICAgIGRvUmVhZHkoZG9zLCAoZnMsIG1haW4pID0+IHtcbiAgICAgICAgZG9OZXh0KG1haW4oW10pLCAoY2kpID0+IHtcbiAgICAgICAgICAgIGNpLmV4aXQoKTtcbiAgICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59KTtcblxudGVzdChcImpzLWRvcyBjYW4gdGFrZSBzY3JlZW5zaG90IG9mIGNhbnZhc1wiLCAoZG9uZSkgPT4ge1xuICAgIGNvbnN0IGRvcyA9IERvcyhkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNhbnZhc1wiKSBhcyBIVE1MQ2FudmFzRWxlbWVudCwge1xuICAgICAgICB3ZG9zYm94VXJsOiBcIi93ZG9zYm94LmpzXCIsXG4gICAgfSk7XG4gICAgZG9SZWFkeShkb3MsIChmcywgbWFpbikgPT4ge1xuICAgICAgICBkb05leHQobWFpbihbXSksIChjaSkgPT4ge1xuICAgICAgICAgICAgY29tcGFyZUFuZEV4aXQoXCJpbml0LnBuZ1wiLCBjaSwgZG9uZSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufSk7XG5cbnRlc3QoXCJqcy1kb3MgY2FuIHJ1biBkaWdnZXIuemlwXCIsIChkb25lKSA9PiB7XG4gICAgY29uc3QgZG9zID0gRG9zKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2FudmFzXCIpIGFzIEhUTUxDYW52YXNFbGVtZW50LCB7XG4gICAgICAgIHdkb3Nib3hVcmw6IFwiL3dkb3Nib3guanNcIixcbiAgICB9KTtcblxuICAgIGRvUmVhZHkoZG9zLCAoZnMsIG1haW4pID0+IHtcbiAgICAgICAgZG9OZXh0KGZzLmV4dHJhY3QoXCJkaWdnZXIuemlwXCIpLCAoKSA9PiB7XG4gICAgICAgICAgICBkb05leHQobWFpbihbXCJESUdHRVIuQ09NXCJdKSwgKGNpKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZm4gPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbXBhcmVBbmRFeGl0KFwiZGlnZ2VyLnBuZ1wiLCBjaSwgZG9uZSk7XG4gICAgICAgICAgICAgICAgICAgIHNhdmVJbWFnZShjaSk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZm4sIDUwMDApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufSk7XG5cbmNvbnN0IHNhdmVJbWFnZSA9IChjaTogRG9zQ29tbWFuZEludGVmYWNlKSA9PiB7XG4gICAgY2kuc2NyZWVuc2hvdCgpLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgY29uc3QgdyA9IHdpbmRvdy5vcGVuKFwiYWJvdXQ6YmxhbmtcIiwgXCJpbWFnZSBmcm9tIGNhbnZhc1wiKTtcbiAgICAgICAgdy5kb2N1bWVudC53cml0ZShcIjxpbWcgc3JjPSdcIiArIGRhdGEgKyBcIicgYWx0PSdmcm9tIGNhbnZhcycvPlwiKTtcbiAgICB9KTtcbn07XG4iXX0="}