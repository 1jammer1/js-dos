{"version":3,"sources":["serviceWorker.ts","index.tsx","Renderer.tsx","Landing.tsx"],"names":["Boolean","window","location","hostname","match","path","pathname","ReactDOM","render","props","url","useState","frameKey","setFrameKey","content","setContent","frameContent","setFrameConent","request","setRequest","error","setError","cycles","setCycles","wdosboxUrl","setWdosboxUrl","autolock","setAutolock","proxy","setProxy","iframeCallback","useCallback","iframe","contentWindow","document","write","focus","xmlRequest","XMLHttpRequest","open","onerror","onreadystatechange","readyState","status","responseText","send","style","display","justifyContent","alignItems","marginTop","marginRight","intent","Intent","PRIMARY","className","color","fontWeight","flexDirection","height","title","tabIndex","key","ref","allowFullScreen","border","position","options","value","onChange","ev","newContent","replace","doSetVariant","currentTarget","checked","label","large","doSetAutolock","marginBottom","alignIndicator","Alignment","RIGHT","width","stepSize","majorStepSize","fill","onValueChange","right","text","icon","IconNames","FULLSCREEN","onClick","ci","fullscreen","REFRESH","DANGER","NONE","overflow","highlight","code","languages","html","padding","backgroundColor","fontFamily","fontSize","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"oXAYoBA,QACW,cAA7BC,OAAOC,SAASC,UAEe,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASC,MACvB,2D,4BCPAC,EAAOJ,OAAOC,SAASI,SAE7B,OAAQD,GACJ,IAAK,UACDE,IAASC,OAAO,mBCNT,SAAkBC,GAC/B,IAAMC,EAAM,uCAAyCD,EAAMJ,KAAO,QADV,EAGxBM,mBAAiB,GAHO,mBAGjDC,EAHiD,KAGvCC,EAHuC,OAI1BF,mBAAwB,MAJE,mBAIjDG,EAJiD,KAIxCC,EAJwC,OAKjBJ,mBAAwB,MALP,mBAKjDK,EALiD,KAKnCC,EALmC,OAM1BN,mBAAgC,MANN,mBAMjDO,EANiD,KAMxCC,EANwC,OAO9BR,mBAAwB,MAPM,mBAOjDS,EAPiD,KAO1CC,EAP0C,OAS5BV,mBAAiB,KATW,mBASjDW,EATiD,KASzCC,EATyC,OAUpBZ,mBAAiB,cAVG,mBAUjDa,EAViD,KAUrCC,EAVqC,OAWxBd,oBAAkB,GAXM,mBAWjDe,EAXiD,KAWvCC,EAXuC,OAa9BhB,mBAAS,MAbqB,mBAajDiB,GAbiD,KAa1CC,GAb0C,KAelDC,GAAiBC,uBAAY,SAACC,GAClC,GAAe,OAAXA,GAAmC,MAAhBhB,EAAsB,CAC3C,IAAMY,EAAQI,EAAOC,cACrBL,EAAMM,SAASC,MAAMnB,GACrBgB,EAAOI,QAEPP,GAASD,MAEV,CAAChB,IAEJ,GAAa,MAATQ,EACF,OAAO,kDAAwBA,GAIjC,KAD2B,OAAZN,GACF,CACX,IAAKI,EAAS,CACZ,IAAMmB,GAAa,IAAIC,eACvBD,GAAWE,KAAK,MAAO7B,GACvB2B,GAAWG,QAAU,WACnBnB,EAAS,2BAA6BX,IAExC2B,GAAWI,mBAAqB,WACA,IAA1BJ,GAAWK,aACa,MAAtBL,GAAWM,QACb5B,EAAWsB,GAAWO,cACtB3B,EAAeoB,GAAWO,cAC1B/B,EAAYD,EAAW,IAEvBS,EAAS,wBAA0BgB,GAAWM,UAIpDN,GAAWQ,OACX1B,EAAWkB,IAGb,OAAO,yBAAKS,MAAO,CACjBC,QAAS,OACTC,eAAgB,SAChBC,WAAY,SACZC,UAAW,QAEX,yBAAKJ,MAAO,CAAEK,YAAa,QAAS,kBAAC,IAAD,CAASC,OAAQC,IAAOC,WAC5D,qDACE,0BAAMC,UAAU,iBAAiBT,MAAO,CACtCU,MAAO,UACPC,WAAY,SACVxD,OAAOC,SAASI,YAgC1B,OAAO,yBAAKwC,MAAO,CACjBC,QAAS,OACTW,cAAe,SACfC,OAAQ,SAER,4BAAQC,MAAM,QACZC,SAAU,EACVC,IAAK,UAAYlD,EACjBmD,IAAKjC,GACLkC,iBAAe,EACflB,MAAO,CACLmB,OAAQ,OACRN,OAAQ,WAEZ,kBAAC,IAAD,CAAQb,MAAO,CAAEoB,SAAU,aACzB,kBAAC,IAAD,KACE,kBAAC,IAAD,gBACA,kBAAC,IAAD,CAAYC,QAAS,CAAC,aAAc,oBAAqB,oBACvD,mBAAoB,oBAAqBC,MAAO5C,EAChD6C,SAAU,SAACC,GAAD,OApClB,SAAsBF,GACpB,IAAMG,GAAczD,EAAU,IAAI0D,QAAQ,gBACxC,gDAAmDJ,EAAQ,MAC7D3C,EAAc2C,GACdrD,EAAWwD,GAgCaE,CAAaH,EAAGI,cAAcN,UAClD,kBAAC,IAAD,MACA,kBAAC,IAAD,CAAUO,QAASjD,EAAUkD,MAAM,YAAYC,OAAO,EACpDR,SAAU,SAACC,GAAD,OAhClB,SAAuBF,GACrB,IAAMG,GAAczD,EAAU,IAAI0D,QAAQ,cAAe,aAAeJ,EAAQ,KAChFzC,EAAYyC,GACZrD,EAAWwD,GA6BaO,CAAcR,EAAGI,cAAcC,UACjD7B,MAAO,CAAEiC,aAAc,GAAKC,eAAgBC,IAAUC,QACxD,kBAAC,IAAD,MACA,kBAAC,IAAD,eACA,yBAAKpC,MAAO,CAAEqC,MAAO,UACnB,kBAAC,IAAD,CAAcf,MAAO9C,EAAQ8D,SAAU,IAAKC,cAAe,IACzDC,MAAM,EAAMC,cAnDtB,SAAqBnB,GACnB,IAAMG,GAAczD,EAAU,IAAI0D,QAAQ,YAAa,WAAaJ,EAAQ,KAC5E7C,EAAU6C,GACVrD,EAAWwD,OAkDP,kBAAC,IAAD,CAAazB,MAAO,CAAEoB,SAAU,WAAYsB,MAAO,QACjD,kBAAC,IAAD,CAAQC,KAAK,aAAaC,KAAMC,IAAUC,WAAYC,QAnC9D,WACGjE,GAAckE,GAAGC,gBAmCZ,kBAAC,IAAD,CAAQL,KAAMC,IAAUK,QAASH,QA5DzC,WACE5E,EAAeH,GACfD,EAAYD,EAAW,IA2DfwC,OAAQtC,IAAYE,EAAeqC,IAAO4C,OAAS5C,IAAO6C,UAKlE,yBAAKpD,MAAO,CAAEqD,SAAU,SACtB,kBAAC,IAAD,CACE/B,MAAOtD,EACPyE,cAAexE,EACfqF,UAAW,SAAAC,GAAI,OAAID,oBAAUC,EAAMC,YAAUC,KAAM,SACnDC,QAAS,GACT1D,MAAO,CACL2D,gBAAiB,UACjBC,WAAY,+FACZC,SAAU,UDxII,CAAUtG,KAAMA,IAAU6B,SAAS0E,eAAe,SACtE,MAEA,QACIrG,IAASC,OAAO,mBEhBT,WACX,OAAO,kBAAC,IAAD,CAAQiF,KAAK,SAASI,QAAS,kBAAM5F,OAAOC,SAASI,SAAW,eFenD,MAAa4B,SAAS0E,eAAe,SDsHvD,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMC,MAAK,SAAAC,GACjCA,EAAaC,kB","file":"static/js/main.c264e1a8.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Renderer from './Renderer';\nimport Landing from './Landing';\nimport * as serviceWorker from './serviceWorker';\n\nimport 'normalize.css/normalize.css';\nimport '@blueprintjs/icons/lib/css/blueprint-icons.css';\nimport '@blueprintjs/core/lib/css/blueprint.css';\nimport './index.css';\n\nconst path = window.location.pathname;\n\nswitch (path) {\n    case \"/digger\":\n        ReactDOM.render(<Renderer path={path} />, document.getElementById('root'));\n    break;\n\n    default:\n        ReactDOM.render(<Landing />, document.getElementById('root'));\n}\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import React, { useState, useCallback } from 'react';\nimport Editor from 'react-simple-code-editor';\nimport { Spinner, Intent, ButtonGroup, Button, Navbar, NavbarHeading, NavbarGroup, HTMLSelect, NavbarDivider, Checkbox, Alignment, NumericInput } from \"@blueprintjs/core\";\nimport { highlight, languages } from 'prismjs';\n\nimport 'prismjs/themes/prism.css';\nimport 'prismjs/themes/prism-tomorrow.css';\nimport { IconNames } from '@blueprintjs/icons';\n\nexport default function Renderer(props: { path: string }) {\n  const url = \"https://js-dos.com/6.22/current/test\" + props.path + \".html\";\n\n  const [frameKey, setFrameKey] = useState<number>(0);\n  const [content, setContent] = useState<string | null>(null);\n  const [frameContent, setFrameConent] = useState<string | null>(null);\n  const [request, setRequest] = useState<XMLHttpRequest | null>(null);\n  const [error, setError] = useState<string | null>(null);\n\n  const [cycles, setCycles] = useState<number>(1000);\n  const [wdosboxUrl, setWdosboxUrl] = useState<string>(\"wdosbox.js\");\n  const [autolock, setAutolock] = useState<boolean>(false);\n\n  const [proxy, setProxy] = useState(null);\n\n  const iframeCallback = useCallback((iframe) => {\n    if (iframe !== null && frameContent != null) {\n      const proxy = iframe.contentWindow;\n      proxy.document.write(frameContent);\n      iframe.focus();\n      \n      setProxy(proxy);\n    }\n  }, [frameKey]);\n\n  if (error != null) {\n    return <div>Unexpected error: {error}</div>;\n  }\n\n  const loaded = content !== null;\n  if (!loaded) {\n    if (!request) {\n      const xmlRequest = new XMLHttpRequest();\n      xmlRequest.open('GET', url);\n      xmlRequest.onerror = () => {\n        setError(\"Unable to download url: \" + url);\n      };\n      xmlRequest.onreadystatechange = () => {\n        if (xmlRequest.readyState === 4) {\n          if (xmlRequest.status === 200) {\n            setContent(xmlRequest.responseText);\n            setFrameConent(xmlRequest.responseText);\n            setFrameKey(frameKey + 1);\n          } else {\n            setError(\"Wrong response code: \" + xmlRequest.status);\n          }\n        }\n      };\n      xmlRequest.send();\n      setRequest(xmlRequest);\n    }\n\n    return <div style={{\n      display: \"flex\",\n      justifyContent: \"center\",\n      alignItems: \"center\",\n      marginTop: \"1em\",\n    }}>\n      <div style={{ marginRight: \"1em\" }}><Spinner intent={Intent.PRIMARY} /></div>\n      <div>Loading documentation\n        <span className=\"bp3-text-large\" style={{\n          color: \"#48AFF0\",\n          fontWeight: \"bold\",\n        }}>{window.location.pathname}</span></div>\n    </div >;\n  }\n\n  function reload() {\n    setFrameConent(content);\n    setFrameKey(frameKey + 1);\n  }\n\n  function doSetCycles(value: number) {\n    const newContent = (content + \"\").replace(/cycles:.*/, \"cycles: \" + value + \",\");\n    setCycles(value);\n    setContent(newContent);\n  }\n\n  function doSetVariant(value: string) {\n    const newContent = (content + \"\").replace(/wdosboxUrl:.*/, \n      \"wdosboxUrl: \\\"https://js-dos.com/6.22/current/\" + value + \"\\\",\");\n    setWdosboxUrl(value);\n    setContent(newContent);\n  }\n\n  function doSetAutolock(value: boolean) {\n    const newContent = (content + \"\").replace(/autolock:.*/, \"autolock: \" + value + \",\");\n    setAutolock(value);\n    setContent(newContent);\n  }\n\n  function enterFullscreen() {\n    (proxy as any).ci.fullscreen();\n  }\n\n  return <div style={{\n    display: \"flex\",\n    flexDirection: \"column\",\n    height: \"100%\",\n  }}>\n    <iframe title=\"frame\"\n      tabIndex={1}\n      key={\"iframe_\" + frameKey}\n      ref={iframeCallback}\n      allowFullScreen\n      style={{\n        border: \"none\",\n        height: \"400px\",\n      }} />\n    <Navbar style={{ position: \"relative\" }}>\n      <NavbarGroup>\n        <NavbarHeading>Variant</NavbarHeading>\n        <HTMLSelect options={[\"wdosbox.js\", \"wdosbox-emterp.js\", \"wdosbox-nosync.js\",\n          \"dosbox-emterp.js\", \"dosbox-nosync.js\"]} value={wdosboxUrl}\n          onChange={(ev) => doSetVariant(ev.currentTarget.value)}></HTMLSelect>\n        <NavbarDivider></NavbarDivider>\n        <Checkbox checked={autolock} label=\"Mouselock\" large={true}\n          onChange={(ev) => doSetAutolock(ev.currentTarget.checked)}\n          style={{ marginBottom: 0 }} alignIndicator={Alignment.RIGHT}></Checkbox>\n        <NavbarDivider></NavbarDivider>\n        <NavbarHeading>Cycles</NavbarHeading>\n        <div style={{ width: \"100px\" }}>\n          <NumericInput value={cycles} stepSize={100} majorStepSize={1000}\n            fill={true} onValueChange={doSetCycles}></NumericInput>\n        </div>\n        <ButtonGroup style={{ position: \"absolute\", right: \"1em\" }}>\n          <Button text=\"Fullscreen\" icon={IconNames.FULLSCREEN} onClick={enterFullscreen}></Button>\n          <Button icon={IconNames.REFRESH} onClick={reload}\n            intent={content !== frameContent ? Intent.DANGER : Intent.NONE}>\n          </Button>\n        </ButtonGroup>\n      </NavbarGroup>\n    </Navbar>\n    <div style={{ overflow: \"auto\" }}>\n      <Editor\n        value={content as string}\n        onValueChange={setContent}\n        highlight={code => highlight(code, languages.html, 'html')}\n        padding={10}\n        style={{\n          backgroundColor: '#2d2d2d',\n          fontFamily: '\"Fira code\", \"Fira Mono\", source-code-pro, Menlo, Monaco, Consolas, \"Courier New\", monospace',\n          fontSize: 12,\n        }}\n      />\n    </div>\n  </div>;\n}","import React from \"react\";\nimport { Button } from \"@blueprintjs/core\";\n\nexport default function Landing() {\n    return <Button text=\"digger\" onClick={() => window.location.pathname = \"/digger\"}></Button>\n}"],"sourceRoot":""}